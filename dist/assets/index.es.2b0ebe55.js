import{e as yt}from"./events.c1cc4193.js";import{g as Go,r as Wo}from"./index.11d426a4.js";import{b as zi,s as qs,a as Bs,d as Ks,i as mn,c as ko,e as Yo,g as Vs,f as Hi,h as Jo,J as Er,j as qi,k as Bi,l as Rt,m as Tt,n as Gs,o as Ki,H as Yr}from"./index.74f64790.js";function Xo(r){try{return JSON.stringify(r)}catch{return'"[Circular]"'}}var Zo=Qo;function Qo(r,e,t){var i=t&&t.stringify||Xo,n=1;if(typeof r=="object"&&r!==null){var c=e.length+n;if(c===1)return r;var y=new Array(c);y[0]=i(r);for(var u=1;u<c;u++)y[u]=i(e[u]);return y.join(" ")}if(typeof r!="string")return r;var g=e.length;if(g===0)return r;for(var O="",S=1-n,A=-1,z=r&&r.length||0,N=0;N<z;){if(r.charCodeAt(N)===37&&N+1<z){switch(A=A>-1?A:0,r.charCodeAt(N+1)){case 100:case 102:if(S>=g||e[S]==null)break;A<N&&(O+=r.slice(A,N)),O+=Number(e[S]),A=N+2,N++;break;case 105:if(S>=g||e[S]==null)break;A<N&&(O+=r.slice(A,N)),O+=Math.floor(Number(e[S])),A=N+2,N++;break;case 79:case 111:case 106:if(S>=g||e[S]===void 0)break;A<N&&(O+=r.slice(A,N));var P=typeof e[S];if(P==="string"){O+="'"+e[S]+"'",A=N+2,N++;break}if(P==="function"){O+=e[S].name||"<anonymous>",A=N+2,N++;break}O+=i(e[S]),A=N+2,N++;break;case 115:if(S>=g)break;A<N&&(O+=r.slice(A,N)),O+=String(e[S]),A=N+2,N++;break;case 37:A<N&&(O+=r.slice(A,N)),O+="%",A=N+2,N++,S--;break}++S}++N}return A===-1?r:(A<z&&(O+=r.slice(A)),O)}const vn=Zo;var Dr=St;const wr=uc().console||{},ec={mapHttpRequest:zr,mapHttpResponse:zr,wrapRequestSerializer:ci,wrapResponseSerializer:ci,wrapErrorSerializer:ci,req:zr,res:zr,err:sc};function tc(r,e){return Array.isArray(r)?r.filter(function(i){return i!=="!stdSerializers.err"}):r===!0?Object.keys(e):!1}function St(r){r=r||{},r.browser=r.browser||{};const e=r.browser.transmit;if(e&&typeof e.send!="function")throw Error("pino: transmit option must have a send function");const t=r.browser.write||wr;r.browser.write&&(r.browser.asObject=!0);const i=r.serializers||{},n=tc(r.browser.serialize,i);let c=r.browser.serialize;Array.isArray(r.browser.serialize)&&r.browser.serialize.indexOf("!stdSerializers.err")>-1&&(c=!1);const y=["error","fatal","warn","info","debug","trace"];typeof t=="function"&&(t.error=t.fatal=t.warn=t.info=t.debug=t.trace=t),r.enabled===!1&&(r.level="silent");const u=r.level||"info",g=Object.create(t);g.log||(g.log=mr),Object.defineProperty(g,"levelVal",{get:S}),Object.defineProperty(g,"level",{get:A,set:z});const O={transmit:e,serialize:n,asObject:r.browser.asObject,levels:y,timestamp:ac(r)};g.levels=St.levels,g.level=u,g.setMaxListeners=g.getMaxListeners=g.emit=g.addListener=g.on=g.prependListener=g.once=g.prependOnceListener=g.removeListener=g.removeAllListeners=g.listeners=g.listenerCount=g.eventNames=g.write=g.flush=mr,g.serializers=i,g._serialize=n,g._stdErrSerialize=c,g.child=N,e&&(g._logEvent=Ei());function S(){return this.level==="silent"?1/0:this.levels.values[this.level]}function A(){return this._level}function z(P){if(P!=="silent"&&!this.levels.values[P])throw Error("unknown level "+P);this._level=P,Qt(O,g,"error","log"),Qt(O,g,"fatal","error"),Qt(O,g,"warn","error"),Qt(O,g,"info","log"),Qt(O,g,"debug","log"),Qt(O,g,"trace","log")}function N(P,q){if(!P)throw new Error("missing bindings for child Pino");q=q||{},n&&P.serializers&&(q.serializers=P.serializers);const M=q.serializers;if(n&&M){var B=Object.assign({},i,M),_=r.browser.serialize===!0?Object.keys(B):n;delete P.serializers,Jr([P],_,B,this._stdErrSerialize)}function E(b){this._childLevel=(b._childLevel|0)+1,this.error=er(b,P,"error"),this.fatal=er(b,P,"fatal"),this.warn=er(b,P,"warn"),this.info=er(b,P,"info"),this.debug=er(b,P,"debug"),this.trace=er(b,P,"trace"),B&&(this.serializers=B,this._serialize=_),e&&(this._logEvent=Ei([].concat(b._logEvent.bindings,P)))}return E.prototype=this,new E(this)}return g}St.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}};St.stdSerializers=ec;St.stdTimeFunctions=Object.assign({},{nullTime:Ws,epochTime:ks,unixTime:oc,isoTime:cc});function Qt(r,e,t,i){const n=Object.getPrototypeOf(e);e[t]=e.levelVal>e.levels.values[t]?mr:n[t]?n[t]:wr[t]||wr[i]||mr,rc(r,e,t)}function rc(r,e,t){!r.transmit&&e[t]===mr||(e[t]=function(i){return function(){const c=r.timestamp(),y=new Array(arguments.length),u=Object.getPrototypeOf&&Object.getPrototypeOf(this)===wr?wr:this;for(var g=0;g<y.length;g++)y[g]=arguments[g];if(r.serialize&&!r.asObject&&Jr(y,this._serialize,this.serializers,this._stdErrSerialize),r.asObject?i.call(u,ic(this,t,y,c)):i.apply(u,y),r.transmit){const O=r.transmit.level||e.level,S=St.levels.values[O],A=St.levels.values[t];if(A<S)return;nc(this,{ts:c,methodLevel:t,methodValue:A,transmitLevel:O,transmitValue:St.levels.values[r.transmit.level||e.level],send:r.transmit.send,val:e.levelVal},y)}}}(e[t]))}function ic(r,e,t,i){r._serialize&&Jr(t,r._serialize,r.serializers,r._stdErrSerialize);const n=t.slice();let c=n[0];const y={};i&&(y.time=i),y.level=St.levels.values[e];let u=(r._childLevel|0)+1;if(u<1&&(u=1),c!==null&&typeof c=="object"){for(;u--&&typeof n[0]=="object";)Object.assign(y,n.shift());c=n.length?vn(n.shift(),n):void 0}else typeof c=="string"&&(c=vn(n.shift(),n));return c!==void 0&&(y.msg=c),y}function Jr(r,e,t,i){for(const n in r)if(i&&r[n]instanceof Error)r[n]=St.stdSerializers.err(r[n]);else if(typeof r[n]=="object"&&!Array.isArray(r[n]))for(const c in r[n])e&&e.indexOf(c)>-1&&c in t&&(r[n][c]=t[c](r[n][c]))}function er(r,e,t){return function(){const i=new Array(1+arguments.length);i[0]=e;for(var n=1;n<i.length;n++)i[n]=arguments[n-1];return r[t].apply(this,i)}}function nc(r,e,t){const i=e.send,n=e.ts,c=e.methodLevel,y=e.methodValue,u=e.val,g=r._logEvent.bindings;Jr(t,r._serialize||Object.keys(r.serializers),r.serializers,r._stdErrSerialize===void 0?!0:r._stdErrSerialize),r._logEvent.ts=n,r._logEvent.messages=t.filter(function(O){return g.indexOf(O)===-1}),r._logEvent.level.label=c,r._logEvent.level.value=y,i(c,r._logEvent,u),r._logEvent=Ei(g)}function Ei(r){return{ts:0,messages:[],bindings:r||[],level:{label:"",value:0}}}function sc(r){const e={type:r.constructor.name,msg:r.message,stack:r.stack};for(const t in r)e[t]===void 0&&(e[t]=r[t]);return e}function ac(r){return typeof r.timestamp=="function"?r.timestamp:r.timestamp===!1?Ws:ks}function zr(){return{}}function ci(r){return r}function mr(){}function Ws(){return!1}function ks(){return Date.now()}function oc(){return Math.round(Date.now()/1e3)}function cc(){return new Date(Date.now()).toISOString()}function uc(){function r(e){return typeof e<"u"&&e}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return r(self)||r(window)||r(this)||{}}}var Xr={},Vi={exports:{}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */(function(r){var e,t,i,n,c,y,u,g,O,S,A,z,N,P,q,M,B,_,E,b,w,m,s;(function(l){var H=typeof globalThis=="object"?globalThis:typeof self=="object"?self:typeof this=="object"?this:{};l(o(H,o(r.exports)));function o(f,d){return f!==H&&(typeof Object.create=="function"?Object.defineProperty(f,"__esModule",{value:!0}):f.__esModule=!0),function(v,p){return f[v]=d?d(v,p):p}}})(function(l){var H=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,f){o.__proto__=f}||function(o,f){for(var d in f)f.hasOwnProperty(d)&&(o[d]=f[d])};e=function(o,f){H(o,f);function d(){this.constructor=o}o.prototype=f===null?Object.create(f):(d.prototype=f.prototype,new d)},t=Object.assign||function(o){for(var f,d=1,v=arguments.length;d<v;d++){f=arguments[d];for(var p in f)Object.prototype.hasOwnProperty.call(f,p)&&(o[p]=f[p])}return o},i=function(o,f){var d={};for(var v in o)Object.prototype.hasOwnProperty.call(o,v)&&f.indexOf(v)<0&&(d[v]=o[v]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var p=0,v=Object.getOwnPropertySymbols(o);p<v.length;p++)f.indexOf(v[p])<0&&Object.prototype.propertyIsEnumerable.call(o,v[p])&&(d[v[p]]=o[v[p]]);return d},n=function(o,f,d,v){var p=arguments.length,h=p<3?f:v===null?v=Object.getOwnPropertyDescriptor(f,d):v,T;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(o,f,d,v);else for(var F=o.length-1;F>=0;F--)(T=o[F])&&(h=(p<3?T(h):p>3?T(f,d,h):T(f,d))||h);return p>3&&h&&Object.defineProperty(f,d,h),h},c=function(o,f){return function(d,v){f(d,v,o)}},y=function(o,f){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(o,f)},u=function(o,f,d,v){function p(h){return h instanceof d?h:new d(function(T){T(h)})}return new(d||(d=Promise))(function(h,T){function F(j){try{I(v.next(j))}catch(K){T(K)}}function $(j){try{I(v.throw(j))}catch(K){T(K)}}function I(j){j.done?h(j.value):p(j.value).then(F,$)}I((v=v.apply(o,f||[])).next())})},g=function(o,f){var d={label:0,sent:function(){if(h[0]&1)throw h[1];return h[1]},trys:[],ops:[]},v,p,h,T;return T={next:F(0),throw:F(1),return:F(2)},typeof Symbol=="function"&&(T[Symbol.iterator]=function(){return this}),T;function F(I){return function(j){return $([I,j])}}function $(I){if(v)throw new TypeError("Generator is already executing.");for(;d;)try{if(v=1,p&&(h=I[0]&2?p.return:I[0]?p.throw||((h=p.return)&&h.call(p),0):p.next)&&!(h=h.call(p,I[1])).done)return h;switch(p=0,h&&(I=[I[0]&2,h.value]),I[0]){case 0:case 1:h=I;break;case 4:return d.label++,{value:I[1],done:!1};case 5:d.label++,p=I[1],I=[0];continue;case 7:I=d.ops.pop(),d.trys.pop();continue;default:if(h=d.trys,!(h=h.length>0&&h[h.length-1])&&(I[0]===6||I[0]===2)){d=0;continue}if(I[0]===3&&(!h||I[1]>h[0]&&I[1]<h[3])){d.label=I[1];break}if(I[0]===6&&d.label<h[1]){d.label=h[1],h=I;break}if(h&&d.label<h[2]){d.label=h[2],d.ops.push(I);break}h[2]&&d.ops.pop(),d.trys.pop();continue}I=f.call(o,d)}catch(j){I=[6,j],p=0}finally{v=h=0}if(I[0]&5)throw I[1];return{value:I[0]?I[1]:void 0,done:!0}}},s=function(o,f,d,v){v===void 0&&(v=d),o[v]=f[d]},O=function(o,f){for(var d in o)d!=="default"&&!f.hasOwnProperty(d)&&(f[d]=o[d])},S=function(o){var f=typeof Symbol=="function"&&Symbol.iterator,d=f&&o[f],v=0;if(d)return d.call(o);if(o&&typeof o.length=="number")return{next:function(){return o&&v>=o.length&&(o=void 0),{value:o&&o[v++],done:!o}}};throw new TypeError(f?"Object is not iterable.":"Symbol.iterator is not defined.")},A=function(o,f){var d=typeof Symbol=="function"&&o[Symbol.iterator];if(!d)return o;var v=d.call(o),p,h=[],T;try{for(;(f===void 0||f-- >0)&&!(p=v.next()).done;)h.push(p.value)}catch(F){T={error:F}}finally{try{p&&!p.done&&(d=v.return)&&d.call(v)}finally{if(T)throw T.error}}return h},z=function(){for(var o=[],f=0;f<arguments.length;f++)o=o.concat(A(arguments[f]));return o},N=function(){for(var o=0,f=0,d=arguments.length;f<d;f++)o+=arguments[f].length;for(var v=Array(o),p=0,f=0;f<d;f++)for(var h=arguments[f],T=0,F=h.length;T<F;T++,p++)v[p]=h[T];return v},P=function(o){return this instanceof P?(this.v=o,this):new P(o)},q=function(o,f,d){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var v=d.apply(o,f||[]),p,h=[];return p={},T("next"),T("throw"),T("return"),p[Symbol.asyncIterator]=function(){return this},p;function T(G){v[G]&&(p[G]=function(V){return new Promise(function(Q,Y){h.push([G,V,Q,Y])>1||F(G,V)})})}function F(G,V){try{$(v[G](V))}catch(Q){K(h[0][3],Q)}}function $(G){G.value instanceof P?Promise.resolve(G.value.v).then(I,j):K(h[0][2],G)}function I(G){F("next",G)}function j(G){F("throw",G)}function K(G,V){G(V),h.shift(),h.length&&F(h[0][0],h[0][1])}},M=function(o){var f,d;return f={},v("next"),v("throw",function(p){throw p}),v("return"),f[Symbol.iterator]=function(){return this},f;function v(p,h){f[p]=o[p]?function(T){return(d=!d)?{value:P(o[p](T)),done:p==="return"}:h?h(T):T}:h}},B=function(o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var f=o[Symbol.asyncIterator],d;return f?f.call(o):(o=typeof S=="function"?S(o):o[Symbol.iterator](),d={},v("next"),v("throw"),v("return"),d[Symbol.asyncIterator]=function(){return this},d);function v(h){d[h]=o[h]&&function(T){return new Promise(function(F,$){T=o[h](T),p(F,$,T.done,T.value)})}}function p(h,T,F,$){Promise.resolve($).then(function(I){h({value:I,done:F})},T)}},_=function(o,f){return Object.defineProperty?Object.defineProperty(o,"raw",{value:f}):o.raw=f,o},E=function(o){if(o&&o.__esModule)return o;var f={};if(o!=null)for(var d in o)Object.hasOwnProperty.call(o,d)&&(f[d]=o[d]);return f.default=o,f},b=function(o){return o&&o.__esModule?o:{default:o}},w=function(o,f){if(!f.has(o))throw new TypeError("attempted to get private field on non-instance");return f.get(o)},m=function(o,f,d){if(!f.has(o))throw new TypeError("attempted to set private field on non-instance");return f.set(o,d),d},l("__extends",e),l("__assign",t),l("__rest",i),l("__decorate",n),l("__param",c),l("__metadata",y),l("__awaiter",u),l("__generator",g),l("__exportStar",O),l("__createBinding",s),l("__values",S),l("__read",A),l("__spread",z),l("__spreadArrays",N),l("__await",P),l("__asyncGenerator",q),l("__asyncDelegator",M),l("__asyncValues",B),l("__makeTemplateObject",_),l("__importStar",E),l("__importDefault",b),l("__classPrivateFieldGet",w),l("__classPrivateFieldSet",m)})})(Vi);var Sr={};Object.defineProperty(Sr,"__esModule",{value:!0});function hc(r){if(typeof r!="string")throw new Error(`Cannot safe json parse value of type ${typeof r}`);try{return JSON.parse(r)}catch{return r}}Sr.safeJsonParse=hc;function lc(r){return typeof r=="string"?r:JSON.stringify(r,(e,t)=>typeof t>"u"?null:t)}Sr.safeJsonStringify=lc;var ur={exports:{}},En;function fc(){return En||(En=1,function(){let r;function e(){}r=e,r.prototype.getItem=function(t){return this.hasOwnProperty(t)?String(this[t]):null},r.prototype.setItem=function(t,i){this[t]=String(i)},r.prototype.removeItem=function(t){delete this[t]},r.prototype.clear=function(){const t=this;Object.keys(t).forEach(function(i){t[i]=void 0,delete t[i]})},r.prototype.key=function(t){return t=t||0,Object.keys(this)[t]},r.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof globalThis<"u"&&globalThis.localStorage?ur.exports=globalThis.localStorage:typeof window<"u"&&window.localStorage?ur.exports=window.localStorage:ur.exports=new e}()),ur.exports}var ui={},hr={},Dn;function dc(){if(Dn)return hr;Dn=1,Object.defineProperty(hr,"__esModule",{value:!0}),hr.IKeyValueStorage=void 0;class r{}return hr.IKeyValueStorage=r,hr}var lr={},Sn;function gc(){if(Sn)return lr;Sn=1,Object.defineProperty(lr,"__esModule",{value:!0}),lr.parseEntry=void 0;const r=Sr;function e(t){var i;return[t[0],r.safeJsonParse((i=t[1])!==null&&i!==void 0?i:"")]}return lr.parseEntry=e,lr}var On;function pc(){return On||(On=1,function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=Vi.exports;e.__exportStar(dc(),r),e.__exportStar(gc(),r)}(ui)),ui}Object.defineProperty(Xr,"__esModule",{value:!0});Xr.KeyValueStorage=void 0;const rr=Vi.exports,In=Sr,yc=rr.__importDefault(fc()),_c=pc();class Ys{constructor(){this.localStorage=yc.default}getKeys(){return rr.__awaiter(this,void 0,void 0,function*(){return Object.keys(this.localStorage)})}getEntries(){return rr.__awaiter(this,void 0,void 0,function*(){return Object.entries(this.localStorage).map(_c.parseEntry)})}getItem(e){return rr.__awaiter(this,void 0,void 0,function*(){const t=this.localStorage.getItem(e);if(t!==null)return In.safeJsonParse(t)})}setItem(e,t){return rr.__awaiter(this,void 0,void 0,function*(){this.localStorage.setItem(e,In.safeJsonStringify(t))})}removeItem(e){return rr.__awaiter(this,void 0,void 0,function*(){this.localStorage.removeItem(e)})}}Xr.KeyValueStorage=Ys;var bc=Xr.default=Ys,Or={},Ir={exports:{}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */(function(r){var e,t,i,n,c,y,u,g,O,S,A,z,N,P,q,M,B,_,E,b,w,m,s;(function(l){var H=typeof globalThis=="object"?globalThis:typeof self=="object"?self:typeof this=="object"?this:{};l(o(H,o(r.exports)));function o(f,d){return f!==H&&(typeof Object.create=="function"?Object.defineProperty(f,"__esModule",{value:!0}):f.__esModule=!0),function(v,p){return f[v]=d?d(v,p):p}}})(function(l){var H=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,f){o.__proto__=f}||function(o,f){for(var d in f)f.hasOwnProperty(d)&&(o[d]=f[d])};e=function(o,f){H(o,f);function d(){this.constructor=o}o.prototype=f===null?Object.create(f):(d.prototype=f.prototype,new d)},t=Object.assign||function(o){for(var f,d=1,v=arguments.length;d<v;d++){f=arguments[d];for(var p in f)Object.prototype.hasOwnProperty.call(f,p)&&(o[p]=f[p])}return o},i=function(o,f){var d={};for(var v in o)Object.prototype.hasOwnProperty.call(o,v)&&f.indexOf(v)<0&&(d[v]=o[v]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var p=0,v=Object.getOwnPropertySymbols(o);p<v.length;p++)f.indexOf(v[p])<0&&Object.prototype.propertyIsEnumerable.call(o,v[p])&&(d[v[p]]=o[v[p]]);return d},n=function(o,f,d,v){var p=arguments.length,h=p<3?f:v===null?v=Object.getOwnPropertyDescriptor(f,d):v,T;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(o,f,d,v);else for(var F=o.length-1;F>=0;F--)(T=o[F])&&(h=(p<3?T(h):p>3?T(f,d,h):T(f,d))||h);return p>3&&h&&Object.defineProperty(f,d,h),h},c=function(o,f){return function(d,v){f(d,v,o)}},y=function(o,f){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(o,f)},u=function(o,f,d,v){function p(h){return h instanceof d?h:new d(function(T){T(h)})}return new(d||(d=Promise))(function(h,T){function F(j){try{I(v.next(j))}catch(K){T(K)}}function $(j){try{I(v.throw(j))}catch(K){T(K)}}function I(j){j.done?h(j.value):p(j.value).then(F,$)}I((v=v.apply(o,f||[])).next())})},g=function(o,f){var d={label:0,sent:function(){if(h[0]&1)throw h[1];return h[1]},trys:[],ops:[]},v,p,h,T;return T={next:F(0),throw:F(1),return:F(2)},typeof Symbol=="function"&&(T[Symbol.iterator]=function(){return this}),T;function F(I){return function(j){return $([I,j])}}function $(I){if(v)throw new TypeError("Generator is already executing.");for(;d;)try{if(v=1,p&&(h=I[0]&2?p.return:I[0]?p.throw||((h=p.return)&&h.call(p),0):p.next)&&!(h=h.call(p,I[1])).done)return h;switch(p=0,h&&(I=[I[0]&2,h.value]),I[0]){case 0:case 1:h=I;break;case 4:return d.label++,{value:I[1],done:!1};case 5:d.label++,p=I[1],I=[0];continue;case 7:I=d.ops.pop(),d.trys.pop();continue;default:if(h=d.trys,!(h=h.length>0&&h[h.length-1])&&(I[0]===6||I[0]===2)){d=0;continue}if(I[0]===3&&(!h||I[1]>h[0]&&I[1]<h[3])){d.label=I[1];break}if(I[0]===6&&d.label<h[1]){d.label=h[1],h=I;break}if(h&&d.label<h[2]){d.label=h[2],d.ops.push(I);break}h[2]&&d.ops.pop(),d.trys.pop();continue}I=f.call(o,d)}catch(j){I=[6,j],p=0}finally{v=h=0}if(I[0]&5)throw I[1];return{value:I[0]?I[1]:void 0,done:!0}}},s=function(o,f,d,v){v===void 0&&(v=d),o[v]=f[d]},O=function(o,f){for(var d in o)d!=="default"&&!f.hasOwnProperty(d)&&(f[d]=o[d])},S=function(o){var f=typeof Symbol=="function"&&Symbol.iterator,d=f&&o[f],v=0;if(d)return d.call(o);if(o&&typeof o.length=="number")return{next:function(){return o&&v>=o.length&&(o=void 0),{value:o&&o[v++],done:!o}}};throw new TypeError(f?"Object is not iterable.":"Symbol.iterator is not defined.")},A=function(o,f){var d=typeof Symbol=="function"&&o[Symbol.iterator];if(!d)return o;var v=d.call(o),p,h=[],T;try{for(;(f===void 0||f-- >0)&&!(p=v.next()).done;)h.push(p.value)}catch(F){T={error:F}}finally{try{p&&!p.done&&(d=v.return)&&d.call(v)}finally{if(T)throw T.error}}return h},z=function(){for(var o=[],f=0;f<arguments.length;f++)o=o.concat(A(arguments[f]));return o},N=function(){for(var o=0,f=0,d=arguments.length;f<d;f++)o+=arguments[f].length;for(var v=Array(o),p=0,f=0;f<d;f++)for(var h=arguments[f],T=0,F=h.length;T<F;T++,p++)v[p]=h[T];return v},P=function(o){return this instanceof P?(this.v=o,this):new P(o)},q=function(o,f,d){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var v=d.apply(o,f||[]),p,h=[];return p={},T("next"),T("throw"),T("return"),p[Symbol.asyncIterator]=function(){return this},p;function T(G){v[G]&&(p[G]=function(V){return new Promise(function(Q,Y){h.push([G,V,Q,Y])>1||F(G,V)})})}function F(G,V){try{$(v[G](V))}catch(Q){K(h[0][3],Q)}}function $(G){G.value instanceof P?Promise.resolve(G.value.v).then(I,j):K(h[0][2],G)}function I(G){F("next",G)}function j(G){F("throw",G)}function K(G,V){G(V),h.shift(),h.length&&F(h[0][0],h[0][1])}},M=function(o){var f,d;return f={},v("next"),v("throw",function(p){throw p}),v("return"),f[Symbol.iterator]=function(){return this},f;function v(p,h){f[p]=o[p]?function(T){return(d=!d)?{value:P(o[p](T)),done:p==="return"}:h?h(T):T}:h}},B=function(o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var f=o[Symbol.asyncIterator],d;return f?f.call(o):(o=typeof S=="function"?S(o):o[Symbol.iterator](),d={},v("next"),v("throw"),v("return"),d[Symbol.asyncIterator]=function(){return this},d);function v(h){d[h]=o[h]&&function(T){return new Promise(function(F,$){T=o[h](T),p(F,$,T.done,T.value)})}}function p(h,T,F,$){Promise.resolve($).then(function(I){h({value:I,done:F})},T)}},_=function(o,f){return Object.defineProperty?Object.defineProperty(o,"raw",{value:f}):o.raw=f,o},E=function(o){if(o&&o.__esModule)return o;var f={};if(o!=null)for(var d in o)Object.hasOwnProperty.call(o,d)&&(f[d]=o[d]);return f.default=o,f},b=function(o){return o&&o.__esModule?o:{default:o}},w=function(o,f){if(!f.has(o))throw new TypeError("attempted to get private field on non-instance");return f.get(o)},m=function(o,f,d){if(!f.has(o))throw new TypeError("attempted to set private field on non-instance");return f.set(o,d),d},l("__extends",e),l("__assign",t),l("__rest",i),l("__decorate",n),l("__param",c),l("__metadata",y),l("__awaiter",u),l("__generator",g),l("__exportStar",O),l("__createBinding",s),l("__values",S),l("__read",A),l("__spread",z),l("__spreadArrays",N),l("__await",P),l("__asyncGenerator",q),l("__asyncDelegator",M),l("__asyncValues",B),l("__makeTemplateObject",_),l("__importStar",E),l("__importDefault",b),l("__classPrivateFieldGet",w),l("__classPrivateFieldSet",m)})})(Ir);var fr={},ee={},xr={exports:{}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */(function(r){var e,t,i,n,c,y,u,g,O,S,A,z,N,P,q,M,B,_,E,b,w,m,s;(function(l){var H=typeof globalThis=="object"?globalThis:typeof self=="object"?self:typeof this=="object"?this:{};l(o(H,o(r.exports)));function o(f,d){return f!==H&&(typeof Object.create=="function"?Object.defineProperty(f,"__esModule",{value:!0}):f.__esModule=!0),function(v,p){return f[v]=d?d(v,p):p}}})(function(l){var H=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,f){o.__proto__=f}||function(o,f){for(var d in f)f.hasOwnProperty(d)&&(o[d]=f[d])};e=function(o,f){H(o,f);function d(){this.constructor=o}o.prototype=f===null?Object.create(f):(d.prototype=f.prototype,new d)},t=Object.assign||function(o){for(var f,d=1,v=arguments.length;d<v;d++){f=arguments[d];for(var p in f)Object.prototype.hasOwnProperty.call(f,p)&&(o[p]=f[p])}return o},i=function(o,f){var d={};for(var v in o)Object.prototype.hasOwnProperty.call(o,v)&&f.indexOf(v)<0&&(d[v]=o[v]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var p=0,v=Object.getOwnPropertySymbols(o);p<v.length;p++)f.indexOf(v[p])<0&&Object.prototype.propertyIsEnumerable.call(o,v[p])&&(d[v[p]]=o[v[p]]);return d},n=function(o,f,d,v){var p=arguments.length,h=p<3?f:v===null?v=Object.getOwnPropertyDescriptor(f,d):v,T;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(o,f,d,v);else for(var F=o.length-1;F>=0;F--)(T=o[F])&&(h=(p<3?T(h):p>3?T(f,d,h):T(f,d))||h);return p>3&&h&&Object.defineProperty(f,d,h),h},c=function(o,f){return function(d,v){f(d,v,o)}},y=function(o,f){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(o,f)},u=function(o,f,d,v){function p(h){return h instanceof d?h:new d(function(T){T(h)})}return new(d||(d=Promise))(function(h,T){function F(j){try{I(v.next(j))}catch(K){T(K)}}function $(j){try{I(v.throw(j))}catch(K){T(K)}}function I(j){j.done?h(j.value):p(j.value).then(F,$)}I((v=v.apply(o,f||[])).next())})},g=function(o,f){var d={label:0,sent:function(){if(h[0]&1)throw h[1];return h[1]},trys:[],ops:[]},v,p,h,T;return T={next:F(0),throw:F(1),return:F(2)},typeof Symbol=="function"&&(T[Symbol.iterator]=function(){return this}),T;function F(I){return function(j){return $([I,j])}}function $(I){if(v)throw new TypeError("Generator is already executing.");for(;d;)try{if(v=1,p&&(h=I[0]&2?p.return:I[0]?p.throw||((h=p.return)&&h.call(p),0):p.next)&&!(h=h.call(p,I[1])).done)return h;switch(p=0,h&&(I=[I[0]&2,h.value]),I[0]){case 0:case 1:h=I;break;case 4:return d.label++,{value:I[1],done:!1};case 5:d.label++,p=I[1],I=[0];continue;case 7:I=d.ops.pop(),d.trys.pop();continue;default:if(h=d.trys,!(h=h.length>0&&h[h.length-1])&&(I[0]===6||I[0]===2)){d=0;continue}if(I[0]===3&&(!h||I[1]>h[0]&&I[1]<h[3])){d.label=I[1];break}if(I[0]===6&&d.label<h[1]){d.label=h[1],h=I;break}if(h&&d.label<h[2]){d.label=h[2],d.ops.push(I);break}h[2]&&d.ops.pop(),d.trys.pop();continue}I=f.call(o,d)}catch(j){I=[6,j],p=0}finally{v=h=0}if(I[0]&5)throw I[1];return{value:I[0]?I[1]:void 0,done:!0}}},s=function(o,f,d,v){v===void 0&&(v=d),o[v]=f[d]},O=function(o,f){for(var d in o)d!=="default"&&!f.hasOwnProperty(d)&&(f[d]=o[d])},S=function(o){var f=typeof Symbol=="function"&&Symbol.iterator,d=f&&o[f],v=0;if(d)return d.call(o);if(o&&typeof o.length=="number")return{next:function(){return o&&v>=o.length&&(o=void 0),{value:o&&o[v++],done:!o}}};throw new TypeError(f?"Object is not iterable.":"Symbol.iterator is not defined.")},A=function(o,f){var d=typeof Symbol=="function"&&o[Symbol.iterator];if(!d)return o;var v=d.call(o),p,h=[],T;try{for(;(f===void 0||f-- >0)&&!(p=v.next()).done;)h.push(p.value)}catch(F){T={error:F}}finally{try{p&&!p.done&&(d=v.return)&&d.call(v)}finally{if(T)throw T.error}}return h},z=function(){for(var o=[],f=0;f<arguments.length;f++)o=o.concat(A(arguments[f]));return o},N=function(){for(var o=0,f=0,d=arguments.length;f<d;f++)o+=arguments[f].length;for(var v=Array(o),p=0,f=0;f<d;f++)for(var h=arguments[f],T=0,F=h.length;T<F;T++,p++)v[p]=h[T];return v},P=function(o){return this instanceof P?(this.v=o,this):new P(o)},q=function(o,f,d){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var v=d.apply(o,f||[]),p,h=[];return p={},T("next"),T("throw"),T("return"),p[Symbol.asyncIterator]=function(){return this},p;function T(G){v[G]&&(p[G]=function(V){return new Promise(function(Q,Y){h.push([G,V,Q,Y])>1||F(G,V)})})}function F(G,V){try{$(v[G](V))}catch(Q){K(h[0][3],Q)}}function $(G){G.value instanceof P?Promise.resolve(G.value.v).then(I,j):K(h[0][2],G)}function I(G){F("next",G)}function j(G){F("throw",G)}function K(G,V){G(V),h.shift(),h.length&&F(h[0][0],h[0][1])}},M=function(o){var f,d;return f={},v("next"),v("throw",function(p){throw p}),v("return"),f[Symbol.iterator]=function(){return this},f;function v(p,h){f[p]=o[p]?function(T){return(d=!d)?{value:P(o[p](T)),done:p==="return"}:h?h(T):T}:h}},B=function(o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var f=o[Symbol.asyncIterator],d;return f?f.call(o):(o=typeof S=="function"?S(o):o[Symbol.iterator](),d={},v("next"),v("throw"),v("return"),d[Symbol.asyncIterator]=function(){return this},d);function v(h){d[h]=o[h]&&function(T){return new Promise(function(F,$){T=o[h](T),p(F,$,T.done,T.value)})}}function p(h,T,F,$){Promise.resolve($).then(function(I){h({value:I,done:F})},T)}},_=function(o,f){return Object.defineProperty?Object.defineProperty(o,"raw",{value:f}):o.raw=f,o},E=function(o){if(o&&o.__esModule)return o;var f={};if(o!=null)for(var d in o)Object.hasOwnProperty.call(o,d)&&(f[d]=o[d]);return f.default=o,f},b=function(o){return o&&o.__esModule?o:{default:o}},w=function(o,f){if(!f.has(o))throw new TypeError("attempted to get private field on non-instance");return f.get(o)},m=function(o,f,d){if(!f.has(o))throw new TypeError("attempted to set private field on non-instance");return f.set(o,d),d},l("__extends",e),l("__assign",t),l("__rest",i),l("__decorate",n),l("__param",c),l("__metadata",y),l("__awaiter",u),l("__generator",g),l("__exportStar",O),l("__createBinding",s),l("__values",S),l("__read",A),l("__spread",z),l("__spreadArrays",N),l("__await",P),l("__asyncGenerator",q),l("__asyncDelegator",M),l("__asyncValues",B),l("__makeTemplateObject",_),l("__importStar",E),l("__importDefault",b),l("__classPrivateFieldGet",w),l("__classPrivateFieldSet",m)})})(xr);var hi={},dr={},xn;function wc(){if(xn)return dr;xn=1,Object.defineProperty(dr,"__esModule",{value:!0}),dr.delay=void 0;function r(e){return new Promise(t=>{setTimeout(()=>{t(!0)},e)})}return dr.delay=r,dr}var Bt={},li={},Kt={},Tn;function mc(){return Tn||(Tn=1,Object.defineProperty(Kt,"__esModule",{value:!0}),Kt.ONE_THOUSAND=Kt.ONE_HUNDRED=void 0,Kt.ONE_HUNDRED=100,Kt.ONE_THOUSAND=1e3),Kt}var fi={},Pn;function vc(){return Pn||(Pn=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.ONE_YEAR=r.FOUR_WEEKS=r.THREE_WEEKS=r.TWO_WEEKS=r.ONE_WEEK=r.THIRTY_DAYS=r.SEVEN_DAYS=r.FIVE_DAYS=r.THREE_DAYS=r.ONE_DAY=r.TWENTY_FOUR_HOURS=r.TWELVE_HOURS=r.SIX_HOURS=r.THREE_HOURS=r.ONE_HOUR=r.SIXTY_MINUTES=r.THIRTY_MINUTES=r.TEN_MINUTES=r.FIVE_MINUTES=r.ONE_MINUTE=r.SIXTY_SECONDS=r.THIRTY_SECONDS=r.TEN_SECONDS=r.FIVE_SECONDS=r.ONE_SECOND=void 0,r.ONE_SECOND=1,r.FIVE_SECONDS=5,r.TEN_SECONDS=10,r.THIRTY_SECONDS=30,r.SIXTY_SECONDS=60,r.ONE_MINUTE=r.SIXTY_SECONDS,r.FIVE_MINUTES=r.ONE_MINUTE*5,r.TEN_MINUTES=r.ONE_MINUTE*10,r.THIRTY_MINUTES=r.ONE_MINUTE*30,r.SIXTY_MINUTES=r.ONE_MINUTE*60,r.ONE_HOUR=r.SIXTY_MINUTES,r.THREE_HOURS=r.ONE_HOUR*3,r.SIX_HOURS=r.ONE_HOUR*6,r.TWELVE_HOURS=r.ONE_HOUR*12,r.TWENTY_FOUR_HOURS=r.ONE_HOUR*24,r.ONE_DAY=r.TWENTY_FOUR_HOURS,r.THREE_DAYS=r.ONE_DAY*3,r.FIVE_DAYS=r.ONE_DAY*5,r.SEVEN_DAYS=r.ONE_DAY*7,r.THIRTY_DAYS=r.ONE_DAY*30,r.ONE_WEEK=r.SEVEN_DAYS,r.TWO_WEEKS=r.ONE_WEEK*2,r.THREE_WEEKS=r.ONE_WEEK*3,r.FOUR_WEEKS=r.ONE_WEEK*4,r.ONE_YEAR=r.ONE_DAY*365}(fi)),fi}var An;function Js(){return An||(An=1,function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=xr.exports;e.__exportStar(mc(),r),e.__exportStar(vc(),r)}(li)),li}var Nn;function Ec(){if(Nn)return Bt;Nn=1,Object.defineProperty(Bt,"__esModule",{value:!0}),Bt.fromMiliseconds=Bt.toMiliseconds=void 0;const r=Js();function e(i){return i*r.ONE_THOUSAND}Bt.toMiliseconds=e;function t(i){return Math.floor(i/r.ONE_THOUSAND)}return Bt.fromMiliseconds=t,Bt}var Cn;function Dc(){return Cn||(Cn=1,function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=xr.exports;e.__exportStar(wc(),r),e.__exportStar(Ec(),r)}(hi)),hi}var tr={},Rn;function Sc(){if(Rn)return tr;Rn=1,Object.defineProperty(tr,"__esModule",{value:!0}),tr.Watch=void 0;class r{constructor(){this.timestamps=new Map}start(t){if(this.timestamps.has(t))throw new Error(`Watch already started for label: ${t}`);this.timestamps.set(t,{started:Date.now()})}stop(t){const i=this.get(t);if(typeof i.elapsed<"u")throw new Error(`Watch already stopped for label: ${t}`);const n=Date.now()-i.started;this.timestamps.set(t,{started:i.started,elapsed:n})}get(t){const i=this.timestamps.get(t);if(typeof i>"u")throw new Error(`No timestamp found for label: ${t}`);return i}elapsed(t){const i=this.get(t);return i.elapsed||Date.now()-i.started}}return tr.Watch=r,tr.default=r,tr}var di={},gr={},Fn;function Oc(){if(Fn)return gr;Fn=1,Object.defineProperty(gr,"__esModule",{value:!0}),gr.IWatch=void 0;class r{}return gr.IWatch=r,gr}var Un;function Ic(){return Un||(Un=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),xr.exports.__exportStar(Oc(),r)}(di)),di}(function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=xr.exports;e.__exportStar(Dc(),r),e.__exportStar(Sc(),r),e.__exportStar(Ic(),r),e.__exportStar(Js(),r)})(ee);var gi={},pr={};class kt{}const xc=Object.freeze(Object.defineProperty({__proto__:null,IEvents:kt},Symbol.toStringTag,{value:"Module"})),Tc=Go(xc);var Ln;function Pc(){if(Ln)return pr;Ln=1,Object.defineProperty(pr,"__esModule",{value:!0}),pr.IHeartBeat=void 0;const r=Tc;class e extends r.IEvents{constructor(i){super()}}return pr.IHeartBeat=e,pr}var Mn;function Xs(){return Mn||(Mn=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),Ir.exports.__exportStar(Pc(),r)}(gi)),gi}var pi={},Vt={},jn;function Ac(){if(jn)return Vt;jn=1,Object.defineProperty(Vt,"__esModule",{value:!0}),Vt.HEARTBEAT_EVENTS=Vt.HEARTBEAT_INTERVAL=void 0;const r=ee;return Vt.HEARTBEAT_INTERVAL=r.FIVE_SECONDS,Vt.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Vt}var $n;function Zs(){return $n||($n=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),Ir.exports.__exportStar(Ac(),r)}(pi)),pi}var zn;function Nc(){if(zn)return fr;zn=1,Object.defineProperty(fr,"__esModule",{value:!0}),fr.HeartBeat=void 0;const r=Ir.exports,e=yt.exports,t=ee,i=Xs(),n=Zs();class c extends i.IHeartBeat{constructor(u){super(u),this.events=new e.EventEmitter,this.interval=n.HEARTBEAT_INTERVAL,this.interval=(u==null?void 0:u.interval)||n.HEARTBEAT_INTERVAL}static init(u){return r.__awaiter(this,void 0,void 0,function*(){const g=new c(u);return yield g.init(),g})}init(){return r.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(u,g){this.events.on(u,g)}once(u,g){this.events.once(u,g)}off(u,g){this.events.off(u,g)}removeListener(u,g){this.events.removeListener(u,g)}initialize(){return r.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),t.toMiliseconds(this.interval))})}pulse(){this.events.emit(n.HEARTBEAT_EVENTS.pulse)}}return fr.HeartBeat=c,fr}(function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=Ir.exports;e.__exportStar(Nc(),r),e.__exportStar(Xs(),r),e.__exportStar(Zs(),r)})(Or);var Se={},Qs={exports:{}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */(function(r){var e,t,i,n,c,y,u,g,O,S,A,z,N,P,q,M,B,_,E,b,w,m,s;(function(l){var H=typeof globalThis=="object"?globalThis:typeof self=="object"?self:typeof this=="object"?this:{};l(o(H,o(r.exports)));function o(f,d){return f!==H&&(typeof Object.create=="function"?Object.defineProperty(f,"__esModule",{value:!0}):f.__esModule=!0),function(v,p){return f[v]=d?d(v,p):p}}})(function(l){var H=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,f){o.__proto__=f}||function(o,f){for(var d in f)f.hasOwnProperty(d)&&(o[d]=f[d])};e=function(o,f){H(o,f);function d(){this.constructor=o}o.prototype=f===null?Object.create(f):(d.prototype=f.prototype,new d)},t=Object.assign||function(o){for(var f,d=1,v=arguments.length;d<v;d++){f=arguments[d];for(var p in f)Object.prototype.hasOwnProperty.call(f,p)&&(o[p]=f[p])}return o},i=function(o,f){var d={};for(var v in o)Object.prototype.hasOwnProperty.call(o,v)&&f.indexOf(v)<0&&(d[v]=o[v]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var p=0,v=Object.getOwnPropertySymbols(o);p<v.length;p++)f.indexOf(v[p])<0&&Object.prototype.propertyIsEnumerable.call(o,v[p])&&(d[v[p]]=o[v[p]]);return d},n=function(o,f,d,v){var p=arguments.length,h=p<3?f:v===null?v=Object.getOwnPropertyDescriptor(f,d):v,T;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(o,f,d,v);else for(var F=o.length-1;F>=0;F--)(T=o[F])&&(h=(p<3?T(h):p>3?T(f,d,h):T(f,d))||h);return p>3&&h&&Object.defineProperty(f,d,h),h},c=function(o,f){return function(d,v){f(d,v,o)}},y=function(o,f){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(o,f)},u=function(o,f,d,v){function p(h){return h instanceof d?h:new d(function(T){T(h)})}return new(d||(d=Promise))(function(h,T){function F(j){try{I(v.next(j))}catch(K){T(K)}}function $(j){try{I(v.throw(j))}catch(K){T(K)}}function I(j){j.done?h(j.value):p(j.value).then(F,$)}I((v=v.apply(o,f||[])).next())})},g=function(o,f){var d={label:0,sent:function(){if(h[0]&1)throw h[1];return h[1]},trys:[],ops:[]},v,p,h,T;return T={next:F(0),throw:F(1),return:F(2)},typeof Symbol=="function"&&(T[Symbol.iterator]=function(){return this}),T;function F(I){return function(j){return $([I,j])}}function $(I){if(v)throw new TypeError("Generator is already executing.");for(;d;)try{if(v=1,p&&(h=I[0]&2?p.return:I[0]?p.throw||((h=p.return)&&h.call(p),0):p.next)&&!(h=h.call(p,I[1])).done)return h;switch(p=0,h&&(I=[I[0]&2,h.value]),I[0]){case 0:case 1:h=I;break;case 4:return d.label++,{value:I[1],done:!1};case 5:d.label++,p=I[1],I=[0];continue;case 7:I=d.ops.pop(),d.trys.pop();continue;default:if(h=d.trys,!(h=h.length>0&&h[h.length-1])&&(I[0]===6||I[0]===2)){d=0;continue}if(I[0]===3&&(!h||I[1]>h[0]&&I[1]<h[3])){d.label=I[1];break}if(I[0]===6&&d.label<h[1]){d.label=h[1],h=I;break}if(h&&d.label<h[2]){d.label=h[2],d.ops.push(I);break}h[2]&&d.ops.pop(),d.trys.pop();continue}I=f.call(o,d)}catch(j){I=[6,j],p=0}finally{v=h=0}if(I[0]&5)throw I[1];return{value:I[0]?I[1]:void 0,done:!0}}},s=function(o,f,d,v){v===void 0&&(v=d),o[v]=f[d]},O=function(o,f){for(var d in o)d!=="default"&&!f.hasOwnProperty(d)&&(f[d]=o[d])},S=function(o){var f=typeof Symbol=="function"&&Symbol.iterator,d=f&&o[f],v=0;if(d)return d.call(o);if(o&&typeof o.length=="number")return{next:function(){return o&&v>=o.length&&(o=void 0),{value:o&&o[v++],done:!o}}};throw new TypeError(f?"Object is not iterable.":"Symbol.iterator is not defined.")},A=function(o,f){var d=typeof Symbol=="function"&&o[Symbol.iterator];if(!d)return o;var v=d.call(o),p,h=[],T;try{for(;(f===void 0||f-- >0)&&!(p=v.next()).done;)h.push(p.value)}catch(F){T={error:F}}finally{try{p&&!p.done&&(d=v.return)&&d.call(v)}finally{if(T)throw T.error}}return h},z=function(){for(var o=[],f=0;f<arguments.length;f++)o=o.concat(A(arguments[f]));return o},N=function(){for(var o=0,f=0,d=arguments.length;f<d;f++)o+=arguments[f].length;for(var v=Array(o),p=0,f=0;f<d;f++)for(var h=arguments[f],T=0,F=h.length;T<F;T++,p++)v[p]=h[T];return v},P=function(o){return this instanceof P?(this.v=o,this):new P(o)},q=function(o,f,d){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var v=d.apply(o,f||[]),p,h=[];return p={},T("next"),T("throw"),T("return"),p[Symbol.asyncIterator]=function(){return this},p;function T(G){v[G]&&(p[G]=function(V){return new Promise(function(Q,Y){h.push([G,V,Q,Y])>1||F(G,V)})})}function F(G,V){try{$(v[G](V))}catch(Q){K(h[0][3],Q)}}function $(G){G.value instanceof P?Promise.resolve(G.value.v).then(I,j):K(h[0][2],G)}function I(G){F("next",G)}function j(G){F("throw",G)}function K(G,V){G(V),h.shift(),h.length&&F(h[0][0],h[0][1])}},M=function(o){var f,d;return f={},v("next"),v("throw",function(p){throw p}),v("return"),f[Symbol.iterator]=function(){return this},f;function v(p,h){f[p]=o[p]?function(T){return(d=!d)?{value:P(o[p](T)),done:p==="return"}:h?h(T):T}:h}},B=function(o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var f=o[Symbol.asyncIterator],d;return f?f.call(o):(o=typeof S=="function"?S(o):o[Symbol.iterator](),d={},v("next"),v("throw"),v("return"),d[Symbol.asyncIterator]=function(){return this},d);function v(h){d[h]=o[h]&&function(T){return new Promise(function(F,$){T=o[h](T),p(F,$,T.done,T.value)})}}function p(h,T,F,$){Promise.resolve($).then(function(I){h({value:I,done:F})},T)}},_=function(o,f){return Object.defineProperty?Object.defineProperty(o,"raw",{value:f}):o.raw=f,o},E=function(o){if(o&&o.__esModule)return o;var f={};if(o!=null)for(var d in o)Object.hasOwnProperty.call(o,d)&&(f[d]=o[d]);return f.default=o,f},b=function(o){return o&&o.__esModule?o:{default:o}},w=function(o,f){if(!f.has(o))throw new TypeError("attempted to get private field on non-instance");return f.get(o)},m=function(o,f,d){if(!f.has(o))throw new TypeError("attempted to set private field on non-instance");return f.set(o,d),d},l("__extends",e),l("__assign",t),l("__rest",i),l("__decorate",n),l("__param",c),l("__metadata",y),l("__awaiter",u),l("__generator",g),l("__exportStar",O),l("__createBinding",s),l("__values",S),l("__read",A),l("__spread",z),l("__spreadArrays",N),l("__await",P),l("__asyncGenerator",q),l("__asyncDelegator",M),l("__asyncValues",B),l("__makeTemplateObject",_),l("__importStar",E),l("__importDefault",b),l("__classPrivateFieldGet",w),l("__classPrivateFieldSet",m)})})(Qs);var Gt={},Hn;function ea(){return Hn||(Hn=1,Object.defineProperty(Gt,"__esModule",{value:!0}),Gt.PINO_CUSTOM_CONTEXT_KEY=Gt.PINO_LOGGER_DEFAULTS=void 0,Gt.PINO_LOGGER_DEFAULTS={level:"info"},Gt.PINO_CUSTOM_CONTEXT_KEY="custom_context"),Gt}var nt={},qn;function Cc(){if(qn)return nt;qn=1,Object.defineProperty(nt,"__esModule",{value:!0}),nt.generateChildLogger=nt.formatChildLoggerContext=nt.getLoggerContext=nt.setBrowserLoggerContext=nt.getBrowserLoggerContext=nt.getDefaultLoggerOptions=void 0;const r=ea();function e(u){return Object.assign(Object.assign({},u),{level:(u==null?void 0:u.level)||r.PINO_LOGGER_DEFAULTS.level})}nt.getDefaultLoggerOptions=e;function t(u,g=r.PINO_CUSTOM_CONTEXT_KEY){return u[g]||""}nt.getBrowserLoggerContext=t;function i(u,g,O=r.PINO_CUSTOM_CONTEXT_KEY){return u[O]=g,u}nt.setBrowserLoggerContext=i;function n(u,g=r.PINO_CUSTOM_CONTEXT_KEY){let O="";return typeof u.bindings>"u"?O=t(u,g):O=u.bindings().context||"",O}nt.getLoggerContext=n;function c(u,g,O=r.PINO_CUSTOM_CONTEXT_KEY){const S=n(u,O);return S.trim()?`${S}/${g}`:g}nt.formatChildLoggerContext=c;function y(u,g,O=r.PINO_CUSTOM_CONTEXT_KEY){const S=c(u,g,O),A=u.child({context:S});return i(A,S,O)}return nt.generateChildLogger=y,nt}(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.pino=void 0;const e=Qs.exports,t=e.__importDefault(Dr);Object.defineProperty(r,"pino",{enumerable:!0,get:function(){return t.default}}),e.__exportStar(ea(),r),e.__exportStar(Cc(),r)})(Se);class Rc extends kt{constructor(e){super(),this.opts=e,this.protocol="wc",this.version=2}}class Fc extends kt{constructor(e,t){super(),this.core=e,this.logger=t,this.records=new Map}}class Uc{constructor(e,t){this.logger=e,this.core=t}}class Lc extends kt{constructor(e,t){super(),this.relayer=e,this.logger=t}}class Mc extends kt{constructor(e){super()}}class jc{constructor(e,t,i,n){this.core=e,this.logger=t,this.name=i}}class $c extends kt{constructor(e,t){super(),this.relayer=e,this.logger=t}}class zc extends kt{constructor(e,t){super(),this.core=e,this.logger=t}}class Hc{constructor(e){this.opts=e,this.protocol="wc",this.version=2}}class qc{constructor(e){this.client=e}}var Gi={},ir={},Zr={},Qr={};Object.defineProperty(Qr,"__esModule",{value:!0});Qr.BrowserRandomSource=void 0;const Bn=65536;class Bc{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const e=typeof self<"u"?self.crypto||self.msCrypto:null;e&&e.getRandomValues!==void 0&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const t=new Uint8Array(e);for(let i=0;i<t.length;i+=Bn)this._crypto.getRandomValues(t.subarray(i,i+Math.min(t.length-i,Bn)));return t}}Qr.BrowserRandomSource=Bc;function Kc(r){throw new Error('Could not dynamically require "'+r+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var ei={},lt={};Object.defineProperty(lt,"__esModule",{value:!0});function Vc(r){for(var e=0;e<r.length;e++)r[e]=0;return r}lt.wipe=Vc;Object.defineProperty(ei,"__esModule",{value:!0});ei.NodeRandomSource=void 0;const Gc=lt;class Wc{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof Kc<"u"){const e=Wo;e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let t=this._crypto.randomBytes(e);if(t.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");const i=new Uint8Array(e);for(let n=0;n<i.length;n++)i[n]=t[n];return(0,Gc.wipe)(t),i}}ei.NodeRandomSource=Wc;Object.defineProperty(Zr,"__esModule",{value:!0});Zr.SystemRandomSource=void 0;const kc=Qr,Yc=ei;class Jc{constructor(){if(this.isAvailable=!1,this.name="",this._source=new kc.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new Yc.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)}}Zr.SystemRandomSource=Jc;var ie={},ta={};(function(r){Object.defineProperty(r,"__esModule",{value:!0});function e(u,g){var O=u>>>16&65535,S=u&65535,A=g>>>16&65535,z=g&65535;return S*z+(O*z+S*A<<16>>>0)|0}r.mul=Math.imul||e;function t(u,g){return u+g|0}r.add=t;function i(u,g){return u-g|0}r.sub=i;function n(u,g){return u<<g|u>>>32-g}r.rotl=n;function c(u,g){return u<<32-g|u>>>g}r.rotr=c;function y(u){return typeof u=="number"&&isFinite(u)&&Math.floor(u)===u}r.isInteger=Number.isInteger||y,r.MAX_SAFE_INTEGER=9007199254740991,r.isSafeInteger=function(u){return r.isInteger(u)&&u>=-r.MAX_SAFE_INTEGER&&u<=r.MAX_SAFE_INTEGER}})(ta);Object.defineProperty(ie,"__esModule",{value:!0});var ra=ta;function Xc(r,e){return e===void 0&&(e=0),(r[e+0]<<8|r[e+1])<<16>>16}ie.readInt16BE=Xc;function Zc(r,e){return e===void 0&&(e=0),(r[e+0]<<8|r[e+1])>>>0}ie.readUint16BE=Zc;function Qc(r,e){return e===void 0&&(e=0),(r[e+1]<<8|r[e])<<16>>16}ie.readInt16LE=Qc;function eu(r,e){return e===void 0&&(e=0),(r[e+1]<<8|r[e])>>>0}ie.readUint16LE=eu;function ia(r,e,t){return e===void 0&&(e=new Uint8Array(2)),t===void 0&&(t=0),e[t+0]=r>>>8,e[t+1]=r>>>0,e}ie.writeUint16BE=ia;ie.writeInt16BE=ia;function na(r,e,t){return e===void 0&&(e=new Uint8Array(2)),t===void 0&&(t=0),e[t+0]=r>>>0,e[t+1]=r>>>8,e}ie.writeUint16LE=na;ie.writeInt16LE=na;function Di(r,e){return e===void 0&&(e=0),r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3]}ie.readInt32BE=Di;function Si(r,e){return e===void 0&&(e=0),(r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3])>>>0}ie.readUint32BE=Si;function Oi(r,e){return e===void 0&&(e=0),r[e+3]<<24|r[e+2]<<16|r[e+1]<<8|r[e]}ie.readInt32LE=Oi;function Ii(r,e){return e===void 0&&(e=0),(r[e+3]<<24|r[e+2]<<16|r[e+1]<<8|r[e])>>>0}ie.readUint32LE=Ii;function Vr(r,e,t){return e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0),e[t+0]=r>>>24,e[t+1]=r>>>16,e[t+2]=r>>>8,e[t+3]=r>>>0,e}ie.writeUint32BE=Vr;ie.writeInt32BE=Vr;function Gr(r,e,t){return e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0),e[t+0]=r>>>0,e[t+1]=r>>>8,e[t+2]=r>>>16,e[t+3]=r>>>24,e}ie.writeUint32LE=Gr;ie.writeInt32LE=Gr;function tu(r,e){e===void 0&&(e=0);var t=Di(r,e),i=Di(r,e+4);return t*4294967296+i-(i>>31)*4294967296}ie.readInt64BE=tu;function ru(r,e){e===void 0&&(e=0);var t=Si(r,e),i=Si(r,e+4);return t*4294967296+i}ie.readUint64BE=ru;function iu(r,e){e===void 0&&(e=0);var t=Oi(r,e),i=Oi(r,e+4);return i*4294967296+t-(t>>31)*4294967296}ie.readInt64LE=iu;function nu(r,e){e===void 0&&(e=0);var t=Ii(r,e),i=Ii(r,e+4);return i*4294967296+t}ie.readUint64LE=nu;function sa(r,e,t){return e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0),Vr(r/4294967296>>>0,e,t),Vr(r>>>0,e,t+4),e}ie.writeUint64BE=sa;ie.writeInt64BE=sa;function aa(r,e,t){return e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0),Gr(r>>>0,e,t),Gr(r/4294967296>>>0,e,t+4),e}ie.writeUint64LE=aa;ie.writeInt64LE=aa;function su(r,e,t){if(t===void 0&&(t=0),r%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(r/8>e.length-t)throw new Error("readUintBE: array is too short for the given bitLength");for(var i=0,n=1,c=r/8+t-1;c>=t;c--)i+=e[c]*n,n*=256;return i}ie.readUintBE=su;function au(r,e,t){if(t===void 0&&(t=0),r%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(r/8>e.length-t)throw new Error("readUintLE: array is too short for the given bitLength");for(var i=0,n=1,c=t;c<t+r/8;c++)i+=e[c]*n,n*=256;return i}ie.readUintLE=au;function ou(r,e,t,i){if(t===void 0&&(t=new Uint8Array(r/8)),i===void 0&&(i=0),r%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!ra.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var n=1,c=r/8+i-1;c>=i;c--)t[c]=e/n&255,n*=256;return t}ie.writeUintBE=ou;function cu(r,e,t,i){if(t===void 0&&(t=new Uint8Array(r/8)),i===void 0&&(i=0),r%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!ra.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var n=1,c=i;c<i+r/8;c++)t[c]=e/n&255,n*=256;return t}ie.writeUintLE=cu;function uu(r,e){e===void 0&&(e=0);var t=new DataView(r.buffer,r.byteOffset,r.byteLength);return t.getFloat32(e)}ie.readFloat32BE=uu;function hu(r,e){e===void 0&&(e=0);var t=new DataView(r.buffer,r.byteOffset,r.byteLength);return t.getFloat32(e,!0)}ie.readFloat32LE=hu;function lu(r,e){e===void 0&&(e=0);var t=new DataView(r.buffer,r.byteOffset,r.byteLength);return t.getFloat64(e)}ie.readFloat64BE=lu;function fu(r,e){e===void 0&&(e=0);var t=new DataView(r.buffer,r.byteOffset,r.byteLength);return t.getFloat64(e,!0)}ie.readFloat64LE=fu;function du(r,e,t){e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat32(t,r),e}ie.writeFloat32BE=du;function gu(r,e,t){e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat32(t,r,!0),e}ie.writeFloat32LE=gu;function pu(r,e,t){e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat64(t,r),e}ie.writeFloat64BE=pu;function yu(r,e,t){e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat64(t,r,!0),e}ie.writeFloat64LE=yu;(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.randomStringForEntropy=r.randomString=r.randomUint32=r.randomBytes=r.defaultRandomSource=void 0;const e=Zr,t=ie,i=lt;r.defaultRandomSource=new e.SystemRandomSource;function n(O,S=r.defaultRandomSource){return S.randomBytes(O)}r.randomBytes=n;function c(O=r.defaultRandomSource){const S=n(4,O),A=(0,t.readUint32LE)(S);return(0,i.wipe)(S),A}r.randomUint32=c;const y="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function u(O,S=y,A=r.defaultRandomSource){if(S.length<2)throw new Error("randomString charset is too short");if(S.length>256)throw new Error("randomString charset is too long");let z="";const N=S.length,P=256-256%N;for(;O>0;){const q=n(Math.ceil(O*256/P),A);for(let M=0;M<q.length&&O>0;M++){const B=q[M];B<P&&(z+=S.charAt(B%N),O--)}(0,i.wipe)(q)}return z}r.randomString=u;function g(O,S=y,A=r.defaultRandomSource){const z=Math.ceil(O/(Math.log(S.length)/Math.LN2));return u(z,S,A)}r.randomStringForEntropy=g})(ir);var oa={};(function(r){Object.defineProperty(r,"__esModule",{value:!0});var e=ie,t=lt;r.DIGEST_LENGTH=64,r.BLOCK_SIZE=128;var i=function(){function u(){this.digestLength=r.DIGEST_LENGTH,this.blockSize=r.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return u.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},u.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},u.prototype.clean=function(){t.wipe(this._buffer),t.wipe(this._tempHi),t.wipe(this._tempLo),this.reset()},u.prototype.update=function(g,O){if(O===void 0&&(O=g.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var S=0;if(this._bytesHashed+=O,this._bufferLength>0){for(;this._bufferLength<r.BLOCK_SIZE&&O>0;)this._buffer[this._bufferLength++]=g[S++],O--;this._bufferLength===this.blockSize&&(c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(O>=this.blockSize&&(S=c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,g,S,O),O%=this.blockSize);O>0;)this._buffer[this._bufferLength++]=g[S++],O--;return this},u.prototype.finish=function(g){if(!this._finished){var O=this._bytesHashed,S=this._bufferLength,A=O/536870912|0,z=O<<3,N=O%128<112?128:256;this._buffer[S]=128;for(var P=S+1;P<N-8;P++)this._buffer[P]=0;e.writeUint32BE(A,this._buffer,N-8),e.writeUint32BE(z,this._buffer,N-4),c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,N),this._finished=!0}for(var P=0;P<this.digestLength/8;P++)e.writeUint32BE(this._stateHi[P],g,P*8),e.writeUint32BE(this._stateLo[P],g,P*8+4);return this},u.prototype.digest=function(){var g=new Uint8Array(this.digestLength);return this.finish(g),g},u.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},u.prototype.restoreState=function(g){return this._stateHi.set(g.stateHi),this._stateLo.set(g.stateLo),this._bufferLength=g.bufferLength,g.buffer&&this._buffer.set(g.buffer),this._bytesHashed=g.bytesHashed,this._finished=!1,this},u.prototype.cleanSavedState=function(g){t.wipe(g.stateHi),t.wipe(g.stateLo),g.buffer&&t.wipe(g.buffer),g.bufferLength=0,g.bytesHashed=0},u}();r.SHA512=i;var n=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function c(u,g,O,S,A,z,N){for(var P=O[0],q=O[1],M=O[2],B=O[3],_=O[4],E=O[5],b=O[6],w=O[7],m=S[0],s=S[1],l=S[2],H=S[3],o=S[4],f=S[5],d=S[6],v=S[7],p,h,T,F,$,I,j,K;N>=128;){for(var G=0;G<16;G++){var V=8*G+z;u[G]=e.readUint32BE(A,V),g[G]=e.readUint32BE(A,V+4)}for(var G=0;G<80;G++){var Q=P,Y=q,oe=M,L=B,U=_,C=E,a=b,x=w,k=m,X=s,le=l,_e=H,de=o,me=f,Fe=d,Ae=v;if(p=w,h=v,$=h&65535,I=h>>>16,j=p&65535,K=p>>>16,p=(_>>>14|o<<32-14)^(_>>>18|o<<32-18)^(o>>>41-32|_<<32-(41-32)),h=(o>>>14|_<<32-14)^(o>>>18|_<<32-18)^(_>>>41-32|o<<32-(41-32)),$+=h&65535,I+=h>>>16,j+=p&65535,K+=p>>>16,p=_&E^~_&b,h=o&f^~o&d,$+=h&65535,I+=h>>>16,j+=p&65535,K+=p>>>16,p=n[G*2],h=n[G*2+1],$+=h&65535,I+=h>>>16,j+=p&65535,K+=p>>>16,p=u[G%16],h=g[G%16],$+=h&65535,I+=h>>>16,j+=p&65535,K+=p>>>16,I+=$>>>16,j+=I>>>16,K+=j>>>16,T=j&65535|K<<16,F=$&65535|I<<16,p=T,h=F,$=h&65535,I=h>>>16,j=p&65535,K=p>>>16,p=(P>>>28|m<<32-28)^(m>>>34-32|P<<32-(34-32))^(m>>>39-32|P<<32-(39-32)),h=(m>>>28|P<<32-28)^(P>>>34-32|m<<32-(34-32))^(P>>>39-32|m<<32-(39-32)),$+=h&65535,I+=h>>>16,j+=p&65535,K+=p>>>16,p=P&q^P&M^q&M,h=m&s^m&l^s&l,$+=h&65535,I+=h>>>16,j+=p&65535,K+=p>>>16,I+=$>>>16,j+=I>>>16,K+=j>>>16,x=j&65535|K<<16,Ae=$&65535|I<<16,p=L,h=_e,$=h&65535,I=h>>>16,j=p&65535,K=p>>>16,p=T,h=F,$+=h&65535,I+=h>>>16,j+=p&65535,K+=p>>>16,I+=$>>>16,j+=I>>>16,K+=j>>>16,L=j&65535|K<<16,_e=$&65535|I<<16,q=Q,M=Y,B=oe,_=L,E=U,b=C,w=a,P=x,s=k,l=X,H=le,o=_e,f=de,d=me,v=Fe,m=Ae,G%16===15)for(var V=0;V<16;V++)p=u[V],h=g[V],$=h&65535,I=h>>>16,j=p&65535,K=p>>>16,p=u[(V+9)%16],h=g[(V+9)%16],$+=h&65535,I+=h>>>16,j+=p&65535,K+=p>>>16,T=u[(V+1)%16],F=g[(V+1)%16],p=(T>>>1|F<<32-1)^(T>>>8|F<<32-8)^T>>>7,h=(F>>>1|T<<32-1)^(F>>>8|T<<32-8)^(F>>>7|T<<32-7),$+=h&65535,I+=h>>>16,j+=p&65535,K+=p>>>16,T=u[(V+14)%16],F=g[(V+14)%16],p=(T>>>19|F<<32-19)^(F>>>61-32|T<<32-(61-32))^T>>>6,h=(F>>>19|T<<32-19)^(T>>>61-32|F<<32-(61-32))^(F>>>6|T<<32-6),$+=h&65535,I+=h>>>16,j+=p&65535,K+=p>>>16,I+=$>>>16,j+=I>>>16,K+=j>>>16,u[V]=j&65535|K<<16,g[V]=$&65535|I<<16}p=P,h=m,$=h&65535,I=h>>>16,j=p&65535,K=p>>>16,p=O[0],h=S[0],$+=h&65535,I+=h>>>16,j+=p&65535,K+=p>>>16,I+=$>>>16,j+=I>>>16,K+=j>>>16,O[0]=P=j&65535|K<<16,S[0]=m=$&65535|I<<16,p=q,h=s,$=h&65535,I=h>>>16,j=p&65535,K=p>>>16,p=O[1],h=S[1],$+=h&65535,I+=h>>>16,j+=p&65535,K+=p>>>16,I+=$>>>16,j+=I>>>16,K+=j>>>16,O[1]=q=j&65535|K<<16,S[1]=s=$&65535|I<<16,p=M,h=l,$=h&65535,I=h>>>16,j=p&65535,K=p>>>16,p=O[2],h=S[2],$+=h&65535,I+=h>>>16,j+=p&65535,K+=p>>>16,I+=$>>>16,j+=I>>>16,K+=j>>>16,O[2]=M=j&65535|K<<16,S[2]=l=$&65535|I<<16,p=B,h=H,$=h&65535,I=h>>>16,j=p&65535,K=p>>>16,p=O[3],h=S[3],$+=h&65535,I+=h>>>16,j+=p&65535,K+=p>>>16,I+=$>>>16,j+=I>>>16,K+=j>>>16,O[3]=B=j&65535|K<<16,S[3]=H=$&65535|I<<16,p=_,h=o,$=h&65535,I=h>>>16,j=p&65535,K=p>>>16,p=O[4],h=S[4],$+=h&65535,I+=h>>>16,j+=p&65535,K+=p>>>16,I+=$>>>16,j+=I>>>16,K+=j>>>16,O[4]=_=j&65535|K<<16,S[4]=o=$&65535|I<<16,p=E,h=f,$=h&65535,I=h>>>16,j=p&65535,K=p>>>16,p=O[5],h=S[5],$+=h&65535,I+=h>>>16,j+=p&65535,K+=p>>>16,I+=$>>>16,j+=I>>>16,K+=j>>>16,O[5]=E=j&65535|K<<16,S[5]=f=$&65535|I<<16,p=b,h=d,$=h&65535,I=h>>>16,j=p&65535,K=p>>>16,p=O[6],h=S[6],$+=h&65535,I+=h>>>16,j+=p&65535,K+=p>>>16,I+=$>>>16,j+=I>>>16,K+=j>>>16,O[6]=b=j&65535|K<<16,S[6]=d=$&65535|I<<16,p=w,h=v,$=h&65535,I=h>>>16,j=p&65535,K=p>>>16,p=O[7],h=S[7],$+=h&65535,I+=h>>>16,j+=p&65535,K+=p>>>16,I+=$>>>16,j+=I>>>16,K+=j>>>16,O[7]=w=j&65535|K<<16,S[7]=v=$&65535|I<<16,z+=128,N-=128}return z}function y(u){var g=new i;g.update(u);var O=g.digest();return g.clean(),O}r.hash=y})(oa);(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.convertSecretKeyToX25519=r.convertPublicKeyToX25519=r.verify=r.sign=r.extractPublicKeyFromSecretKey=r.generateKeyPair=r.generateKeyPairFromSeed=r.SEED_LENGTH=r.SECRET_KEY_LENGTH=r.PUBLIC_KEY_LENGTH=r.SIGNATURE_LENGTH=void 0;const e=ir,t=oa,i=lt;r.SIGNATURE_LENGTH=64,r.PUBLIC_KEY_LENGTH=32,r.SECRET_KEY_LENGTH=64,r.SEED_LENGTH=32;function n(L){const U=new Float64Array(16);if(L)for(let C=0;C<L.length;C++)U[C]=L[C];return U}const c=new Uint8Array(32);c[0]=9;const y=n(),u=n([1]),g=n([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),O=n([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),S=n([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),A=n([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),z=n([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function N(L,U){for(let C=0;C<16;C++)L[C]=U[C]|0}function P(L){let U=1;for(let C=0;C<16;C++){let a=L[C]+U+65535;U=Math.floor(a/65536),L[C]=a-U*65536}L[0]+=U-1+37*(U-1)}function q(L,U,C){const a=~(C-1);for(let x=0;x<16;x++){const k=a&(L[x]^U[x]);L[x]^=k,U[x]^=k}}function M(L,U){const C=n(),a=n();for(let x=0;x<16;x++)a[x]=U[x];P(a),P(a),P(a);for(let x=0;x<2;x++){C[0]=a[0]-65517;for(let X=1;X<15;X++)C[X]=a[X]-65535-(C[X-1]>>16&1),C[X-1]&=65535;C[15]=a[15]-32767-(C[14]>>16&1);const k=C[15]>>16&1;C[14]&=65535,q(a,C,1-k)}for(let x=0;x<16;x++)L[2*x]=a[x]&255,L[2*x+1]=a[x]>>8}function B(L,U){let C=0;for(let a=0;a<32;a++)C|=L[a]^U[a];return(1&C-1>>>8)-1}function _(L,U){const C=new Uint8Array(32),a=new Uint8Array(32);return M(C,L),M(a,U),B(C,a)}function E(L){const U=new Uint8Array(32);return M(U,L),U[0]&1}function b(L,U){for(let C=0;C<16;C++)L[C]=U[2*C]+(U[2*C+1]<<8);L[15]&=32767}function w(L,U,C){for(let a=0;a<16;a++)L[a]=U[a]+C[a]}function m(L,U,C){for(let a=0;a<16;a++)L[a]=U[a]-C[a]}function s(L,U,C){let a,x,k=0,X=0,le=0,_e=0,de=0,me=0,Fe=0,Ae=0,ye=0,ge=0,fe=0,ue=0,ce=0,ae=0,se=0,te=0,he=0,pe=0,re=0,be=0,we=0,Ee=0,De=0,ve=0,_t=0,wt=0,Pt=0,ut=0,$t=0,ar=0,Rr=0,Le=C[0],Ne=C[1],Me=C[2],je=C[3],$e=C[4],Ce=C[5],qe=C[6],Be=C[7],Ke=C[8],Ve=C[9],Ge=C[10],He=C[11],ze=C[12],Te=C[13],We=C[14],ke=C[15];a=U[0],k+=a*Le,X+=a*Ne,le+=a*Me,_e+=a*je,de+=a*$e,me+=a*Ce,Fe+=a*qe,Ae+=a*Be,ye+=a*Ke,ge+=a*Ve,fe+=a*Ge,ue+=a*He,ce+=a*ze,ae+=a*Te,se+=a*We,te+=a*ke,a=U[1],X+=a*Le,le+=a*Ne,_e+=a*Me,de+=a*je,me+=a*$e,Fe+=a*Ce,Ae+=a*qe,ye+=a*Be,ge+=a*Ke,fe+=a*Ve,ue+=a*Ge,ce+=a*He,ae+=a*ze,se+=a*Te,te+=a*We,he+=a*ke,a=U[2],le+=a*Le,_e+=a*Ne,de+=a*Me,me+=a*je,Fe+=a*$e,Ae+=a*Ce,ye+=a*qe,ge+=a*Be,fe+=a*Ke,ue+=a*Ve,ce+=a*Ge,ae+=a*He,se+=a*ze,te+=a*Te,he+=a*We,pe+=a*ke,a=U[3],_e+=a*Le,de+=a*Ne,me+=a*Me,Fe+=a*je,Ae+=a*$e,ye+=a*Ce,ge+=a*qe,fe+=a*Be,ue+=a*Ke,ce+=a*Ve,ae+=a*Ge,se+=a*He,te+=a*ze,he+=a*Te,pe+=a*We,re+=a*ke,a=U[4],de+=a*Le,me+=a*Ne,Fe+=a*Me,Ae+=a*je,ye+=a*$e,ge+=a*Ce,fe+=a*qe,ue+=a*Be,ce+=a*Ke,ae+=a*Ve,se+=a*Ge,te+=a*He,he+=a*ze,pe+=a*Te,re+=a*We,be+=a*ke,a=U[5],me+=a*Le,Fe+=a*Ne,Ae+=a*Me,ye+=a*je,ge+=a*$e,fe+=a*Ce,ue+=a*qe,ce+=a*Be,ae+=a*Ke,se+=a*Ve,te+=a*Ge,he+=a*He,pe+=a*ze,re+=a*Te,be+=a*We,we+=a*ke,a=U[6],Fe+=a*Le,Ae+=a*Ne,ye+=a*Me,ge+=a*je,fe+=a*$e,ue+=a*Ce,ce+=a*qe,ae+=a*Be,se+=a*Ke,te+=a*Ve,he+=a*Ge,pe+=a*He,re+=a*ze,be+=a*Te,we+=a*We,Ee+=a*ke,a=U[7],Ae+=a*Le,ye+=a*Ne,ge+=a*Me,fe+=a*je,ue+=a*$e,ce+=a*Ce,ae+=a*qe,se+=a*Be,te+=a*Ke,he+=a*Ve,pe+=a*Ge,re+=a*He,be+=a*ze,we+=a*Te,Ee+=a*We,De+=a*ke,a=U[8],ye+=a*Le,ge+=a*Ne,fe+=a*Me,ue+=a*je,ce+=a*$e,ae+=a*Ce,se+=a*qe,te+=a*Be,he+=a*Ke,pe+=a*Ve,re+=a*Ge,be+=a*He,we+=a*ze,Ee+=a*Te,De+=a*We,ve+=a*ke,a=U[9],ge+=a*Le,fe+=a*Ne,ue+=a*Me,ce+=a*je,ae+=a*$e,se+=a*Ce,te+=a*qe,he+=a*Be,pe+=a*Ke,re+=a*Ve,be+=a*Ge,we+=a*He,Ee+=a*ze,De+=a*Te,ve+=a*We,_t+=a*ke,a=U[10],fe+=a*Le,ue+=a*Ne,ce+=a*Me,ae+=a*je,se+=a*$e,te+=a*Ce,he+=a*qe,pe+=a*Be,re+=a*Ke,be+=a*Ve,we+=a*Ge,Ee+=a*He,De+=a*ze,ve+=a*Te,_t+=a*We,wt+=a*ke,a=U[11],ue+=a*Le,ce+=a*Ne,ae+=a*Me,se+=a*je,te+=a*$e,he+=a*Ce,pe+=a*qe,re+=a*Be,be+=a*Ke,we+=a*Ve,Ee+=a*Ge,De+=a*He,ve+=a*ze,_t+=a*Te,wt+=a*We,Pt+=a*ke,a=U[12],ce+=a*Le,ae+=a*Ne,se+=a*Me,te+=a*je,he+=a*$e,pe+=a*Ce,re+=a*qe,be+=a*Be,we+=a*Ke,Ee+=a*Ve,De+=a*Ge,ve+=a*He,_t+=a*ze,wt+=a*Te,Pt+=a*We,ut+=a*ke,a=U[13],ae+=a*Le,se+=a*Ne,te+=a*Me,he+=a*je,pe+=a*$e,re+=a*Ce,be+=a*qe,we+=a*Be,Ee+=a*Ke,De+=a*Ve,ve+=a*Ge,_t+=a*He,wt+=a*ze,Pt+=a*Te,ut+=a*We,$t+=a*ke,a=U[14],se+=a*Le,te+=a*Ne,he+=a*Me,pe+=a*je,re+=a*$e,be+=a*Ce,we+=a*qe,Ee+=a*Be,De+=a*Ke,ve+=a*Ve,_t+=a*Ge,wt+=a*He,Pt+=a*ze,ut+=a*Te,$t+=a*We,ar+=a*ke,a=U[15],te+=a*Le,he+=a*Ne,pe+=a*Me,re+=a*je,be+=a*$e,we+=a*Ce,Ee+=a*qe,De+=a*Be,ve+=a*Ke,_t+=a*Ve,wt+=a*Ge,Pt+=a*He,ut+=a*ze,$t+=a*Te,ar+=a*We,Rr+=a*ke,k+=38*he,X+=38*pe,le+=38*re,_e+=38*be,de+=38*we,me+=38*Ee,Fe+=38*De,Ae+=38*ve,ye+=38*_t,ge+=38*wt,fe+=38*Pt,ue+=38*ut,ce+=38*$t,ae+=38*ar,se+=38*Rr,x=1,a=k+x+65535,x=Math.floor(a/65536),k=a-x*65536,a=X+x+65535,x=Math.floor(a/65536),X=a-x*65536,a=le+x+65535,x=Math.floor(a/65536),le=a-x*65536,a=_e+x+65535,x=Math.floor(a/65536),_e=a-x*65536,a=de+x+65535,x=Math.floor(a/65536),de=a-x*65536,a=me+x+65535,x=Math.floor(a/65536),me=a-x*65536,a=Fe+x+65535,x=Math.floor(a/65536),Fe=a-x*65536,a=Ae+x+65535,x=Math.floor(a/65536),Ae=a-x*65536,a=ye+x+65535,x=Math.floor(a/65536),ye=a-x*65536,a=ge+x+65535,x=Math.floor(a/65536),ge=a-x*65536,a=fe+x+65535,x=Math.floor(a/65536),fe=a-x*65536,a=ue+x+65535,x=Math.floor(a/65536),ue=a-x*65536,a=ce+x+65535,x=Math.floor(a/65536),ce=a-x*65536,a=ae+x+65535,x=Math.floor(a/65536),ae=a-x*65536,a=se+x+65535,x=Math.floor(a/65536),se=a-x*65536,a=te+x+65535,x=Math.floor(a/65536),te=a-x*65536,k+=x-1+37*(x-1),x=1,a=k+x+65535,x=Math.floor(a/65536),k=a-x*65536,a=X+x+65535,x=Math.floor(a/65536),X=a-x*65536,a=le+x+65535,x=Math.floor(a/65536),le=a-x*65536,a=_e+x+65535,x=Math.floor(a/65536),_e=a-x*65536,a=de+x+65535,x=Math.floor(a/65536),de=a-x*65536,a=me+x+65535,x=Math.floor(a/65536),me=a-x*65536,a=Fe+x+65535,x=Math.floor(a/65536),Fe=a-x*65536,a=Ae+x+65535,x=Math.floor(a/65536),Ae=a-x*65536,a=ye+x+65535,x=Math.floor(a/65536),ye=a-x*65536,a=ge+x+65535,x=Math.floor(a/65536),ge=a-x*65536,a=fe+x+65535,x=Math.floor(a/65536),fe=a-x*65536,a=ue+x+65535,x=Math.floor(a/65536),ue=a-x*65536,a=ce+x+65535,x=Math.floor(a/65536),ce=a-x*65536,a=ae+x+65535,x=Math.floor(a/65536),ae=a-x*65536,a=se+x+65535,x=Math.floor(a/65536),se=a-x*65536,a=te+x+65535,x=Math.floor(a/65536),te=a-x*65536,k+=x-1+37*(x-1),L[0]=k,L[1]=X,L[2]=le,L[3]=_e,L[4]=de,L[5]=me,L[6]=Fe,L[7]=Ae,L[8]=ye,L[9]=ge,L[10]=fe,L[11]=ue,L[12]=ce,L[13]=ae,L[14]=se,L[15]=te}function l(L,U){s(L,U,U)}function H(L,U){const C=n();let a;for(a=0;a<16;a++)C[a]=U[a];for(a=253;a>=0;a--)l(C,C),a!==2&&a!==4&&s(C,C,U);for(a=0;a<16;a++)L[a]=C[a]}function o(L,U){const C=n();let a;for(a=0;a<16;a++)C[a]=U[a];for(a=250;a>=0;a--)l(C,C),a!==1&&s(C,C,U);for(a=0;a<16;a++)L[a]=C[a]}function f(L,U){const C=n(),a=n(),x=n(),k=n(),X=n(),le=n(),_e=n(),de=n(),me=n();m(C,L[1],L[0]),m(me,U[1],U[0]),s(C,C,me),w(a,L[0],L[1]),w(me,U[0],U[1]),s(a,a,me),s(x,L[3],U[3]),s(x,x,O),s(k,L[2],U[2]),w(k,k,k),m(X,a,C),m(le,k,x),w(_e,k,x),w(de,a,C),s(L[0],X,le),s(L[1],de,_e),s(L[2],_e,le),s(L[3],X,de)}function d(L,U,C){for(let a=0;a<4;a++)q(L[a],U[a],C)}function v(L,U){const C=n(),a=n(),x=n();H(x,U[2]),s(C,U[0],x),s(a,U[1],x),M(L,a),L[31]^=E(C)<<7}function p(L,U,C){N(L[0],y),N(L[1],u),N(L[2],u),N(L[3],y);for(let a=255;a>=0;--a){const x=C[a/8|0]>>(a&7)&1;d(L,U,x),f(U,L),f(L,L),d(L,U,x)}}function h(L,U){const C=[n(),n(),n(),n()];N(C[0],S),N(C[1],A),N(C[2],u),s(C[3],S,A),p(L,C,U)}function T(L){if(L.length!==r.SEED_LENGTH)throw new Error(`ed25519: seed must be ${r.SEED_LENGTH} bytes`);const U=(0,t.hash)(L);U[0]&=248,U[31]&=127,U[31]|=64;const C=new Uint8Array(32),a=[n(),n(),n(),n()];h(a,U),v(C,a);const x=new Uint8Array(64);return x.set(L),x.set(C,32),{publicKey:C,secretKey:x}}r.generateKeyPairFromSeed=T;function F(L){const U=(0,e.randomBytes)(32,L),C=T(U);return(0,i.wipe)(U),C}r.generateKeyPair=F;function $(L){if(L.length!==r.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${r.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(L.subarray(32))}r.extractPublicKeyFromSecretKey=$;const I=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function j(L,U){let C,a,x,k;for(a=63;a>=32;--a){for(C=0,x=a-32,k=a-12;x<k;++x)U[x]+=C-16*U[a]*I[x-(a-32)],C=Math.floor((U[x]+128)/256),U[x]-=C*256;U[x]+=C,U[a]=0}for(C=0,x=0;x<32;x++)U[x]+=C-(U[31]>>4)*I[x],C=U[x]>>8,U[x]&=255;for(x=0;x<32;x++)U[x]-=C*I[x];for(a=0;a<32;a++)U[a+1]+=U[a]>>8,L[a]=U[a]&255}function K(L){const U=new Float64Array(64);for(let C=0;C<64;C++)U[C]=L[C];for(let C=0;C<64;C++)L[C]=0;j(L,U)}function G(L,U){const C=new Float64Array(64),a=[n(),n(),n(),n()],x=(0,t.hash)(L.subarray(0,32));x[0]&=248,x[31]&=127,x[31]|=64;const k=new Uint8Array(64);k.set(x.subarray(32),32);const X=new t.SHA512;X.update(k.subarray(32)),X.update(U);const le=X.digest();X.clean(),K(le),h(a,le),v(k,a),X.reset(),X.update(k.subarray(0,32)),X.update(L.subarray(32)),X.update(U);const _e=X.digest();K(_e);for(let de=0;de<32;de++)C[de]=le[de];for(let de=0;de<32;de++)for(let me=0;me<32;me++)C[de+me]+=_e[de]*x[me];return j(k.subarray(32),C),k}r.sign=G;function V(L,U){const C=n(),a=n(),x=n(),k=n(),X=n(),le=n(),_e=n();return N(L[2],u),b(L[1],U),l(x,L[1]),s(k,x,g),m(x,x,L[2]),w(k,L[2],k),l(X,k),l(le,X),s(_e,le,X),s(C,_e,x),s(C,C,k),o(C,C),s(C,C,x),s(C,C,k),s(C,C,k),s(L[0],C,k),l(a,L[0]),s(a,a,k),_(a,x)&&s(L[0],L[0],z),l(a,L[0]),s(a,a,k),_(a,x)?-1:(E(L[0])===U[31]>>7&&m(L[0],y,L[0]),s(L[3],L[0],L[1]),0)}function Q(L,U,C){const a=new Uint8Array(32),x=[n(),n(),n(),n()],k=[n(),n(),n(),n()];if(C.length!==r.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${r.SIGNATURE_LENGTH} bytes`);if(V(k,L))return!1;const X=new t.SHA512;X.update(C.subarray(0,32)),X.update(L),X.update(U);const le=X.digest();return K(le),p(x,k,le),h(k,C.subarray(32)),f(x,k),v(a,x),!B(C,a)}r.verify=Q;function Y(L){let U=[n(),n(),n(),n()];if(V(U,L))throw new Error("Ed25519: invalid public key");let C=n(),a=n(),x=U[1];w(C,u,x),m(a,u,x),H(a,a),s(C,C,a);let k=new Uint8Array(32);return M(k,C),k}r.convertPublicKeyToX25519=Y;function oe(L){const U=(0,t.hash)(L.subarray(0,32));U[0]&=248,U[31]&=127,U[31]|=64;const C=new Uint8Array(U.subarray(0,32));return(0,i.wipe)(U),C}r.convertSecretKeyToX25519=oe})(Gi);const _u="EdDSA",bu="JWT",ca=".",ua="base64url",wu="utf8",mu="utf8",vu=":",Eu="did",Du="key",Kn="base58btc",Su="z",Ou="K36",Iu=32;function ha(r=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(r):new Uint8Array(r)}function xi(r,e){e||(e=r.reduce((n,c)=>n+c.length,0));const t=ha(e);let i=0;for(const n of r)t.set(n,i),i+=n.length;return t}function xu(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),i=0;i<t.length;i++)t[i]=255;for(var n=0;n<r.length;n++){var c=r.charAt(n),y=c.charCodeAt(0);if(t[y]!==255)throw new TypeError(c+" is ambiguous");t[y]=n}var u=r.length,g=r.charAt(0),O=Math.log(u)/Math.log(256),S=Math.log(256)/Math.log(u);function A(P){if(P instanceof Uint8Array||(ArrayBuffer.isView(P)?P=new Uint8Array(P.buffer,P.byteOffset,P.byteLength):Array.isArray(P)&&(P=Uint8Array.from(P))),!(P instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(P.length===0)return"";for(var q=0,M=0,B=0,_=P.length;B!==_&&P[B]===0;)B++,q++;for(var E=(_-B)*S+1>>>0,b=new Uint8Array(E);B!==_;){for(var w=P[B],m=0,s=E-1;(w!==0||m<M)&&s!==-1;s--,m++)w+=256*b[s]>>>0,b[s]=w%u>>>0,w=w/u>>>0;if(w!==0)throw new Error("Non-zero carry");M=m,B++}for(var l=E-M;l!==E&&b[l]===0;)l++;for(var H=g.repeat(q);l<E;++l)H+=r.charAt(b[l]);return H}function z(P){if(typeof P!="string")throw new TypeError("Expected String");if(P.length===0)return new Uint8Array;var q=0;if(P[q]!==" "){for(var M=0,B=0;P[q]===g;)M++,q++;for(var _=(P.length-q)*O+1>>>0,E=new Uint8Array(_);P[q];){var b=t[P.charCodeAt(q)];if(b===255)return;for(var w=0,m=_-1;(b!==0||w<B)&&m!==-1;m--,w++)b+=u*E[m]>>>0,E[m]=b%256>>>0,b=b/256>>>0;if(b!==0)throw new Error("Non-zero carry");B=w,q++}if(P[q]!==" "){for(var s=_-B;s!==_&&E[s]===0;)s++;for(var l=new Uint8Array(M+(_-s)),H=M;s!==_;)l[H++]=E[s++];return l}}}function N(P){var q=z(P);if(q)return q;throw new Error(`Non-${e} character`)}return{encode:A,decodeUnsafe:z,decode:N}}var Tu=xu,Pu=Tu;const la=r=>{if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")},Au=r=>new TextEncoder().encode(r),Nu=r=>new TextDecoder().decode(r);class Cu{constructor(e,t,i){this.name=e,this.prefix=t,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Ru{constructor(e,t,i){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=i}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return fa(this,e)}}class Fu{constructor(e){this.decoders=e}or(e){return fa(this,e)}decode(e){const t=e[0],i=this.decoders[t];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const fa=(r,e)=>new Fu({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class Uu{constructor(e,t,i,n){this.name=e,this.prefix=t,this.baseEncode=i,this.baseDecode=n,this.encoder=new Cu(e,t,i),this.decoder=new Ru(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const ti=({name:r,prefix:e,encode:t,decode:i})=>new Uu(r,e,t,i),Tr=({prefix:r,name:e,alphabet:t})=>{const{encode:i,decode:n}=Pu(t,e);return ti({prefix:r,name:e,encode:i,decode:c=>la(n(c))})},Lu=(r,e,t,i)=>{const n={};for(let S=0;S<e.length;++S)n[e[S]]=S;let c=r.length;for(;r[c-1]==="=";)--c;const y=new Uint8Array(c*t/8|0);let u=0,g=0,O=0;for(let S=0;S<c;++S){const A=n[r[S]];if(A===void 0)throw new SyntaxError(`Non-${i} character`);g=g<<t|A,u+=t,u>=8&&(u-=8,y[O++]=255&g>>u)}if(u>=t||255&g<<8-u)throw new SyntaxError("Unexpected end of data");return y},Mu=(r,e,t)=>{const i=e[e.length-1]==="=",n=(1<<t)-1;let c="",y=0,u=0;for(let g=0;g<r.length;++g)for(u=u<<8|r[g],y+=8;y>t;)y-=t,c+=e[n&u>>y];if(y&&(c+=e[n&u<<t-y]),i)for(;c.length*t&7;)c+="=";return c},Qe=({name:r,prefix:e,bitsPerChar:t,alphabet:i})=>ti({prefix:e,name:r,encode(n){return Mu(n,i,t)},decode(n){return Lu(n,i,t,r)}}),ju=ti({prefix:"\0",name:"identity",encode:r=>Nu(r),decode:r=>Au(r)}),$u=Object.freeze(Object.defineProperty({__proto__:null,identity:ju},Symbol.toStringTag,{value:"Module"})),zu=Qe({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),Hu=Object.freeze(Object.defineProperty({__proto__:null,base2:zu},Symbol.toStringTag,{value:"Module"})),qu=Qe({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),Bu=Object.freeze(Object.defineProperty({__proto__:null,base8:qu},Symbol.toStringTag,{value:"Module"})),Ku=Tr({prefix:"9",name:"base10",alphabet:"0123456789"}),Vu=Object.freeze(Object.defineProperty({__proto__:null,base10:Ku},Symbol.toStringTag,{value:"Module"})),Gu=Qe({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Wu=Qe({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),ku=Object.freeze(Object.defineProperty({__proto__:null,base16:Gu,base16upper:Wu},Symbol.toStringTag,{value:"Module"})),Yu=Qe({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Ju=Qe({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Xu=Qe({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Zu=Qe({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Qu=Qe({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),eh=Qe({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),th=Qe({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),rh=Qe({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),ih=Qe({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),nh=Object.freeze(Object.defineProperty({__proto__:null,base32:Yu,base32upper:Ju,base32pad:Xu,base32padupper:Zu,base32hex:Qu,base32hexupper:eh,base32hexpad:th,base32hexpadupper:rh,base32z:ih},Symbol.toStringTag,{value:"Module"})),sh=Tr({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),ah=Tr({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),oh=Object.freeze(Object.defineProperty({__proto__:null,base36:sh,base36upper:ah},Symbol.toStringTag,{value:"Module"})),ch=Tr({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),uh=Tr({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),hh=Object.freeze(Object.defineProperty({__proto__:null,base58btc:ch,base58flickr:uh},Symbol.toStringTag,{value:"Module"})),lh=Qe({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),fh=Qe({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),dh=Qe({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),gh=Qe({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),ph=Object.freeze(Object.defineProperty({__proto__:null,base64:lh,base64pad:fh,base64url:dh,base64urlpad:gh},Symbol.toStringTag,{value:"Module"})),da=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),yh=da.reduce((r,e,t)=>(r[t]=e,r),[]),_h=da.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]);function bh(r){return r.reduce((e,t)=>(e+=yh[t],e),"")}function wh(r){const e=[];for(const t of r){const i=_h[t.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(i)}return new Uint8Array(e)}const mh=ti({prefix:"\u{1F680}",name:"base256emoji",encode:bh,decode:wh}),vh=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:mh},Symbol.toStringTag,{value:"Module"}));var Eh=ga,Vn=128,Dh=127,Sh=~Dh,Oh=Math.pow(2,31);function ga(r,e,t){e=e||[],t=t||0;for(var i=t;r>=Oh;)e[t++]=r&255|Vn,r/=128;for(;r&Sh;)e[t++]=r&255|Vn,r>>>=7;return e[t]=r|0,ga.bytes=t-i+1,e}var Ih=Ti,xh=128,Gn=127;function Ti(r,i){var t=0,i=i||0,n=0,c=i,y,u=r.length;do{if(c>=u)throw Ti.bytes=0,new RangeError("Could not decode varint");y=r[c++],t+=n<28?(y&Gn)<<n:(y&Gn)*Math.pow(2,n),n+=7}while(y>=xh);return Ti.bytes=c-i,t}var Th=Math.pow(2,7),Ph=Math.pow(2,14),Ah=Math.pow(2,21),Nh=Math.pow(2,28),Ch=Math.pow(2,35),Rh=Math.pow(2,42),Fh=Math.pow(2,49),Uh=Math.pow(2,56),Lh=Math.pow(2,63),Mh=function(r){return r<Th?1:r<Ph?2:r<Ah?3:r<Nh?4:r<Ch?5:r<Rh?6:r<Fh?7:r<Uh?8:r<Lh?9:10},jh={encode:Eh,decode:Ih,encodingLength:Mh},pa=jh;const Wn=(r,e,t=0)=>(pa.encode(r,e,t),e),kn=r=>pa.encodingLength(r),Pi=(r,e)=>{const t=e.byteLength,i=kn(r),n=i+kn(t),c=new Uint8Array(n+t);return Wn(r,c,0),Wn(t,c,i),c.set(e,n),new $h(r,t,e,c)};class $h{constructor(e,t,i,n){this.code=e,this.size=t,this.digest=i,this.bytes=n}}const ya=({name:r,code:e,encode:t})=>new zh(r,e,t);class zh{constructor(e,t,i){this.name=e,this.code=t,this.encode=i}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Pi(this.code,t):t.then(i=>Pi(this.code,i))}else throw Error("Unknown type, must be binary type")}}const _a=r=>async e=>new Uint8Array(await crypto.subtle.digest(r,e)),Hh=ya({name:"sha2-256",code:18,encode:_a("SHA-256")}),qh=ya({name:"sha2-512",code:19,encode:_a("SHA-512")}),Bh=Object.freeze(Object.defineProperty({__proto__:null,sha256:Hh,sha512:qh},Symbol.toStringTag,{value:"Module"})),ba=0,Kh="identity",wa=la,Vh=r=>Pi(ba,wa(r)),Gh={code:ba,name:Kh,encode:wa,digest:Vh},Wh=Object.freeze(Object.defineProperty({__proto__:null,identity:Gh},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const Yn={...$u,...Hu,...Bu,...Vu,...ku,...nh,...oh,...hh,...ph,...vh};({...Bh,...Wh});function ma(r,e,t,i){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:i}}}const Jn=ma("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>new TextEncoder().encode(r.substring(1))),yi=ma("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{r=r.substring(1);const e=ha(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),va={utf8:Jn,"utf-8":Jn,hex:Yn.base16,latin1:yi,ascii:yi,binary:yi,...Yn};function ct(r,e="utf8"){const t=va[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r.buffer,r.byteOffset,r.byteLength).toString("utf8"):t.encoder.encode(r).substring(1)}function at(r,e="utf8"){const t=va[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r,"utf8"):t.decoder.decode(`${t.prefix}${r}`)}function Wr(r){return ct(at(zi(r),wu),ua)}function Ea(r){const e=at(Ou,Kn),t=Su+ct(xi([e,r]),Kn);return[Eu,Du,t].join(vu)}function kh(r){return ct(r,ua)}function Yh(r){return at([Wr(r.header),Wr(r.payload)].join(ca),mu)}function Jh(r){return[Wr(r.header),Wr(r.payload),kh(r.signature)].join(ca)}function Xn(r=ir.randomBytes(Iu)){return Gi.generateKeyPairFromSeed(r)}async function Xh(r,e,t,i,n=ee.fromMiliseconds(Date.now())){const c={alg:_u,typ:bu},y=Ea(i.publicKey),u=n+t,g={iss:y,sub:r,aud:e,iat:n,exp:u},O=Yh({header:c,payload:g}),S=Gi.sign(i.secretKey,O);return Jh({header:c,payload:g,signature:S})}var Wi={},ri={};Object.defineProperty(ri,"__esModule",{value:!0});var rt=ie,Ai=lt,Zh=20;function Qh(r,e,t){for(var i=1634760805,n=857760878,c=2036477234,y=1797285236,u=t[3]<<24|t[2]<<16|t[1]<<8|t[0],g=t[7]<<24|t[6]<<16|t[5]<<8|t[4],O=t[11]<<24|t[10]<<16|t[9]<<8|t[8],S=t[15]<<24|t[14]<<16|t[13]<<8|t[12],A=t[19]<<24|t[18]<<16|t[17]<<8|t[16],z=t[23]<<24|t[22]<<16|t[21]<<8|t[20],N=t[27]<<24|t[26]<<16|t[25]<<8|t[24],P=t[31]<<24|t[30]<<16|t[29]<<8|t[28],q=e[3]<<24|e[2]<<16|e[1]<<8|e[0],M=e[7]<<24|e[6]<<16|e[5]<<8|e[4],B=e[11]<<24|e[10]<<16|e[9]<<8|e[8],_=e[15]<<24|e[14]<<16|e[13]<<8|e[12],E=i,b=n,w=c,m=y,s=u,l=g,H=O,o=S,f=A,d=z,v=N,p=P,h=q,T=M,F=B,$=_,I=0;I<Zh;I+=2)E=E+s|0,h^=E,h=h>>>32-16|h<<16,f=f+h|0,s^=f,s=s>>>32-12|s<<12,b=b+l|0,T^=b,T=T>>>32-16|T<<16,d=d+T|0,l^=d,l=l>>>32-12|l<<12,w=w+H|0,F^=w,F=F>>>32-16|F<<16,v=v+F|0,H^=v,H=H>>>32-12|H<<12,m=m+o|0,$^=m,$=$>>>32-16|$<<16,p=p+$|0,o^=p,o=o>>>32-12|o<<12,w=w+H|0,F^=w,F=F>>>32-8|F<<8,v=v+F|0,H^=v,H=H>>>32-7|H<<7,m=m+o|0,$^=m,$=$>>>32-8|$<<8,p=p+$|0,o^=p,o=o>>>32-7|o<<7,b=b+l|0,T^=b,T=T>>>32-8|T<<8,d=d+T|0,l^=d,l=l>>>32-7|l<<7,E=E+s|0,h^=E,h=h>>>32-8|h<<8,f=f+h|0,s^=f,s=s>>>32-7|s<<7,E=E+l|0,$^=E,$=$>>>32-16|$<<16,v=v+$|0,l^=v,l=l>>>32-12|l<<12,b=b+H|0,h^=b,h=h>>>32-16|h<<16,p=p+h|0,H^=p,H=H>>>32-12|H<<12,w=w+o|0,T^=w,T=T>>>32-16|T<<16,f=f+T|0,o^=f,o=o>>>32-12|o<<12,m=m+s|0,F^=m,F=F>>>32-16|F<<16,d=d+F|0,s^=d,s=s>>>32-12|s<<12,w=w+o|0,T^=w,T=T>>>32-8|T<<8,f=f+T|0,o^=f,o=o>>>32-7|o<<7,m=m+s|0,F^=m,F=F>>>32-8|F<<8,d=d+F|0,s^=d,s=s>>>32-7|s<<7,b=b+H|0,h^=b,h=h>>>32-8|h<<8,p=p+h|0,H^=p,H=H>>>32-7|H<<7,E=E+l|0,$^=E,$=$>>>32-8|$<<8,v=v+$|0,l^=v,l=l>>>32-7|l<<7;rt.writeUint32LE(E+i|0,r,0),rt.writeUint32LE(b+n|0,r,4),rt.writeUint32LE(w+c|0,r,8),rt.writeUint32LE(m+y|0,r,12),rt.writeUint32LE(s+u|0,r,16),rt.writeUint32LE(l+g|0,r,20),rt.writeUint32LE(H+O|0,r,24),rt.writeUint32LE(o+S|0,r,28),rt.writeUint32LE(f+A|0,r,32),rt.writeUint32LE(d+z|0,r,36),rt.writeUint32LE(v+N|0,r,40),rt.writeUint32LE(p+P|0,r,44),rt.writeUint32LE(h+q|0,r,48),rt.writeUint32LE(T+M|0,r,52),rt.writeUint32LE(F+B|0,r,56),rt.writeUint32LE($+_|0,r,60)}function Da(r,e,t,i,n){if(n===void 0&&(n=0),r.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(i.length<t.length)throw new Error("ChaCha: destination is shorter than source");var c,y;if(n===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");c=new Uint8Array(16),y=c.length-e.length,c.set(e,y)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");c=e,y=n}for(var u=new Uint8Array(64),g=0;g<t.length;g+=64){Qh(u,c,r);for(var O=g;O<g+64&&O<t.length;O++)i[O]=t[O]^u[O-g];tl(c,0,y)}return Ai.wipe(u),n===0&&Ai.wipe(c),i}ri.streamXOR=Da;function el(r,e,t,i){return i===void 0&&(i=0),Ai.wipe(t),Da(r,e,t,t,i)}ri.stream=el;function tl(r,e,t){for(var i=1;t--;)i=i+(r[e]&255)|0,r[e]=i&255,i>>>=8,e++;if(i>0)throw new Error("ChaCha: counter overflow")}var Sa={},jt={};Object.defineProperty(jt,"__esModule",{value:!0});function rl(r,e,t){return~(r-1)&e|r-1&t}jt.select=rl;function il(r,e){return(r|0)-(e|0)-1>>>31&1}jt.lessOrEqual=il;function Oa(r,e){if(r.length!==e.length)return 0;for(var t=0,i=0;i<r.length;i++)t|=r[i]^e[i];return 1&t-1>>>8}jt.compare=Oa;function nl(r,e){return r.length===0||e.length===0?!1:Oa(r,e)!==0}jt.equal=nl;(function(r){Object.defineProperty(r,"__esModule",{value:!0});var e=jt,t=lt;r.DIGEST_LENGTH=16;var i=function(){function y(u){this.digestLength=r.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var g=u[0]|u[1]<<8;this._r[0]=g&8191;var O=u[2]|u[3]<<8;this._r[1]=(g>>>13|O<<3)&8191;var S=u[4]|u[5]<<8;this._r[2]=(O>>>10|S<<6)&7939;var A=u[6]|u[7]<<8;this._r[3]=(S>>>7|A<<9)&8191;var z=u[8]|u[9]<<8;this._r[4]=(A>>>4|z<<12)&255,this._r[5]=z>>>1&8190;var N=u[10]|u[11]<<8;this._r[6]=(z>>>14|N<<2)&8191;var P=u[12]|u[13]<<8;this._r[7]=(N>>>11|P<<5)&8065;var q=u[14]|u[15]<<8;this._r[8]=(P>>>8|q<<8)&8191,this._r[9]=q>>>5&127,this._pad[0]=u[16]|u[17]<<8,this._pad[1]=u[18]|u[19]<<8,this._pad[2]=u[20]|u[21]<<8,this._pad[3]=u[22]|u[23]<<8,this._pad[4]=u[24]|u[25]<<8,this._pad[5]=u[26]|u[27]<<8,this._pad[6]=u[28]|u[29]<<8,this._pad[7]=u[30]|u[31]<<8}return y.prototype._blocks=function(u,g,O){for(var S=this._fin?0:2048,A=this._h[0],z=this._h[1],N=this._h[2],P=this._h[3],q=this._h[4],M=this._h[5],B=this._h[6],_=this._h[7],E=this._h[8],b=this._h[9],w=this._r[0],m=this._r[1],s=this._r[2],l=this._r[3],H=this._r[4],o=this._r[5],f=this._r[6],d=this._r[7],v=this._r[8],p=this._r[9];O>=16;){var h=u[g+0]|u[g+1]<<8;A+=h&8191;var T=u[g+2]|u[g+3]<<8;z+=(h>>>13|T<<3)&8191;var F=u[g+4]|u[g+5]<<8;N+=(T>>>10|F<<6)&8191;var $=u[g+6]|u[g+7]<<8;P+=(F>>>7|$<<9)&8191;var I=u[g+8]|u[g+9]<<8;q+=($>>>4|I<<12)&8191,M+=I>>>1&8191;var j=u[g+10]|u[g+11]<<8;B+=(I>>>14|j<<2)&8191;var K=u[g+12]|u[g+13]<<8;_+=(j>>>11|K<<5)&8191;var G=u[g+14]|u[g+15]<<8;E+=(K>>>8|G<<8)&8191,b+=G>>>5|S;var V=0,Q=V;Q+=A*w,Q+=z*(5*p),Q+=N*(5*v),Q+=P*(5*d),Q+=q*(5*f),V=Q>>>13,Q&=8191,Q+=M*(5*o),Q+=B*(5*H),Q+=_*(5*l),Q+=E*(5*s),Q+=b*(5*m),V+=Q>>>13,Q&=8191;var Y=V;Y+=A*m,Y+=z*w,Y+=N*(5*p),Y+=P*(5*v),Y+=q*(5*d),V=Y>>>13,Y&=8191,Y+=M*(5*f),Y+=B*(5*o),Y+=_*(5*H),Y+=E*(5*l),Y+=b*(5*s),V+=Y>>>13,Y&=8191;var oe=V;oe+=A*s,oe+=z*m,oe+=N*w,oe+=P*(5*p),oe+=q*(5*v),V=oe>>>13,oe&=8191,oe+=M*(5*d),oe+=B*(5*f),oe+=_*(5*o),oe+=E*(5*H),oe+=b*(5*l),V+=oe>>>13,oe&=8191;var L=V;L+=A*l,L+=z*s,L+=N*m,L+=P*w,L+=q*(5*p),V=L>>>13,L&=8191,L+=M*(5*v),L+=B*(5*d),L+=_*(5*f),L+=E*(5*o),L+=b*(5*H),V+=L>>>13,L&=8191;var U=V;U+=A*H,U+=z*l,U+=N*s,U+=P*m,U+=q*w,V=U>>>13,U&=8191,U+=M*(5*p),U+=B*(5*v),U+=_*(5*d),U+=E*(5*f),U+=b*(5*o),V+=U>>>13,U&=8191;var C=V;C+=A*o,C+=z*H,C+=N*l,C+=P*s,C+=q*m,V=C>>>13,C&=8191,C+=M*w,C+=B*(5*p),C+=_*(5*v),C+=E*(5*d),C+=b*(5*f),V+=C>>>13,C&=8191;var a=V;a+=A*f,a+=z*o,a+=N*H,a+=P*l,a+=q*s,V=a>>>13,a&=8191,a+=M*m,a+=B*w,a+=_*(5*p),a+=E*(5*v),a+=b*(5*d),V+=a>>>13,a&=8191;var x=V;x+=A*d,x+=z*f,x+=N*o,x+=P*H,x+=q*l,V=x>>>13,x&=8191,x+=M*s,x+=B*m,x+=_*w,x+=E*(5*p),x+=b*(5*v),V+=x>>>13,x&=8191;var k=V;k+=A*v,k+=z*d,k+=N*f,k+=P*o,k+=q*H,V=k>>>13,k&=8191,k+=M*l,k+=B*s,k+=_*m,k+=E*w,k+=b*(5*p),V+=k>>>13,k&=8191;var X=V;X+=A*p,X+=z*v,X+=N*d,X+=P*f,X+=q*o,V=X>>>13,X&=8191,X+=M*H,X+=B*l,X+=_*s,X+=E*m,X+=b*w,V+=X>>>13,X&=8191,V=(V<<2)+V|0,V=V+Q|0,Q=V&8191,V=V>>>13,Y+=V,A=Q,z=Y,N=oe,P=L,q=U,M=C,B=a,_=x,E=k,b=X,g+=16,O-=16}this._h[0]=A,this._h[1]=z,this._h[2]=N,this._h[3]=P,this._h[4]=q,this._h[5]=M,this._h[6]=B,this._h[7]=_,this._h[8]=E,this._h[9]=b},y.prototype.finish=function(u,g){g===void 0&&(g=0);var O=new Uint16Array(10),S,A,z,N;if(this._leftover){for(N=this._leftover,this._buffer[N++]=1;N<16;N++)this._buffer[N]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(S=this._h[1]>>>13,this._h[1]&=8191,N=2;N<10;N++)this._h[N]+=S,S=this._h[N]>>>13,this._h[N]&=8191;for(this._h[0]+=S*5,S=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=S,S=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=S,O[0]=this._h[0]+5,S=O[0]>>>13,O[0]&=8191,N=1;N<10;N++)O[N]=this._h[N]+S,S=O[N]>>>13,O[N]&=8191;for(O[9]-=1<<13,A=(S^1)-1,N=0;N<10;N++)O[N]&=A;for(A=~A,N=0;N<10;N++)this._h[N]=this._h[N]&A|O[N];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,z=this._h[0]+this._pad[0],this._h[0]=z&65535,N=1;N<8;N++)z=(this._h[N]+this._pad[N]|0)+(z>>>16)|0,this._h[N]=z&65535;return u[g+0]=this._h[0]>>>0,u[g+1]=this._h[0]>>>8,u[g+2]=this._h[1]>>>0,u[g+3]=this._h[1]>>>8,u[g+4]=this._h[2]>>>0,u[g+5]=this._h[2]>>>8,u[g+6]=this._h[3]>>>0,u[g+7]=this._h[3]>>>8,u[g+8]=this._h[4]>>>0,u[g+9]=this._h[4]>>>8,u[g+10]=this._h[5]>>>0,u[g+11]=this._h[5]>>>8,u[g+12]=this._h[6]>>>0,u[g+13]=this._h[6]>>>8,u[g+14]=this._h[7]>>>0,u[g+15]=this._h[7]>>>8,this._finished=!0,this},y.prototype.update=function(u){var g=0,O=u.length,S;if(this._leftover){S=16-this._leftover,S>O&&(S=O);for(var A=0;A<S;A++)this._buffer[this._leftover+A]=u[g+A];if(O-=S,g+=S,this._leftover+=S,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(O>=16&&(S=O-O%16,this._blocks(u,g,S),g+=S,O-=S),O){for(var A=0;A<O;A++)this._buffer[this._leftover+A]=u[g+A];this._leftover+=O}return this},y.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var u=new Uint8Array(16);return this.finish(u),u},y.prototype.clean=function(){return t.wipe(this._buffer),t.wipe(this._r),t.wipe(this._h),t.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},y}();r.Poly1305=i;function n(y,u){var g=new i(y);g.update(u);var O=g.digest();return g.clean(),O}r.oneTimeAuth=n;function c(y,u){return y.length!==r.DIGEST_LENGTH||u.length!==r.DIGEST_LENGTH?!1:e.equal(y,u)}r.equal=c})(Sa);(function(r){Object.defineProperty(r,"__esModule",{value:!0});var e=ri,t=Sa,i=lt,n=ie,c=jt;r.KEY_LENGTH=32,r.NONCE_LENGTH=12,r.TAG_LENGTH=16;var y=new Uint8Array(16),u=function(){function g(O){if(this.nonceLength=r.NONCE_LENGTH,this.tagLength=r.TAG_LENGTH,O.length!==r.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(O)}return g.prototype.seal=function(O,S,A,z){if(O.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var N=new Uint8Array(16);N.set(O,N.length-O.length);var P=new Uint8Array(32);e.stream(this._key,N,P,4);var q=S.length+this.tagLength,M;if(z){if(z.length!==q)throw new Error("ChaCha20Poly1305: incorrect destination length");M=z}else M=new Uint8Array(q);return e.streamXOR(this._key,N,S,M,4),this._authenticate(M.subarray(M.length-this.tagLength,M.length),P,M.subarray(0,M.length-this.tagLength),A),i.wipe(N),M},g.prototype.open=function(O,S,A,z){if(O.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(S.length<this.tagLength)return null;var N=new Uint8Array(16);N.set(O,N.length-O.length);var P=new Uint8Array(32);e.stream(this._key,N,P,4);var q=new Uint8Array(this.tagLength);if(this._authenticate(q,P,S.subarray(0,S.length-this.tagLength),A),!c.equal(q,S.subarray(S.length-this.tagLength,S.length)))return null;var M=S.length-this.tagLength,B;if(z){if(z.length!==M)throw new Error("ChaCha20Poly1305: incorrect destination length");B=z}else B=new Uint8Array(M);return e.streamXOR(this._key,N,S.subarray(0,S.length-this.tagLength),B,4),i.wipe(N),B},g.prototype.clean=function(){return i.wipe(this._key),this},g.prototype._authenticate=function(O,S,A,z){var N=new t.Poly1305(S);z&&(N.update(z),z.length%16>0&&N.update(y.subarray(z.length%16))),N.update(A),A.length%16>0&&N.update(y.subarray(A.length%16));var P=new Uint8Array(8);z&&n.writeUint64LE(z.length,P),N.update(P),n.writeUint64LE(A.length,P),N.update(P);for(var q=N.digest(),M=0;M<q.length;M++)O[M]=q[M];N.clean(),i.wipe(q),i.wipe(P)},g}();r.ChaCha20Poly1305=u})(Wi);var Ia={},Pr={},ki={};Object.defineProperty(ki,"__esModule",{value:!0});function sl(r){return typeof r.saveState<"u"&&typeof r.restoreState<"u"&&typeof r.cleanSavedState<"u"}ki.isSerializableHash=sl;Object.defineProperty(Pr,"__esModule",{value:!0});var mt=ki,al=jt,ol=lt,xa=function(){function r(e,t){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var i=new Uint8Array(this.blockSize);t.length>this.blockSize?this._inner.update(t).finish(i).clean():i.set(t);for(var n=0;n<i.length;n++)i[n]^=54;this._inner.update(i);for(var n=0;n<i.length;n++)i[n]^=106;this._outer.update(i),mt.isSerializableHash(this._inner)&&mt.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),ol.wipe(i)}return r.prototype.reset=function(){if(!mt.isSerializableHash(this._inner)||!mt.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},r.prototype.clean=function(){mt.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),mt.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},r.prototype.update=function(e){return this._inner.update(e),this},r.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},r.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},r.prototype.saveState=function(){if(!mt.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},r.prototype.restoreState=function(e){if(!mt.isSerializableHash(this._inner)||!mt.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},r.prototype.cleanSavedState=function(e){if(!mt.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},r}();Pr.HMAC=xa;function cl(r,e,t){var i=new xa(r,e);i.update(t);var n=i.digest();return i.clean(),n}Pr.hmac=cl;Pr.equal=al.equal;Object.defineProperty(Ia,"__esModule",{value:!0});var Zn=Pr,Qn=lt,ul=function(){function r(e,t,i,n){i===void 0&&(i=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=n;var c=Zn.hmac(this._hash,i,t);this._hmac=new Zn.HMAC(e,c),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return r.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(e===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},r.prototype.expand=function(e){for(var t=new Uint8Array(e),i=0;i<t.length;i++)this._bufpos===this._buffer.length&&this._fillBuffer(),t[i]=this._buffer[this._bufpos++];return t},r.prototype.clean=function(){this._hmac.clean(),Qn.wipe(this._buffer),Qn.wipe(this._counter),this._bufpos=0},r}(),hl=Ia.HKDF=ul,ii={};(function(r){Object.defineProperty(r,"__esModule",{value:!0});var e=ie,t=lt;r.DIGEST_LENGTH=32,r.BLOCK_SIZE=64;var i=function(){function u(){this.digestLength=r.DIGEST_LENGTH,this.blockSize=r.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return u.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},u.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},u.prototype.clean=function(){t.wipe(this._buffer),t.wipe(this._temp),this.reset()},u.prototype.update=function(g,O){if(O===void 0&&(O=g.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var S=0;if(this._bytesHashed+=O,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&O>0;)this._buffer[this._bufferLength++]=g[S++],O--;this._bufferLength===this.blockSize&&(c(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(O>=this.blockSize&&(S=c(this._temp,this._state,g,S,O),O%=this.blockSize);O>0;)this._buffer[this._bufferLength++]=g[S++],O--;return this},u.prototype.finish=function(g){if(!this._finished){var O=this._bytesHashed,S=this._bufferLength,A=O/536870912|0,z=O<<3,N=O%64<56?64:128;this._buffer[S]=128;for(var P=S+1;P<N-8;P++)this._buffer[P]=0;e.writeUint32BE(A,this._buffer,N-8),e.writeUint32BE(z,this._buffer,N-4),c(this._temp,this._state,this._buffer,0,N),this._finished=!0}for(var P=0;P<this.digestLength/4;P++)e.writeUint32BE(this._state[P],g,P*4);return this},u.prototype.digest=function(){var g=new Uint8Array(this.digestLength);return this.finish(g),g},u.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},u.prototype.restoreState=function(g){return this._state.set(g.state),this._bufferLength=g.bufferLength,g.buffer&&this._buffer.set(g.buffer),this._bytesHashed=g.bytesHashed,this._finished=!1,this},u.prototype.cleanSavedState=function(g){t.wipe(g.state),g.buffer&&t.wipe(g.buffer),g.bufferLength=0,g.bytesHashed=0},u}();r.SHA256=i;var n=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function c(u,g,O,S,A){for(;A>=64;){for(var z=g[0],N=g[1],P=g[2],q=g[3],M=g[4],B=g[5],_=g[6],E=g[7],b=0;b<16;b++){var w=S+b*4;u[b]=e.readUint32BE(O,w)}for(var b=16;b<64;b++){var m=u[b-2],s=(m>>>17|m<<32-17)^(m>>>19|m<<32-19)^m>>>10;m=u[b-15];var l=(m>>>7|m<<32-7)^(m>>>18|m<<32-18)^m>>>3;u[b]=(s+u[b-7]|0)+(l+u[b-16]|0)}for(var b=0;b<64;b++){var s=(((M>>>6|M<<26)^(M>>>11|M<<21)^(M>>>25|M<<7))+(M&B^~M&_)|0)+(E+(n[b]+u[b]|0)|0)|0,l=((z>>>2|z<<32-2)^(z>>>13|z<<32-13)^(z>>>22|z<<32-22))+(z&N^z&P^N&P)|0;E=_,_=B,B=M,M=q+s|0,q=P,P=N,N=z,z=s+l|0}g[0]+=z,g[1]+=N,g[2]+=P,g[3]+=q,g[4]+=M,g[5]+=B,g[6]+=_,g[7]+=E,S+=64,A-=64}return S}function y(u){var g=new i;g.update(u);var O=g.digest();return g.clean(),O}r.hash=y})(ii);var Yi={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.sharedKey=r.generateKeyPair=r.generateKeyPairFromSeed=r.scalarMultBase=r.scalarMult=r.SHARED_KEY_LENGTH=r.SECRET_KEY_LENGTH=r.PUBLIC_KEY_LENGTH=void 0;const e=ir,t=lt;r.PUBLIC_KEY_LENGTH=32,r.SECRET_KEY_LENGTH=32,r.SHARED_KEY_LENGTH=32;function i(b){const w=new Float64Array(16);if(b)for(let m=0;m<b.length;m++)w[m]=b[m];return w}const n=new Uint8Array(32);n[0]=9;const c=i([56129,1]);function y(b){let w=1;for(let m=0;m<16;m++){let s=b[m]+w+65535;w=Math.floor(s/65536),b[m]=s-w*65536}b[0]+=w-1+37*(w-1)}function u(b,w,m){const s=~(m-1);for(let l=0;l<16;l++){const H=s&(b[l]^w[l]);b[l]^=H,w[l]^=H}}function g(b,w){const m=i(),s=i();for(let l=0;l<16;l++)s[l]=w[l];y(s),y(s),y(s);for(let l=0;l<2;l++){m[0]=s[0]-65517;for(let o=1;o<15;o++)m[o]=s[o]-65535-(m[o-1]>>16&1),m[o-1]&=65535;m[15]=s[15]-32767-(m[14]>>16&1);const H=m[15]>>16&1;m[14]&=65535,u(s,m,1-H)}for(let l=0;l<16;l++)b[2*l]=s[l]&255,b[2*l+1]=s[l]>>8}function O(b,w){for(let m=0;m<16;m++)b[m]=w[2*m]+(w[2*m+1]<<8);b[15]&=32767}function S(b,w,m){for(let s=0;s<16;s++)b[s]=w[s]+m[s]}function A(b,w,m){for(let s=0;s<16;s++)b[s]=w[s]-m[s]}function z(b,w,m){let s,l,H=0,o=0,f=0,d=0,v=0,p=0,h=0,T=0,F=0,$=0,I=0,j=0,K=0,G=0,V=0,Q=0,Y=0,oe=0,L=0,U=0,C=0,a=0,x=0,k=0,X=0,le=0,_e=0,de=0,me=0,Fe=0,Ae=0,ye=m[0],ge=m[1],fe=m[2],ue=m[3],ce=m[4],ae=m[5],se=m[6],te=m[7],he=m[8],pe=m[9],re=m[10],be=m[11],we=m[12],Ee=m[13],De=m[14],ve=m[15];s=w[0],H+=s*ye,o+=s*ge,f+=s*fe,d+=s*ue,v+=s*ce,p+=s*ae,h+=s*se,T+=s*te,F+=s*he,$+=s*pe,I+=s*re,j+=s*be,K+=s*we,G+=s*Ee,V+=s*De,Q+=s*ve,s=w[1],o+=s*ye,f+=s*ge,d+=s*fe,v+=s*ue,p+=s*ce,h+=s*ae,T+=s*se,F+=s*te,$+=s*he,I+=s*pe,j+=s*re,K+=s*be,G+=s*we,V+=s*Ee,Q+=s*De,Y+=s*ve,s=w[2],f+=s*ye,d+=s*ge,v+=s*fe,p+=s*ue,h+=s*ce,T+=s*ae,F+=s*se,$+=s*te,I+=s*he,j+=s*pe,K+=s*re,G+=s*be,V+=s*we,Q+=s*Ee,Y+=s*De,oe+=s*ve,s=w[3],d+=s*ye,v+=s*ge,p+=s*fe,h+=s*ue,T+=s*ce,F+=s*ae,$+=s*se,I+=s*te,j+=s*he,K+=s*pe,G+=s*re,V+=s*be,Q+=s*we,Y+=s*Ee,oe+=s*De,L+=s*ve,s=w[4],v+=s*ye,p+=s*ge,h+=s*fe,T+=s*ue,F+=s*ce,$+=s*ae,I+=s*se,j+=s*te,K+=s*he,G+=s*pe,V+=s*re,Q+=s*be,Y+=s*we,oe+=s*Ee,L+=s*De,U+=s*ve,s=w[5],p+=s*ye,h+=s*ge,T+=s*fe,F+=s*ue,$+=s*ce,I+=s*ae,j+=s*se,K+=s*te,G+=s*he,V+=s*pe,Q+=s*re,Y+=s*be,oe+=s*we,L+=s*Ee,U+=s*De,C+=s*ve,s=w[6],h+=s*ye,T+=s*ge,F+=s*fe,$+=s*ue,I+=s*ce,j+=s*ae,K+=s*se,G+=s*te,V+=s*he,Q+=s*pe,Y+=s*re,oe+=s*be,L+=s*we,U+=s*Ee,C+=s*De,a+=s*ve,s=w[7],T+=s*ye,F+=s*ge,$+=s*fe,I+=s*ue,j+=s*ce,K+=s*ae,G+=s*se,V+=s*te,Q+=s*he,Y+=s*pe,oe+=s*re,L+=s*be,U+=s*we,C+=s*Ee,a+=s*De,x+=s*ve,s=w[8],F+=s*ye,$+=s*ge,I+=s*fe,j+=s*ue,K+=s*ce,G+=s*ae,V+=s*se,Q+=s*te,Y+=s*he,oe+=s*pe,L+=s*re,U+=s*be,C+=s*we,a+=s*Ee,x+=s*De,k+=s*ve,s=w[9],$+=s*ye,I+=s*ge,j+=s*fe,K+=s*ue,G+=s*ce,V+=s*ae,Q+=s*se,Y+=s*te,oe+=s*he,L+=s*pe,U+=s*re,C+=s*be,a+=s*we,x+=s*Ee,k+=s*De,X+=s*ve,s=w[10],I+=s*ye,j+=s*ge,K+=s*fe,G+=s*ue,V+=s*ce,Q+=s*ae,Y+=s*se,oe+=s*te,L+=s*he,U+=s*pe,C+=s*re,a+=s*be,x+=s*we,k+=s*Ee,X+=s*De,le+=s*ve,s=w[11],j+=s*ye,K+=s*ge,G+=s*fe,V+=s*ue,Q+=s*ce,Y+=s*ae,oe+=s*se,L+=s*te,U+=s*he,C+=s*pe,a+=s*re,x+=s*be,k+=s*we,X+=s*Ee,le+=s*De,_e+=s*ve,s=w[12],K+=s*ye,G+=s*ge,V+=s*fe,Q+=s*ue,Y+=s*ce,oe+=s*ae,L+=s*se,U+=s*te,C+=s*he,a+=s*pe,x+=s*re,k+=s*be,X+=s*we,le+=s*Ee,_e+=s*De,de+=s*ve,s=w[13],G+=s*ye,V+=s*ge,Q+=s*fe,Y+=s*ue,oe+=s*ce,L+=s*ae,U+=s*se,C+=s*te,a+=s*he,x+=s*pe,k+=s*re,X+=s*be,le+=s*we,_e+=s*Ee,de+=s*De,me+=s*ve,s=w[14],V+=s*ye,Q+=s*ge,Y+=s*fe,oe+=s*ue,L+=s*ce,U+=s*ae,C+=s*se,a+=s*te,x+=s*he,k+=s*pe,X+=s*re,le+=s*be,_e+=s*we,de+=s*Ee,me+=s*De,Fe+=s*ve,s=w[15],Q+=s*ye,Y+=s*ge,oe+=s*fe,L+=s*ue,U+=s*ce,C+=s*ae,a+=s*se,x+=s*te,k+=s*he,X+=s*pe,le+=s*re,_e+=s*be,de+=s*we,me+=s*Ee,Fe+=s*De,Ae+=s*ve,H+=38*Y,o+=38*oe,f+=38*L,d+=38*U,v+=38*C,p+=38*a,h+=38*x,T+=38*k,F+=38*X,$+=38*le,I+=38*_e,j+=38*de,K+=38*me,G+=38*Fe,V+=38*Ae,l=1,s=H+l+65535,l=Math.floor(s/65536),H=s-l*65536,s=o+l+65535,l=Math.floor(s/65536),o=s-l*65536,s=f+l+65535,l=Math.floor(s/65536),f=s-l*65536,s=d+l+65535,l=Math.floor(s/65536),d=s-l*65536,s=v+l+65535,l=Math.floor(s/65536),v=s-l*65536,s=p+l+65535,l=Math.floor(s/65536),p=s-l*65536,s=h+l+65535,l=Math.floor(s/65536),h=s-l*65536,s=T+l+65535,l=Math.floor(s/65536),T=s-l*65536,s=F+l+65535,l=Math.floor(s/65536),F=s-l*65536,s=$+l+65535,l=Math.floor(s/65536),$=s-l*65536,s=I+l+65535,l=Math.floor(s/65536),I=s-l*65536,s=j+l+65535,l=Math.floor(s/65536),j=s-l*65536,s=K+l+65535,l=Math.floor(s/65536),K=s-l*65536,s=G+l+65535,l=Math.floor(s/65536),G=s-l*65536,s=V+l+65535,l=Math.floor(s/65536),V=s-l*65536,s=Q+l+65535,l=Math.floor(s/65536),Q=s-l*65536,H+=l-1+37*(l-1),l=1,s=H+l+65535,l=Math.floor(s/65536),H=s-l*65536,s=o+l+65535,l=Math.floor(s/65536),o=s-l*65536,s=f+l+65535,l=Math.floor(s/65536),f=s-l*65536,s=d+l+65535,l=Math.floor(s/65536),d=s-l*65536,s=v+l+65535,l=Math.floor(s/65536),v=s-l*65536,s=p+l+65535,l=Math.floor(s/65536),p=s-l*65536,s=h+l+65535,l=Math.floor(s/65536),h=s-l*65536,s=T+l+65535,l=Math.floor(s/65536),T=s-l*65536,s=F+l+65535,l=Math.floor(s/65536),F=s-l*65536,s=$+l+65535,l=Math.floor(s/65536),$=s-l*65536,s=I+l+65535,l=Math.floor(s/65536),I=s-l*65536,s=j+l+65535,l=Math.floor(s/65536),j=s-l*65536,s=K+l+65535,l=Math.floor(s/65536),K=s-l*65536,s=G+l+65535,l=Math.floor(s/65536),G=s-l*65536,s=V+l+65535,l=Math.floor(s/65536),V=s-l*65536,s=Q+l+65535,l=Math.floor(s/65536),Q=s-l*65536,H+=l-1+37*(l-1),b[0]=H,b[1]=o,b[2]=f,b[3]=d,b[4]=v,b[5]=p,b[6]=h,b[7]=T,b[8]=F,b[9]=$,b[10]=I,b[11]=j,b[12]=K,b[13]=G,b[14]=V,b[15]=Q}function N(b,w){z(b,w,w)}function P(b,w){const m=i();for(let s=0;s<16;s++)m[s]=w[s];for(let s=253;s>=0;s--)N(m,m),s!==2&&s!==4&&z(m,m,w);for(let s=0;s<16;s++)b[s]=m[s]}function q(b,w){const m=new Uint8Array(32),s=new Float64Array(80),l=i(),H=i(),o=i(),f=i(),d=i(),v=i();for(let F=0;F<31;F++)m[F]=b[F];m[31]=b[31]&127|64,m[0]&=248,O(s,w);for(let F=0;F<16;F++)H[F]=s[F];l[0]=f[0]=1;for(let F=254;F>=0;--F){const $=m[F>>>3]>>>(F&7)&1;u(l,H,$),u(o,f,$),S(d,l,o),A(l,l,o),S(o,H,f),A(H,H,f),N(f,d),N(v,l),z(l,o,l),z(o,H,d),S(d,l,o),A(l,l,o),N(H,l),A(o,f,v),z(l,o,c),S(l,l,f),z(o,o,l),z(l,f,v),z(f,H,s),N(H,d),u(l,H,$),u(o,f,$)}for(let F=0;F<16;F++)s[F+16]=l[F],s[F+32]=o[F],s[F+48]=H[F],s[F+64]=f[F];const p=s.subarray(32),h=s.subarray(16);P(p,p),z(h,h,p);const T=new Uint8Array(32);return g(T,h),T}r.scalarMult=q;function M(b){return q(b,n)}r.scalarMultBase=M;function B(b){if(b.length!==r.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${r.SECRET_KEY_LENGTH} bytes`);const w=new Uint8Array(b);return{publicKey:M(w),secretKey:w}}r.generateKeyPairFromSeed=B;function _(b){const w=(0,e.randomBytes)(32,b),m=B(w);return(0,t.wipe)(w),m}r.generateKeyPair=_;function E(b,w,m=!1){if(b.length!==r.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(w.length!==r.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const s=q(b,w);if(m){let l=0;for(let H=0;H<s.length;H++)l|=s[H];if(l===0)throw new Error("X25519: invalid shared key")}return s}r.sharedKey=E})(Yi);var es=globalThis&&globalThis.__spreadArray||function(r,e,t){if(t||arguments.length===2)for(var i=0,n=e.length,c;i<n;i++)(c||!(i in e))&&(c||(c=Array.prototype.slice.call(e,0,i)),c[i]=e[i]);return r.concat(c||Array.prototype.slice.call(e))},ll=function(){function r(e,t,i){this.name=e,this.version=t,this.os=i,this.type="browser"}return r}(),fl=function(){function r(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return r}(),dl=function(){function r(e,t,i,n){this.name=e,this.version=t,this.os=i,this.bot=n,this.type="bot-device"}return r}(),gl=function(){function r(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return r}(),pl=function(){function r(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return r}(),yl=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,_l=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,ts=3,bl=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",yl]],rs=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function wl(r){return r?is(r):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new pl:typeof navigator<"u"?is(navigator.userAgent):El()}function ml(r){return r!==""&&bl.reduce(function(e,t){var i=t[0],n=t[1];if(e)return e;var c=n.exec(r);return!!c&&[i,c]},!1)}function is(r){var e=ml(r);if(!e)return null;var t=e[0],i=e[1];if(t==="searchbot")return new gl;var n=i[1]&&i[1].split(".").join("_").split("_").slice(0,3);n?n.length<ts&&(n=es(es([],n,!0),Dl(ts-n.length),!0)):n=[];var c=n.join("."),y=vl(r),u=_l.exec(r);return u&&u[1]?new dl(t,c,y,u[1]):new ll(t,c,y)}function vl(r){for(var e=0,t=rs.length;e<t;e++){var i=rs[e],n=i[0],c=i[1],y=c.exec(r);if(y)return n}return null}function El(){var r=typeof process<"u"&&process.version;return r?new fl(process.version.slice(1)):null}function Dl(r){for(var e=[],t=0;t<r;t++)e.push("0");return e}var Oe={};Object.defineProperty(Oe,"__esModule",{value:!0});Oe.getLocalStorage=Oe.getLocalStorageOrThrow=Oe.getCrypto=Oe.getCryptoOrThrow=Pa=Oe.getLocation=Oe.getLocationOrThrow=Ji=Oe.getNavigator=Oe.getNavigatorOrThrow=Ta=Oe.getDocument=Oe.getDocumentOrThrow=Oe.getFromWindowOrThrow=Oe.getFromWindow=void 0;function Yt(r){let e;return typeof window<"u"&&typeof window[r]<"u"&&(e=window[r]),e}Oe.getFromWindow=Yt;function nr(r){const e=Yt(r);if(!e)throw new Error(`${r} is not defined in Window`);return e}Oe.getFromWindowOrThrow=nr;function Sl(){return nr("document")}Oe.getDocumentOrThrow=Sl;function Ol(){return Yt("document")}var Ta=Oe.getDocument=Ol;function Il(){return nr("navigator")}Oe.getNavigatorOrThrow=Il;function xl(){return Yt("navigator")}var Ji=Oe.getNavigator=xl;function Tl(){return nr("location")}Oe.getLocationOrThrow=Tl;function Pl(){return Yt("location")}var Pa=Oe.getLocation=Pl;function Al(){return nr("crypto")}Oe.getCryptoOrThrow=Al;function Nl(){return Yt("crypto")}Oe.getCrypto=Nl;function Cl(){return nr("localStorage")}Oe.getLocalStorageOrThrow=Cl;function Rl(){return Yt("localStorage")}Oe.getLocalStorage=Rl;var Xi={};Object.defineProperty(Xi,"__esModule",{value:!0});var Aa=Xi.getWindowMetadata=void 0;const ns=Oe;function Fl(){let r,e;try{r=ns.getDocumentOrThrow(),e=ns.getLocationOrThrow()}catch{return null}function t(){const A=r.getElementsByTagName("link"),z=[];for(let N=0;N<A.length;N++){const P=A[N],q=P.getAttribute("rel");if(q&&q.toLowerCase().indexOf("icon")>-1){const M=P.getAttribute("href");if(M)if(M.toLowerCase().indexOf("https:")===-1&&M.toLowerCase().indexOf("http:")===-1&&M.indexOf("//")!==0){let B=e.protocol+"//"+e.host;if(M.indexOf("/")===0)B+=M;else{const _=e.pathname.split("/");_.pop();const E=_.join("/");B+=E+"/"+M}z.push(B)}else if(M.indexOf("//")===0){const B=e.protocol+M;z.push(B)}else z.push(M)}}return z}function i(...A){const z=r.getElementsByTagName("meta");for(let N=0;N<z.length;N++){const P=z[N],q=["itemprop","property","name"].map(M=>P.getAttribute(M)).filter(M=>M?A.includes(M):!1);if(q.length&&q){const M=P.getAttribute("content");if(M)return M}}return""}function n(){let A=i("name","og:site_name","og:title","twitter:title");return A||(A=r.title),A}function c(){return i("description","og:description","twitter:description","keywords")}const y=n(),u=c(),g=e.origin,O=t();return{description:u,url:g,icons:O,name:y}}Aa=Xi.getWindowMetadata=Fl;var vr={},Na=function(r,e){for(var t={},i=Object.keys(r),n=Array.isArray(e),c=0;c<i.length;c++){var y=i[c],u=r[y];(n?e.indexOf(y)!==-1:e(y,u,r))&&(t[y]=u)}return t};(function(r){const e=Bs,t=Ks,i=qs,n=Na,c=_=>_==null,y=Symbol("encodeFragmentIdentifier");function u(_){switch(_.arrayFormat){case"index":return E=>(b,w)=>{const m=b.length;return w===void 0||_.skipNull&&w===null||_.skipEmptyString&&w===""?b:w===null?[...b,[S(E,_),"[",m,"]"].join("")]:[...b,[S(E,_),"[",S(m,_),"]=",S(w,_)].join("")]};case"bracket":return E=>(b,w)=>w===void 0||_.skipNull&&w===null||_.skipEmptyString&&w===""?b:w===null?[...b,[S(E,_),"[]"].join("")]:[...b,[S(E,_),"[]=",S(w,_)].join("")];case"colon-list-separator":return E=>(b,w)=>w===void 0||_.skipNull&&w===null||_.skipEmptyString&&w===""?b:w===null?[...b,[S(E,_),":list="].join("")]:[...b,[S(E,_),":list=",S(w,_)].join("")];case"comma":case"separator":case"bracket-separator":{const E=_.arrayFormat==="bracket-separator"?"[]=":"=";return b=>(w,m)=>m===void 0||_.skipNull&&m===null||_.skipEmptyString&&m===""?w:(m=m===null?"":m,w.length===0?[[S(b,_),E,S(m,_)].join("")]:[[w,S(m,_)].join(_.arrayFormatSeparator)])}default:return E=>(b,w)=>w===void 0||_.skipNull&&w===null||_.skipEmptyString&&w===""?b:w===null?[...b,S(E,_)]:[...b,[S(E,_),"=",S(w,_)].join("")]}}function g(_){let E;switch(_.arrayFormat){case"index":return(b,w,m)=>{if(E=/\[(\d*)\]$/.exec(b),b=b.replace(/\[\d*\]$/,""),!E){m[b]=w;return}m[b]===void 0&&(m[b]={}),m[b][E[1]]=w};case"bracket":return(b,w,m)=>{if(E=/(\[\])$/.exec(b),b=b.replace(/\[\]$/,""),!E){m[b]=w;return}if(m[b]===void 0){m[b]=[w];return}m[b]=[].concat(m[b],w)};case"colon-list-separator":return(b,w,m)=>{if(E=/(:list)$/.exec(b),b=b.replace(/:list$/,""),!E){m[b]=w;return}if(m[b]===void 0){m[b]=[w];return}m[b]=[].concat(m[b],w)};case"comma":case"separator":return(b,w,m)=>{const s=typeof w=="string"&&w.includes(_.arrayFormatSeparator),l=typeof w=="string"&&!s&&A(w,_).includes(_.arrayFormatSeparator);w=l?A(w,_):w;const H=s||l?w.split(_.arrayFormatSeparator).map(o=>A(o,_)):w===null?w:A(w,_);m[b]=H};case"bracket-separator":return(b,w,m)=>{const s=/(\[\])$/.test(b);if(b=b.replace(/\[\]$/,""),!s){m[b]=w&&A(w,_);return}const l=w===null?[]:w.split(_.arrayFormatSeparator).map(H=>A(H,_));if(m[b]===void 0){m[b]=l;return}m[b]=[].concat(m[b],l)};default:return(b,w,m)=>{if(m[b]===void 0){m[b]=w;return}m[b]=[].concat(m[b],w)}}}function O(_){if(typeof _!="string"||_.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function S(_,E){return E.encode?E.strict?e(_):encodeURIComponent(_):_}function A(_,E){return E.decode?t(_):_}function z(_){return Array.isArray(_)?_.sort():typeof _=="object"?z(Object.keys(_)).sort((E,b)=>Number(E)-Number(b)).map(E=>_[E]):_}function N(_){const E=_.indexOf("#");return E!==-1&&(_=_.slice(0,E)),_}function P(_){let E="";const b=_.indexOf("#");return b!==-1&&(E=_.slice(b)),E}function q(_){_=N(_);const E=_.indexOf("?");return E===-1?"":_.slice(E+1)}function M(_,E){return E.parseNumbers&&!Number.isNaN(Number(_))&&typeof _=="string"&&_.trim()!==""?_=Number(_):E.parseBooleans&&_!==null&&(_.toLowerCase()==="true"||_.toLowerCase()==="false")&&(_=_.toLowerCase()==="true"),_}function B(_,E){E=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},E),O(E.arrayFormatSeparator);const b=g(E),w=Object.create(null);if(typeof _!="string"||(_=_.trim().replace(/^[?#&]/,""),!_))return w;for(const m of _.split("&")){if(m==="")continue;let[s,l]=i(E.decode?m.replace(/\+/g," "):m,"=");l=l===void 0?null:["comma","separator","bracket-separator"].includes(E.arrayFormat)?l:A(l,E),b(A(s,E),l,w)}for(const m of Object.keys(w)){const s=w[m];if(typeof s=="object"&&s!==null)for(const l of Object.keys(s))s[l]=M(s[l],E);else w[m]=M(s,E)}return E.sort===!1?w:(E.sort===!0?Object.keys(w).sort():Object.keys(w).sort(E.sort)).reduce((m,s)=>{const l=w[s];return Boolean(l)&&typeof l=="object"&&!Array.isArray(l)?m[s]=z(l):m[s]=l,m},Object.create(null))}r.extract=q,r.parse=B,r.stringify=(_,E)=>{if(!_)return"";E=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},E),O(E.arrayFormatSeparator);const b=l=>E.skipNull&&c(_[l])||E.skipEmptyString&&_[l]==="",w=u(E),m={};for(const l of Object.keys(_))b(l)||(m[l]=_[l]);const s=Object.keys(m);return E.sort!==!1&&s.sort(E.sort),s.map(l=>{const H=_[l];return H===void 0?"":H===null?S(l,E):Array.isArray(H)?H.length===0&&E.arrayFormat==="bracket-separator"?S(l,E)+"[]":H.reduce(w(l),[]).join("&"):S(l,E)+"="+S(H,E)}).filter(l=>l.length>0).join("&")},r.parseUrl=(_,E)=>{E=Object.assign({decode:!0},E);const[b,w]=i(_,"#");return Object.assign({url:b.split("?")[0]||"",query:B(q(_),E)},E&&E.parseFragmentIdentifier&&w?{fragmentIdentifier:A(w,E)}:{})},r.stringifyUrl=(_,E)=>{E=Object.assign({encode:!0,strict:!0,[y]:!0},E);const b=N(_.url).split("?")[0]||"",w=r.extract(_.url),m=r.parse(w,{sort:!1}),s=Object.assign(m,_.query);let l=r.stringify(s,E);l&&(l=`?${l}`);let H=P(_.url);return _.fragmentIdentifier&&(H=`#${E[y]?S(_.fragmentIdentifier,E):_.fragmentIdentifier}`),`${b}${l}${H}`},r.pick=(_,E,b)=>{b=Object.assign({parseFragmentIdentifier:!0,[y]:!1},b);const{url:w,query:m,fragmentIdentifier:s}=r.parseUrl(_,b);return r.stringifyUrl({url:w,query:n(m,E),fragmentIdentifier:s},b)},r.exclude=(_,E,b)=>{const w=Array.isArray(E)?m=>!E.includes(m):(m,s)=>!E(m,s);return r.pick(_,w,b)}})(vr);const Ul={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe"}},Ca="base10",ot="base16",Ni="base64pad",Zi="utf8",Ra=0,Jt=1,Ll=0,ss=1,Ci=12,Qi=32;function Ml(){const r=Yi.generateKeyPair();return{privateKey:ct(r.secretKey,ot),publicKey:ct(r.publicKey,ot)}}function Ri(){const r=ir.randomBytes(Qi);return ct(r,ot)}function jl(r,e){const t=Yi.sharedKey(at(r,ot),at(e,ot)),i=new hl(ii.SHA256,t).expand(Qi);return ct(i,ot)}function $l(r){const e=ii.hash(at(r,ot));return ct(e,ot)}function Fi(r){const e=ii.hash(at(r,Zi));return ct(e,ot)}function zl(r){return at(`${r}`,Ca)}function Ar(r){return Number(ct(r,Ca))}function Hl(r){const e=zl(typeof r.type<"u"?r.type:Ra);if(Ar(e)===Jt&&typeof r.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const t=typeof r.senderPublicKey<"u"?at(r.senderPublicKey,ot):void 0,i=typeof r.iv<"u"?at(r.iv,ot):ir.randomBytes(Ci),n=new Wi.ChaCha20Poly1305(at(r.symKey,ot)).seal(i,at(r.message,Zi));return Bl({type:e,sealed:n,iv:i,senderPublicKey:t})}function ql(r){const e=new Wi.ChaCha20Poly1305(at(r.symKey,ot)),{sealed:t,iv:i}=en(r.encoded),n=e.open(i,t);if(n===null)throw new Error("Failed to decrypt");return ct(n,Zi)}function Bl(r){if(Ar(r.type)===Jt){if(typeof r.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return ct(xi([r.type,r.senderPublicKey,r.iv,r.sealed]),Ni)}return ct(xi([r.type,r.iv,r.sealed]),Ni)}function en(r){const e=at(r,Ni),t=e.slice(Ll,ss),i=ss;if(Ar(t)===Jt){const u=i+Qi,g=u+Ci,O=e.slice(i,u),S=e.slice(u,g),A=e.slice(g);return{type:t,sealed:A,iv:S,senderPublicKey:O}}const n=i+Ci,c=e.slice(i,n),y=e.slice(n);return{type:t,sealed:y,iv:c}}function Kl(r,e){const t=en(r);return Fa({type:Ar(t.type),senderPublicKey:typeof t.senderPublicKey<"u"?ct(t.senderPublicKey,ot):void 0,receiverPublicKey:e==null?void 0:e.receiverPublicKey})}function Fa(r){const e=(r==null?void 0:r.type)||Ra;if(e===Jt){if(typeof(r==null?void 0:r.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(r==null?void 0:r.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:r==null?void 0:r.senderPublicKey,receiverPublicKey:r==null?void 0:r.receiverPublicKey}}function as(r){return r.type===Jt&&typeof r.senderPublicKey=="string"&&typeof r.receiverPublicKey=="string"}var Vl=Object.defineProperty,os=Object.getOwnPropertySymbols,Gl=Object.prototype.hasOwnProperty,Wl=Object.prototype.propertyIsEnumerable,cs=(r,e,t)=>e in r?Vl(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,us=(r,e)=>{for(var t in e||(e={}))Gl.call(e,t)&&cs(r,t,e[t]);if(os)for(var t of os(e))Wl.call(e,t)&&cs(r,t,e[t]);return r};const kl="ReactNative",br={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},Yl="js";function Ua(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function Jl(){return!Ta()&&!!Ji()&&navigator.product===kl}function Xl(){return!Ua()&&!!Ji()}function Zl(){return Jl()?br.reactNative:Ua()?br.node:Xl()?br.browser:br.unknown}function Ql(r,e){let t=vr.parse(r);return t=us(us({},t),e),r=vr.stringify(t),r}function ef(){return Aa()||{name:"",description:"",url:"",icons:[""]}}function tf(){const r=wl();if(r===null)return"unknown";const e=r.os?r.os.replace(" ","").toLowerCase():"unknown";return r.type==="browser"?[e,r.name,r.version].join("-"):[e,r.version].join("-")}function rf(){var r;const e=Zl();return e===br.browser?[e,((r=Pa())==null?void 0:r.host)||"unknown"].join(":"):e}function nf(r,e,t){const i=tf(),n=rf();return[[r,e].join("-"),[Yl,t].join("-"),i,n].join("/")}function sf({protocol:r,version:e,relayUrl:t,sdkVersion:i,auth:n,projectId:c}){const y=t.split("?"),u=nf(r,e,i),g={auth:n,ua:u,projectId:c},O=Ql(y[1]||"",g);return y[0]+"?"+O}function Ut(r,e){return r.filter(t=>e.includes(t)).length===r.length}function La(r){return Object.fromEntries(r.entries())}function Ma(r){return new Map(Object.entries(r))}function Dt(r,e){return ee.fromMiliseconds((e||Date.now())+ee.toMiliseconds(r))}function Ft(r){return ee.fromMiliseconds(Date.now())>=ee.toMiliseconds(r)}function Wt(r){const e=ee.toMiliseconds(r||ee.FIVE_MINUTES);let t,i,n;return{resolve:c=>{n&&t&&(clearTimeout(n),t(c))},reject:c=>{n&&i&&(clearTimeout(n),i(c))},done:()=>new Promise((c,y)=>{n=setTimeout(y,e),t=c,i=y})}}function ja(r,e){return new Promise(async(t,i)=>{const n=setTimeout(()=>i(),e),c=await r;clearTimeout(n),t(c)})}function $a(r,e){if(typeof e=="string"&&e.startsWith(`${r}:`))return e;if(r.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(r.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${r}`)}function af(r){return $a("topic",r)}function of(r){return $a("id",r)}function za(r){const[e,t]=r.split(":"),i={id:void 0,topic:void 0};if(e==="topic"&&typeof t=="string")i.topic=t;else if(e==="id"&&Number.isInteger(Number(t)))i.id=Number(t);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${t}`);return i}function Ue(r,e){return`${r}${e?`:${e}`:""}`}const cf="irn";function Ui(r){return(r==null?void 0:r.relay)||{protocol:cf}}function Li(r){const e=Ul[r];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${r}`);return e}var uf=Object.defineProperty,hs=Object.getOwnPropertySymbols,hf=Object.prototype.hasOwnProperty,lf=Object.prototype.propertyIsEnumerable,ls=(r,e,t)=>e in r?uf(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,ff=(r,e)=>{for(var t in e||(e={}))hf.call(e,t)&&ls(r,t,e[t]);if(hs)for(var t of hs(e))lf.call(e,t)&&ls(r,t,e[t]);return r};function df(r,e="-"){const t={},i="relay"+e;return Object.keys(r).forEach(n=>{if(n.startsWith(i)){const c=n.replace(i,""),y=r[n];t[c]=y}}),t}function gf(r){const e=r.indexOf(":"),t=r.indexOf("?")!==-1?r.indexOf("?"):void 0,i=r.substring(0,e),n=r.substring(e+1,t).split("@"),c=typeof t<"u"?r.substring(t):"",y=vr.parse(c);return{protocol:i,topic:n[0],version:parseInt(n[1],10),symKey:y.symKey,relay:df(y)}}function pf(r,e="-"){const t="relay",i={};return Object.keys(r).forEach(n=>{const c=t+e+n;r[n]&&(i[c]=r[n])}),i}function yf(r){return`${r.protocol}:${r.topic}@${r.version}?`+vr.stringify(ff({symKey:r.symKey},pf(r.relay)))}function Nr(r){const e=[];return r.forEach(t=>{const[i,n]=t.split(":");e.push(`${i}:${n}`)}),e}function _f(r){const e=[];return Object.values(r).forEach(t=>{e.push(...Nr(t.accounts))}),e}function bf(r,e){const t=[];return Object.values(r).forEach(i=>{Nr(i.accounts).includes(e)&&t.push(...i.methods)}),t}function wf(r,e){const t=[];return Object.values(r).forEach(i=>{Nr(i.accounts).includes(e)&&t.push(...i.events)}),t}function mf(r,e){const t=Kr(r,e);if(t)throw new Error(t.message);const i={};for(const[n,c]of Object.entries(r))i[n]={methods:c.methods,events:c.events,chains:c.accounts.map(y=>`${y.split(":")[0]}:${y.split(":")[1]}`)};return i}const vf={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},Ef={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function J(r,e){const{message:t,code:i}=Ef[r];return{message:e?`${t} ${e}`:t,code:i}}function Je(r,e){const{message:t,code:i}=vf[r];return{message:e?`${t} ${e}`:t,code:i}}function ni(r,e){return Array.isArray(r)?typeof e<"u"&&r.length?r.every(e):!0:!1}function kr(r){return Object.getPrototypeOf(r)===Object.prototype&&Object.keys(r).length}function pt(r){return typeof r>"u"}function Ze(r,e){return e&&pt(r)?!0:typeof r=="string"&&Boolean(r.trim().length)}function tn(r,e){return e&&pt(r)?!0:typeof r=="number"&&!isNaN(r)}function Df(r,e){const{requiredNamespaces:t}=e,i=Object.keys(r.namespaces),n=Object.keys(t);let c=!0;return Ut(n,i)?(i.forEach(y=>{const{accounts:u,methods:g,events:O}=r.namespaces[y],S=Nr(u),A=t[y];(!Ut(A.chains,S)||!Ut(A.methods,g)||!Ut(A.events,O))&&(c=!1)}),c):!1}function rn(r){return Ze(r,!1)&&r.includes(":")?r.split(":").length===2:!1}function Sf(r){if(Ze(r,!1)&&r.includes(":")){const e=r.split(":");if(e.length===3){const t=e[0]+":"+e[1];return!!e[2]&&rn(t)}}return!1}function Of(r){if(Ze(r,!1))try{return typeof new URL(r)<"u"}catch{return!1}return!1}function If(r){var e;return(e=r==null?void 0:r.proposer)==null?void 0:e.publicKey}function xf(r){return r==null?void 0:r.topic}function Tf(r,e){let t=null;return Ze(r==null?void 0:r.publicKey,!1)||(t=J("MISSING_OR_INVALID",`${e} controller public key should be a string`)),t}function fs(r){let e=!0;return ni(r)?r.length&&(e=r.every(t=>Ze(t,!1))):e=!1,e}function Pf(r,e,t){let i=null;return ni(e)?e.forEach(n=>{i||(!rn(n)||!n.includes(r))&&(i=Je("UNSUPPORTED_CHAINS",`${t}, chain ${n} should be a string and conform to "namespace:chainId" format`))}):i=Je("UNSUPPORTED_CHAINS",`${t}, chains ${e} should be an array of strings conforming to "namespace:chainId" format`),i}function Af(r,e){let t=null;return Object.entries(r).forEach(([i,n])=>{if(t)return;const c=Pf(i,n==null?void 0:n.chains,`${e} requiredNamespace`);c&&(t=c)}),t}function Nf(r,e){let t=null;return ni(r)?r.forEach(i=>{t||Sf(i)||(t=Je("UNSUPPORTED_ACCOUNTS",`${e}, account ${i} should be a string and conform to "namespace:chainId:address" format`))}):t=Je("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),t}function Cf(r,e){let t=null;return Object.values(r).forEach(i=>{if(t)return;const n=Nf(i==null?void 0:i.accounts,`${e} namespace`);n&&(t=n)}),t}function Rf(r,e){let t=null;return fs(r==null?void 0:r.methods)?fs(r==null?void 0:r.events)||(t=Je("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):t=Je("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),t}function Ha(r,e){let t=null;return Object.values(r).forEach(i=>{if(t)return;const n=Rf(i,`${e}, namespace`);n&&(t=n)}),t}function Ff(r,e){let t=null;if(r&&kr(r)){const i=Ha(r,e);i&&(t=i);const n=Af(r,e);n&&(t=n)}else t=J("MISSING_OR_INVALID",`${e}, requiredNamespaces should be an object with data`);return t}function Kr(r,e){let t=null;if(r&&kr(r)){const i=Ha(r,e);i&&(t=i);const n=Cf(r,e);n&&(t=n)}else t=J("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return t}function qa(r){return Ze(r.protocol,!0)}function Uf(r,e){let t=!1;return e&&!r?t=!0:r&&ni(r)&&r.length&&r.forEach(i=>{t=qa(i)}),t}function Lf(r){return typeof r=="number"}function st(r){return typeof r<"u"&&typeof r!==null}function Mf(r){return!(!r||typeof r!="object"||!r.code||!tn(r.code,!1)||!r.message||!Ze(r.message,!1))}function jf(r){return!(pt(r)||!Ze(r.method,!1))}function $f(r){return!(pt(r)||pt(r.result)&&pt(r.error)||!tn(r.id,!1)||!Ze(r.jsonrpc,!1))}function zf(r){return!(pt(r)||!Ze(r.name,!1))}function ds(r,e){return!(!rn(e)||!_f(r).includes(e))}function Hf(r,e,t){return Ze(t,!1)?bf(r,e).includes(t):!1}function qf(r,e,t){return Ze(t,!1)?wf(r,e).includes(t):!1}function gs(r,e,t){let i=null;const n=Object.keys(r),c=Object.keys(e);return Ut(n,c)?n.forEach(y=>{if(i)return;const u=r[y].chains,g=Nr(e[y].accounts);Ut(u,g)?Ut(r[y].methods,e[y].methods)?Ut(r[y].events,e[y].events)||(i=J("NON_CONFORMING_NAMESPACES",`${t} namespaces events don't satisfy requiredNamespaces events for ${y}`)):i=J("NON_CONFORMING_NAMESPACES",`${t} namespaces methods don't satisfy requiredNamespaces methods for ${y}`):i=J("NON_CONFORMING_NAMESPACES",`${t} namespaces accounts don't satisfy requiredNamespaces chains for ${y}`)}):i=J("NON_CONFORMING_NAMESPACES",`${t} namespaces keys don't satisfy requiredNamespaces`),i}function Bf(r,e){return tn(r,!1)&&r<=e.max&&r>=e.min}const ps=10,Kf=()=>typeof globalThis<"u"&&typeof globalThis.WebSocket<"u"?globalThis.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:require("ws"),Vf=()=>typeof window<"u",Gf=Kf();class Wf{constructor(e){if(this.url=e,this.events=new yt.exports.EventEmitter,this.registering=!1,!mn(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,t)=>{if(typeof this.socket>"u"){t(new Error("Connection already closed"));return}this.socket.onclose=i=>{this.onClose(i),e()},this.socket.close()})}async send(e,t){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(zi(e))}catch(i){this.onError(e.id,i)}}register(e=this.url){if(!mn(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((i,n)=>{this.events.once("register_error",c=>{this.resetMaxListeners(),n(c)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return n(new Error("WebSocket connection is missing or invalid"));i(this.socket)})})}return this.url=e,this.registering=!0,new Promise((t,i)=>{const n=ko.isReactNative()?void 0:{rejectUnauthorized:!Yo(e)},c=new Gf(e,[],n);Vf()?c.onerror=y=>{const u=y;i(this.emitError(u.error))}:c.on("error",y=>{i(this.emitError(y))}),c.onopen=()=>{this.onOpen(c),t(c)}})}onOpen(e){e.onmessage=t=>this.onPayload(t),e.onclose=t=>this.onClose(t),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const t=typeof e.data=="string"?Vs(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const i=this.parseError(t),n=i.message||i.toString(),c=Hi(e,n);this.events.emit("payload",c)}parseError(e,t=this.url){return Jo(e,t,"WS")}resetMaxListeners(){this.events.getMaxListeners()>ps&&this.events.setMaxListeners(ps)}emitError(e){const t=this.parseError(new Error((e==null?void 0:e.message)||`WebSocket connection failed for URL: ${this.url}`));return this.events.emit("register_error",t),t}}var Mi={exports:{}};(function(r,e){var t=200,i="__lodash_hash_undefined__",n=1,c=2,y=9007199254740991,u="[object Arguments]",g="[object Array]",O="[object AsyncFunction]",S="[object Boolean]",A="[object Date]",z="[object Error]",N="[object Function]",P="[object GeneratorFunction]",q="[object Map]",M="[object Number]",B="[object Null]",_="[object Object]",E="[object Promise]",b="[object Proxy]",w="[object RegExp]",m="[object Set]",s="[object String]",l="[object Symbol]",H="[object Undefined]",o="[object WeakMap]",f="[object ArrayBuffer]",d="[object DataView]",v="[object Float32Array]",p="[object Float64Array]",h="[object Int8Array]",T="[object Int16Array]",F="[object Int32Array]",$="[object Uint8Array]",I="[object Uint8ClampedArray]",j="[object Uint16Array]",K="[object Uint32Array]",G=/[\\^$.*+?()[\]{}|]/g,V=/^\[object .+?Constructor\]$/,Q=/^(?:0|[1-9]\d*)$/,Y={};Y[v]=Y[p]=Y[h]=Y[T]=Y[F]=Y[$]=Y[I]=Y[j]=Y[K]=!0,Y[u]=Y[g]=Y[f]=Y[S]=Y[d]=Y[A]=Y[z]=Y[N]=Y[q]=Y[M]=Y[_]=Y[w]=Y[m]=Y[s]=Y[o]=!1;var oe=typeof globalThis=="object"&&globalThis&&globalThis.Object===Object&&globalThis,L=typeof self=="object"&&self&&self.Object===Object&&self,U=oe||L||Function("return this")(),C=e&&!e.nodeType&&e,a=C&&!0&&r&&!r.nodeType&&r,x=a&&a.exports===C,k=x&&oe.process,X=function(){try{return k&&k.binding&&k.binding("util")}catch{}}(),le=X&&X.isTypedArray;function _e(D,R){for(var W=-1,Z=D==null?0:D.length,xe=0,ne=[];++W<Z;){var Re=D[W];R(Re,W,D)&&(ne[xe++]=Re)}return ne}function de(D,R){for(var W=-1,Z=R.length,xe=D.length;++W<Z;)D[xe+W]=R[W];return D}function me(D,R){for(var W=-1,Z=D==null?0:D.length;++W<Z;)if(R(D[W],W,D))return!0;return!1}function Fe(D,R){for(var W=-1,Z=Array(D);++W<D;)Z[W]=R(W);return Z}function Ae(D){return function(R){return D(R)}}function ye(D,R){return D.has(R)}function ge(D,R){return D==null?void 0:D[R]}function fe(D){var R=-1,W=Array(D.size);return D.forEach(function(Z,xe){W[++R]=[xe,Z]}),W}function ue(D,R){return function(W){return D(R(W))}}function ce(D){var R=-1,W=Array(D.size);return D.forEach(function(Z){W[++R]=Z}),W}var ae=Array.prototype,se=Function.prototype,te=Object.prototype,he=U["__core-js_shared__"],pe=se.toString,re=te.hasOwnProperty,be=function(){var D=/[^.]+$/.exec(he&&he.keys&&he.keys.IE_PROTO||"");return D?"Symbol(src)_1."+D:""}(),we=te.toString,Ee=RegExp("^"+pe.call(re).replace(G,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),De=x?U.Buffer:void 0,ve=U.Symbol,_t=U.Uint8Array,wt=te.propertyIsEnumerable,Pt=ae.splice,ut=ve?ve.toStringTag:void 0,$t=Object.getOwnPropertySymbols,ar=De?De.isBuffer:void 0,Rr=ue(Object.keys,Object),Le=Zt(U,"DataView"),Ne=Zt(U,"Map"),Me=Zt(U,"Promise"),je=Zt(U,"Set"),$e=Zt(U,"WeakMap"),Ce=Zt(Object,"create"),qe=Ht(Le),Be=Ht(Ne),Ke=Ht(Me),Ve=Ht(je),Ge=Ht($e),He=ve?ve.prototype:void 0,ze=He?He.valueOf:void 0;function Te(D){var R=-1,W=D==null?0:D.length;for(this.clear();++R<W;){var Z=D[R];this.set(Z[0],Z[1])}}function We(){this.__data__=Ce?Ce(null):{},this.size=0}function ke(D){var R=this.has(D)&&delete this.__data__[D];return this.size-=R?1:0,R}function no(D){var R=this.__data__;if(Ce){var W=R[D];return W===i?void 0:W}return re.call(R,D)?R[D]:void 0}function so(D){var R=this.__data__;return Ce?R[D]!==void 0:re.call(R,D)}function ao(D,R){var W=this.__data__;return this.size+=this.has(D)?0:1,W[D]=Ce&&R===void 0?i:R,this}Te.prototype.clear=We,Te.prototype.delete=ke,Te.prototype.get=no,Te.prototype.has=so,Te.prototype.set=ao;function Ot(D){var R=-1,W=D==null?0:D.length;for(this.clear();++R<W;){var Z=D[R];this.set(Z[0],Z[1])}}function oo(){this.__data__=[],this.size=0}function co(D){var R=this.__data__,W=Ur(R,D);if(W<0)return!1;var Z=R.length-1;return W==Z?R.pop():Pt.call(R,W,1),--this.size,!0}function uo(D){var R=this.__data__,W=Ur(R,D);return W<0?void 0:R[W][1]}function ho(D){return Ur(this.__data__,D)>-1}function lo(D,R){var W=this.__data__,Z=Ur(W,D);return Z<0?(++this.size,W.push([D,R])):W[Z][1]=R,this}Ot.prototype.clear=oo,Ot.prototype.delete=co,Ot.prototype.get=uo,Ot.prototype.has=ho,Ot.prototype.set=lo;function zt(D){var R=-1,W=D==null?0:D.length;for(this.clear();++R<W;){var Z=D[R];this.set(Z[0],Z[1])}}function fo(){this.size=0,this.__data__={hash:new Te,map:new(Ne||Ot),string:new Te}}function go(D){var R=Lr(this,D).delete(D);return this.size-=R?1:0,R}function po(D){return Lr(this,D).get(D)}function yo(D){return Lr(this,D).has(D)}function _o(D,R){var W=Lr(this,D),Z=W.size;return W.set(D,R),this.size+=W.size==Z?0:1,this}zt.prototype.clear=fo,zt.prototype.delete=go,zt.prototype.get=po,zt.prototype.has=yo,zt.prototype.set=_o;function Fr(D){var R=-1,W=D==null?0:D.length;for(this.__data__=new zt;++R<W;)this.add(D[R])}function bo(D){return this.__data__.set(D,i),this}function wo(D){return this.__data__.has(D)}Fr.prototype.add=Fr.prototype.push=bo,Fr.prototype.has=wo;function At(D){var R=this.__data__=new Ot(D);this.size=R.size}function mo(){this.__data__=new Ot,this.size=0}function vo(D){var R=this.__data__,W=R.delete(D);return this.size=R.size,W}function Eo(D){return this.__data__.get(D)}function Do(D){return this.__data__.has(D)}function So(D,R){var W=this.__data__;if(W instanceof Ot){var Z=W.__data__;if(!Ne||Z.length<t-1)return Z.push([D,R]),this.size=++W.size,this;W=this.__data__=new zt(Z)}return W.set(D,R),this.size=W.size,this}At.prototype.clear=mo,At.prototype.delete=vo,At.prototype.get=Eo,At.prototype.has=Do,At.prototype.set=So;function Oo(D,R){var W=Mr(D),Z=!W&&zo(D),xe=!W&&!Z&&oi(D),ne=!W&&!Z&&!xe&&bn(D),Re=W||Z||xe||ne,Ye=Re?Fe(D.length,String):[],Xe=Ye.length;for(var Pe in D)(R||re.call(D,Pe))&&!(Re&&(Pe=="length"||xe&&(Pe=="offset"||Pe=="parent")||ne&&(Pe=="buffer"||Pe=="byteLength"||Pe=="byteOffset")||Uo(Pe,Xe)))&&Ye.push(Pe);return Ye}function Ur(D,R){for(var W=D.length;W--;)if(gn(D[W][0],R))return W;return-1}function Io(D,R,W){var Z=R(D);return Mr(D)?Z:de(Z,W(D))}function or(D){return D==null?D===void 0?H:B:ut&&ut in Object(D)?Ro(D):$o(D)}function hn(D){return cr(D)&&or(D)==u}function ln(D,R,W,Z,xe){return D===R?!0:D==null||R==null||!cr(D)&&!cr(R)?D!==D&&R!==R:xo(D,R,W,Z,ln,xe)}function xo(D,R,W,Z,xe,ne){var Re=Mr(D),Ye=Mr(R),Xe=Re?g:Nt(D),Pe=Ye?g:Nt(R);Xe=Xe==u?_:Xe,Pe=Pe==u?_:Pe;var ht=Xe==_,bt=Pe==_,tt=Xe==Pe;if(tt&&oi(D)){if(!oi(R))return!1;Re=!0,ht=!1}if(tt&&!ht)return ne||(ne=new At),Re||bn(D)?fn(D,R,W,Z,xe,ne):No(D,R,Xe,W,Z,xe,ne);if(!(W&n)){var ft=ht&&re.call(D,"__wrapped__"),dt=bt&&re.call(R,"__wrapped__");if(ft||dt){var Ct=ft?D.value():D,It=dt?R.value():R;return ne||(ne=new At),xe(Ct,It,W,Z,ne)}}return tt?(ne||(ne=new At),Co(D,R,W,Z,xe,ne)):!1}function To(D){if(!_n(D)||Mo(D))return!1;var R=pn(D)?Ee:V;return R.test(Ht(D))}function Po(D){return cr(D)&&yn(D.length)&&!!Y[or(D)]}function Ao(D){if(!jo(D))return Rr(D);var R=[];for(var W in Object(D))re.call(D,W)&&W!="constructor"&&R.push(W);return R}function fn(D,R,W,Z,xe,ne){var Re=W&n,Ye=D.length,Xe=R.length;if(Ye!=Xe&&!(Re&&Xe>Ye))return!1;var Pe=ne.get(D);if(Pe&&ne.get(R))return Pe==R;var ht=-1,bt=!0,tt=W&c?new Fr:void 0;for(ne.set(D,R),ne.set(R,D);++ht<Ye;){var ft=D[ht],dt=R[ht];if(Z)var Ct=Re?Z(dt,ft,ht,R,D,ne):Z(ft,dt,ht,D,R,ne);if(Ct!==void 0){if(Ct)continue;bt=!1;break}if(tt){if(!me(R,function(It,qt){if(!ye(tt,qt)&&(ft===It||xe(ft,It,W,Z,ne)))return tt.push(qt)})){bt=!1;break}}else if(!(ft===dt||xe(ft,dt,W,Z,ne))){bt=!1;break}}return ne.delete(D),ne.delete(R),bt}function No(D,R,W,Z,xe,ne,Re){switch(W){case d:if(D.byteLength!=R.byteLength||D.byteOffset!=R.byteOffset)return!1;D=D.buffer,R=R.buffer;case f:return!(D.byteLength!=R.byteLength||!ne(new _t(D),new _t(R)));case S:case A:case M:return gn(+D,+R);case z:return D.name==R.name&&D.message==R.message;case w:case s:return D==R+"";case q:var Ye=fe;case m:var Xe=Z&n;if(Ye||(Ye=ce),D.size!=R.size&&!Xe)return!1;var Pe=Re.get(D);if(Pe)return Pe==R;Z|=c,Re.set(D,R);var ht=fn(Ye(D),Ye(R),Z,xe,ne,Re);return Re.delete(D),ht;case l:if(ze)return ze.call(D)==ze.call(R)}return!1}function Co(D,R,W,Z,xe,ne){var Re=W&n,Ye=dn(D),Xe=Ye.length,Pe=dn(R),ht=Pe.length;if(Xe!=ht&&!Re)return!1;for(var bt=Xe;bt--;){var tt=Ye[bt];if(!(Re?tt in R:re.call(R,tt)))return!1}var ft=ne.get(D);if(ft&&ne.get(R))return ft==R;var dt=!0;ne.set(D,R),ne.set(R,D);for(var Ct=Re;++bt<Xe;){tt=Ye[bt];var It=D[tt],qt=R[tt];if(Z)var wn=Re?Z(qt,It,tt,R,D,ne):Z(It,qt,tt,D,R,ne);if(!(wn===void 0?It===qt||xe(It,qt,W,Z,ne):wn)){dt=!1;break}Ct||(Ct=tt=="constructor")}if(dt&&!Ct){var jr=D.constructor,$r=R.constructor;jr!=$r&&"constructor"in D&&"constructor"in R&&!(typeof jr=="function"&&jr instanceof jr&&typeof $r=="function"&&$r instanceof $r)&&(dt=!1)}return ne.delete(D),ne.delete(R),dt}function dn(D){return Io(D,Bo,Fo)}function Lr(D,R){var W=D.__data__;return Lo(R)?W[typeof R=="string"?"string":"hash"]:W.map}function Zt(D,R){var W=ge(D,R);return To(W)?W:void 0}function Ro(D){var R=re.call(D,ut),W=D[ut];try{D[ut]=void 0;var Z=!0}catch{}var xe=we.call(D);return Z&&(R?D[ut]=W:delete D[ut]),xe}var Fo=$t?function(D){return D==null?[]:(D=Object(D),_e($t(D),function(R){return wt.call(D,R)}))}:Ko,Nt=or;(Le&&Nt(new Le(new ArrayBuffer(1)))!=d||Ne&&Nt(new Ne)!=q||Me&&Nt(Me.resolve())!=E||je&&Nt(new je)!=m||$e&&Nt(new $e)!=o)&&(Nt=function(D){var R=or(D),W=R==_?D.constructor:void 0,Z=W?Ht(W):"";if(Z)switch(Z){case qe:return d;case Be:return q;case Ke:return E;case Ve:return m;case Ge:return o}return R});function Uo(D,R){return R=R==null?y:R,!!R&&(typeof D=="number"||Q.test(D))&&D>-1&&D%1==0&&D<R}function Lo(D){var R=typeof D;return R=="string"||R=="number"||R=="symbol"||R=="boolean"?D!=="__proto__":D===null}function Mo(D){return!!be&&be in D}function jo(D){var R=D&&D.constructor,W=typeof R=="function"&&R.prototype||te;return D===W}function $o(D){return we.call(D)}function Ht(D){if(D!=null){try{return pe.call(D)}catch{}try{return D+""}catch{}}return""}function gn(D,R){return D===R||D!==D&&R!==R}var zo=hn(function(){return arguments}())?hn:function(D){return cr(D)&&re.call(D,"callee")&&!wt.call(D,"callee")},Mr=Array.isArray;function Ho(D){return D!=null&&yn(D.length)&&!pn(D)}var oi=ar||Vo;function qo(D,R){return ln(D,R)}function pn(D){if(!_n(D))return!1;var R=or(D);return R==N||R==P||R==O||R==b}function yn(D){return typeof D=="number"&&D>-1&&D%1==0&&D<=y}function _n(D){var R=typeof D;return D!=null&&(R=="object"||R=="function")}function cr(D){return D!=null&&typeof D=="object"}var bn=le?Ae(le):Po;function Bo(D){return Ho(D)?Oo(D):Ao(D)}function Ko(){return[]}function Vo(){return!1}r.exports=qo})(Mi,Mi.exports);const kf=Mi.exports;function Yf(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),i=0;i<t.length;i++)t[i]=255;for(var n=0;n<r.length;n++){var c=r.charAt(n),y=c.charCodeAt(0);if(t[y]!==255)throw new TypeError(c+" is ambiguous");t[y]=n}var u=r.length,g=r.charAt(0),O=Math.log(u)/Math.log(256),S=Math.log(256)/Math.log(u);function A(P){if(P instanceof Uint8Array||(ArrayBuffer.isView(P)?P=new Uint8Array(P.buffer,P.byteOffset,P.byteLength):Array.isArray(P)&&(P=Uint8Array.from(P))),!(P instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(P.length===0)return"";for(var q=0,M=0,B=0,_=P.length;B!==_&&P[B]===0;)B++,q++;for(var E=(_-B)*S+1>>>0,b=new Uint8Array(E);B!==_;){for(var w=P[B],m=0,s=E-1;(w!==0||m<M)&&s!==-1;s--,m++)w+=256*b[s]>>>0,b[s]=w%u>>>0,w=w/u>>>0;if(w!==0)throw new Error("Non-zero carry");M=m,B++}for(var l=E-M;l!==E&&b[l]===0;)l++;for(var H=g.repeat(q);l<E;++l)H+=r.charAt(b[l]);return H}function z(P){if(typeof P!="string")throw new TypeError("Expected String");if(P.length===0)return new Uint8Array;var q=0;if(P[q]!==" "){for(var M=0,B=0;P[q]===g;)M++,q++;for(var _=(P.length-q)*O+1>>>0,E=new Uint8Array(_);P[q];){var b=t[P.charCodeAt(q)];if(b===255)return;for(var w=0,m=_-1;(b!==0||w<B)&&m!==-1;m--,w++)b+=u*E[m]>>>0,E[m]=b%256>>>0,b=b/256>>>0;if(b!==0)throw new Error("Non-zero carry");B=w,q++}if(P[q]!==" "){for(var s=_-B;s!==_&&E[s]===0;)s++;for(var l=new Uint8Array(M+(_-s)),H=M;s!==_;)l[H++]=E[s++];return l}}}function N(P){var q=z(P);if(q)return q;throw new Error(`Non-${e} character`)}return{encode:A,decodeUnsafe:z,decode:N}}var Jf=Yf,Xf=Jf;const Ba=r=>{if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")},Zf=r=>new TextEncoder().encode(r),Qf=r=>new TextDecoder().decode(r);class ed{constructor(e,t,i){this.name=e,this.prefix=t,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class td{constructor(e,t,i){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=i}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Ka(this,e)}}class rd{constructor(e){this.decoders=e}or(e){return Ka(this,e)}decode(e){const t=e[0],i=this.decoders[t];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Ka=(r,e)=>new rd({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class id{constructor(e,t,i,n){this.name=e,this.prefix=t,this.baseEncode=i,this.baseDecode=n,this.encoder=new ed(e,t,i),this.decoder=new td(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const si=({name:r,prefix:e,encode:t,decode:i})=>new id(r,e,t,i),Cr=({prefix:r,name:e,alphabet:t})=>{const{encode:i,decode:n}=Xf(t,e);return si({prefix:r,name:e,encode:i,decode:c=>Ba(n(c))})},nd=(r,e,t,i)=>{const n={};for(let S=0;S<e.length;++S)n[e[S]]=S;let c=r.length;for(;r[c-1]==="=";)--c;const y=new Uint8Array(c*t/8|0);let u=0,g=0,O=0;for(let S=0;S<c;++S){const A=n[r[S]];if(A===void 0)throw new SyntaxError(`Non-${i} character`);g=g<<t|A,u+=t,u>=8&&(u-=8,y[O++]=255&g>>u)}if(u>=t||255&g<<8-u)throw new SyntaxError("Unexpected end of data");return y},sd=(r,e,t)=>{const i=e[e.length-1]==="=",n=(1<<t)-1;let c="",y=0,u=0;for(let g=0;g<r.length;++g)for(u=u<<8|r[g],y+=8;y>t;)y-=t,c+=e[n&u>>y];if(y&&(c+=e[n&u<<t-y]),i)for(;c.length*t&7;)c+="=";return c},et=({name:r,prefix:e,bitsPerChar:t,alphabet:i})=>si({prefix:e,name:r,encode(n){return sd(n,i,t)},decode(n){return nd(n,i,t,r)}}),ad=si({prefix:"\0",name:"identity",encode:r=>Qf(r),decode:r=>Zf(r)});var od=Object.freeze({__proto__:null,identity:ad});const cd=et({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var ud=Object.freeze({__proto__:null,base2:cd});const hd=et({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var ld=Object.freeze({__proto__:null,base8:hd});const fd=Cr({prefix:"9",name:"base10",alphabet:"0123456789"});var dd=Object.freeze({__proto__:null,base10:fd});const gd=et({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),pd=et({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var yd=Object.freeze({__proto__:null,base16:gd,base16upper:pd});const _d=et({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),bd=et({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),wd=et({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),md=et({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),vd=et({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Ed=et({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Dd=et({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Sd=et({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Od=et({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Id=Object.freeze({__proto__:null,base32:_d,base32upper:bd,base32pad:wd,base32padupper:md,base32hex:vd,base32hexupper:Ed,base32hexpad:Dd,base32hexpadupper:Sd,base32z:Od});const xd=Cr({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Td=Cr({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Pd=Object.freeze({__proto__:null,base36:xd,base36upper:Td});const Ad=Cr({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Nd=Cr({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Cd=Object.freeze({__proto__:null,base58btc:Ad,base58flickr:Nd});const Rd=et({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Fd=et({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Ud=et({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Ld=et({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Md=Object.freeze({__proto__:null,base64:Rd,base64pad:Fd,base64url:Ud,base64urlpad:Ld});const Va=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),jd=Va.reduce((r,e,t)=>(r[t]=e,r),[]),$d=Va.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]);function zd(r){return r.reduce((e,t)=>(e+=jd[t],e),"")}function Hd(r){const e=[];for(const t of r){const i=$d[t.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(i)}return new Uint8Array(e)}const qd=si({prefix:"\u{1F680}",name:"base256emoji",encode:zd,decode:Hd});var Bd=Object.freeze({__proto__:null,base256emoji:qd}),Kd=Ga,ys=128,Vd=127,Gd=~Vd,Wd=Math.pow(2,31);function Ga(r,e,t){e=e||[],t=t||0;for(var i=t;r>=Wd;)e[t++]=r&255|ys,r/=128;for(;r&Gd;)e[t++]=r&255|ys,r>>>=7;return e[t]=r|0,Ga.bytes=t-i+1,e}var kd=ji,Yd=128,_s=127;function ji(r,i){var t=0,i=i||0,n=0,c=i,y,u=r.length;do{if(c>=u)throw ji.bytes=0,new RangeError("Could not decode varint");y=r[c++],t+=n<28?(y&_s)<<n:(y&_s)*Math.pow(2,n),n+=7}while(y>=Yd);return ji.bytes=c-i,t}var Jd=Math.pow(2,7),Xd=Math.pow(2,14),Zd=Math.pow(2,21),Qd=Math.pow(2,28),eg=Math.pow(2,35),tg=Math.pow(2,42),rg=Math.pow(2,49),ig=Math.pow(2,56),ng=Math.pow(2,63),sg=function(r){return r<Jd?1:r<Xd?2:r<Zd?3:r<Qd?4:r<eg?5:r<tg?6:r<rg?7:r<ig?8:r<ng?9:10},ag={encode:Kd,decode:kd,encodingLength:sg},Wa=ag;const bs=(r,e,t=0)=>(Wa.encode(r,e,t),e),ws=r=>Wa.encodingLength(r),$i=(r,e)=>{const t=e.byteLength,i=ws(r),n=i+ws(t),c=new Uint8Array(n+t);return bs(r,c,0),bs(t,c,i),c.set(e,n),new og(r,t,e,c)};class og{constructor(e,t,i,n){this.code=e,this.size=t,this.digest=i,this.bytes=n}}const ka=({name:r,code:e,encode:t})=>new cg(r,e,t);class cg{constructor(e,t,i){this.name=e,this.code=t,this.encode=i}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?$i(this.code,t):t.then(i=>$i(this.code,i))}else throw Error("Unknown type, must be binary type")}}const Ya=r=>async e=>new Uint8Array(await crypto.subtle.digest(r,e)),ug=ka({name:"sha2-256",code:18,encode:Ya("SHA-256")}),hg=ka({name:"sha2-512",code:19,encode:Ya("SHA-512")});var lg=Object.freeze({__proto__:null,sha256:ug,sha512:hg});const Ja=0,fg="identity",Xa=Ba,dg=r=>$i(Ja,Xa(r)),gg={code:Ja,name:fg,encode:Xa,digest:dg};var pg=Object.freeze({__proto__:null,identity:gg});new TextEncoder,new TextDecoder;const ms={...od,...ud,...ld,...dd,...yd,...Id,...Pd,...Cd,...Md,...Bd};({...lg,...pg});function yg(r=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(r):new Uint8Array(r)}function Za(r,e,t,i){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:i}}}const vs=Za("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>new TextEncoder().encode(r.substring(1))),_i=Za("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{r=r.substring(1);const e=yg(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),_g={utf8:vs,"utf-8":vs,hex:ms.base16,latin1:_i,ascii:_i,binary:_i,...ms};function bg(r,e="utf8"){const t=_g[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r,"utf8"):t.decoder.decode(`${t.prefix}${r}`)}const Qa="wc",wg=2,nn="core",Lt=`${Qa}@${2}:${nn}:`,mg={name:nn,logger:"error"},vg={database:":memory:"},Eg="crypto",Es="client_ed25519_seed",Dg=ee.ONE_DAY,Sg="keychain",Og="0.3",Ig="messages",xg="0.3",Tg=ee.SIX_HOURS,Pg="publisher",eo="irn",Ag="error",Ng="wss://relay.walletconnect.com",Cg="relayer",it={message:"relayer_message",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},Rg="_subscription",Hr={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},Ds=ee.ONE_SECOND,Fg="2.3.3",Ug="0.3",Et={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},Lg="subscription",Mg="0.3",jg=ee.FIVE_SECONDS*1e3,$g="pairing",zg="0.3",yr={wc_pairingDelete:{req:{ttl:ee.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:ee.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:ee.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:ee.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:ee.ONE_DAY,prompt:!1,tag:0},res:{ttl:ee.ONE_DAY,prompt:!1,tag:0}}},vt={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},Hg="history",qg="0.3",Bg="expirer",gt={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},Kg="0.3";class Vg{constructor(e,t){this.core=e,this.logger=t,this.keychain=new Map,this.name=Sg,this.version=Og,this.initialized=!1,this.storagePrefix=Lt,this.init=async()=>{if(!this.initialized){const i=await this.getKeyChain();typeof i<"u"&&(this.keychain=i),this.initialized=!0}},this.has=i=>(this.isInitialized(),this.keychain.has(i)),this.set=async(i,n)=>{this.isInitialized(),this.keychain.set(i,n),await this.persist()},this.get=i=>{this.isInitialized();const n=this.keychain.get(i);if(typeof n>"u"){const{message:c}=J("NO_MATCHING_KEY",`${this.name}: ${i}`);throw new Error(c)}return n},this.del=async i=>{this.isInitialized(),this.keychain.delete(i),await this.persist()},this.core=e,this.logger=Se.generateChildLogger(t,this.name)}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,La(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?Ma(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}}class Gg{constructor(e,t,i){this.core=e,this.logger=t,this.name=Eg,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=n=>(this.isInitialized(),this.keychain.has(n)),this.getClientId=async()=>{this.isInitialized();const n=await this.getClientSeed(),c=Xn(n);return Ea(c.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const n=Ml();return this.setPrivateKey(n.publicKey,n.privateKey)},this.signJWT=async n=>{this.isInitialized();const c=await this.getClientSeed(),y=Xn(c),u=Ri();return await Xh(u,n,Dg,y)},this.generateSharedKey=(n,c,y)=>{this.isInitialized();const u=this.getPrivateKey(n),g=jl(u,c);return this.setSymKey(g,y)},this.setSymKey=async(n,c)=>{this.isInitialized();const y=c||$l(n);return await this.keychain.set(y,n),y},this.deleteKeyPair=async n=>{this.isInitialized(),await this.keychain.del(n)},this.deleteSymKey=async n=>{this.isInitialized(),await this.keychain.del(n)},this.encode=async(n,c,y)=>{this.isInitialized();const u=Fa(y),g=zi(c);if(as(u)){const z=u.senderPublicKey,N=u.receiverPublicKey;n=await this.generateSharedKey(z,N)}const O=this.getSymKey(n),{type:S,senderPublicKey:A}=u;return Hl({type:S,symKey:O,message:g,senderPublicKey:A})},this.decode=async(n,c,y)=>{this.isInitialized();const u=Kl(c,y);if(as(u)){const S=u.receiverPublicKey,A=u.senderPublicKey;n=await this.generateSharedKey(S,A)}const g=this.getSymKey(n),O=ql({symKey:g,encoded:c});return Vs(O)},this.core=e,this.logger=Se.generateChildLogger(t,this.name),this.keychain=i||new Vg(this.core,this.logger)}get context(){return Se.getLoggerContext(this.logger)}getPayloadType(e){const t=en(e);return Ar(t.type)}async setPrivateKey(e,t){return await this.keychain.set(e,t),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(Es)}catch{e=Ri(),await this.keychain.set(Es,e)}return bg(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}}class Wg extends Uc{constructor(e,t){super(e,t),this.logger=e,this.core=t,this.messages=new Map,this.name=Ig,this.version=xg,this.initialized=!1,this.storagePrefix=Lt,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const i=await this.getRelayerMessages();typeof i<"u"&&(this.messages=i),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(i){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(i)}finally{this.initialized=!0}}},this.set=async(i,n)=>{this.isInitialized();const c=Fi(n);let y=this.messages.get(i);return typeof y>"u"&&(y={}),typeof y[c]<"u"||(y[c]=n,this.messages.set(i,y),await this.persist()),c},this.get=i=>{this.isInitialized();let n=this.messages.get(i);return typeof n>"u"&&(n={}),n},this.has=(i,n)=>{this.isInitialized();const c=this.get(i),y=Fi(n);return typeof c[y]<"u"},this.del=async i=>{this.isInitialized(),this.messages.delete(i),await this.persist()},this.logger=Se.generateChildLogger(e,this.name),this.core=t}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,La(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?Ma(e):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}}class kg extends Lc{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,this.events=new yt.exports.EventEmitter,this.name=Pg,this.queue=new Map,this.publishTimeout=1e4,this.publish=async(i,n,c)=>{this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:i,message:n,opts:c}});try{const y=(c==null?void 0:c.ttl)||Tg,u=Ui(c),g=(c==null?void 0:c.prompt)||!1,O=(c==null?void 0:c.tag)||0,S={topic:i,message:n,opts:{ttl:y,relay:u,prompt:g,tag:O}},A=Fi(n);this.queue.set(A,S);try{await await ja(this.rpcPublish(i,n,y,u,g,O),this.publishTimeout),this.relayer.events.emit(it.publish,S)}catch{this.logger.debug("Publishing Payload stalled"),this.relayer.events.emit(it.connection_stalled);return}this.onPublish(A,S),this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:i,message:n,opts:c}})}catch(y){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(y),y}},this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.relayer=e,this.logger=Se.generateChildLogger(t,this.name),this.registerEventListeners()}get context(){return Se.getLoggerContext(this.logger)}rpcPublish(e,t,i,n,c,y){var u,g,O,S;const A={method:Li(n.protocol).publish,params:{topic:e,message:t,ttl:i,prompt:c,tag:y}};return pt((u=A.params)==null?void 0:u.prompt)&&((g=A.params)==null||delete g.prompt),pt((O=A.params)==null?void 0:O.tag)&&((S=A.params)==null||delete S.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:A}),this.relayer.provider.request(A)}onPublish(e,t){this.queue.delete(e)}checkQueue(){this.queue.forEach(async e=>{const{topic:t,message:i,opts:n}=e;await this.publish(t,i,n)})}registerEventListeners(){this.relayer.core.heartbeat.on(Or.HEARTBEAT_EVENTS.pulse,()=>{this.checkQueue()})}}class Yg{constructor(){this.map=new Map,this.set=(e,t)=>{const i=this.get(e);this.exists(e,t)||this.map.set(e,[...i,t])},this.get=e=>this.map.get(e)||[],this.exists=(e,t)=>this.get(e).includes(t),this.delete=(e,t)=>{if(typeof t>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const i=this.get(e);if(!this.exists(e,t))return;const n=i.filter(c=>c!==t);if(!n.length){this.map.delete(e);return}this.map.set(e,n)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var Jg=Object.defineProperty,Xg=Object.defineProperties,Zg=Object.getOwnPropertyDescriptors,Ss=Object.getOwnPropertySymbols,Qg=Object.prototype.hasOwnProperty,ep=Object.prototype.propertyIsEnumerable,Os=(r,e,t)=>e in r?Jg(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,qr=(r,e)=>{for(var t in e||(e={}))Qg.call(e,t)&&Os(r,t,e[t]);if(Ss)for(var t of Ss(e))ep.call(e,t)&&Os(r,t,e[t]);return r},bi=(r,e)=>Xg(r,Zg(e));class tp extends $c{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,this.subscriptions=new Map,this.topicMap=new Yg,this.events=new yt.exports.EventEmitter,this.name=Lg,this.version=Mg,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pendingSubInterval=20,this.storagePrefix=Lt,this.subscribeTimeout=1e4,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restart(),this.registerEventListeners(),this.onEnable())},this.subscribe=async(i,n)=>{this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:n}});try{const c=Ui(n),y={topic:i,relay:c};this.pending.set(i,y);const u=await this.rpcSubscribe(i,c);return this.onSubscribe(u,y),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:n}}),u}catch(c){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(c),c}},this.unsubscribe=async(i,n)=>{this.isInitialized(),typeof(n==null?void 0:n.id)<"u"?await this.unsubscribeById(i,n.id,n):await this.unsubscribeByTopic(i,n)},this.isSubscribed=async i=>this.topics.includes(i)?!0:await new Promise((n,c)=>{const y=new ee.Watch;y.start(this.pendingSubscriptionWatchLabel);const u=setInterval(()=>{!this.pending.has(i)&&this.topics.includes(i)&&(clearInterval(u),y.stop(this.pendingSubscriptionWatchLabel),n(!0)),y.elapsed(this.pendingSubscriptionWatchLabel)>=jg&&(clearInterval(u),y.stop(this.pendingSubscriptionWatchLabel),c(!1))},this.pendingSubInterval)}),this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.restart=async()=>{await this.restore(),await this.reset()},this.relayer=e,this.logger=Se.generateChildLogger(t,this.name)}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(e,t){let i=!1;try{i=this.getSubscription(e).topic===t}catch{}return i}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear(),this.initialized=!1}async unsubscribeByTopic(e,t){const i=this.topicMap.get(e);await Promise.all(i.map(async n=>await this.unsubscribeById(e,n,t)))}async unsubscribeById(e,t,i){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:i}});try{const n=Ui(i);await this.rpcUnsubscribe(e,t,n);const c=Je("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,t,c),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:i}})}catch(n){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(n),n}}async rpcSubscribe(e,t){const i={method:Li(t.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});let n;try{n=await await ja(this.relayer.provider.request(i),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(it.connection_stalled)}return n}rpcUnsubscribe(e,t,i){const n={method:Li(i.protocol).unsubscribe,params:{topic:e,id:t}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n}),this.relayer.provider.request(n)}onSubscribe(e,t){this.setSubscription(e,bi(qr({},t),{id:e})),this.pending.delete(t.topic)}onResubscribe(e,t){this.addSubscription(e,bi(qr({},t),{id:e})),this.pending.delete(t.topic)}async onUnsubscribe(e,t,i){this.events.removeAllListeners(t),this.hasSubscription(t,e)&&this.deleteSubscription(t,i),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,t){this.subscriptions.has(e)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:t}),this.addSubscription(e,t))}addSubscription(e,t){this.subscriptions.set(e,qr({},t)),this.topicMap.set(t.topic,e),this.events.emit(Et.created,t)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const t=this.subscriptions.get(e);if(!t){const{message:i}=J("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(i)}return t}deleteSubscription(e,t){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:t});const i=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(i.topic,e),this.events.emit(Et.deleted,bi(qr({},i),{reason:t}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Et.sync)}async reset(){this.cached.length&&await Promise.all(this.cached.map(async e=>await this.resubscribe(e))),this.events.emit(Et.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:t}=J("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async resubscribe(e){if(!this.ids.includes(e.id)){const{topic:t,relay:i}=e,n={topic:t,relay:i};this.pending.set(n.topic,n);const c=await this.rpcSubscribe(n.topic,n.relay);this.onResubscribe(c,n)}}async onConnect(){await this.restart(),this.onEnable()}onDisconnect(){this.onDisable()}checkPending(){this.relayer.transportExplicitlyClosed||this.pending.forEach(async e=>{const t=await this.rpcSubscribe(e.topic,e.relay);this.onSubscribe(t,e)})}registerEventListeners(){this.relayer.core.heartbeat.on(Or.HEARTBEAT_EVENTS.pulse,()=>{this.checkPending()}),this.relayer.on(it.connect,async()=>{await this.onConnect()}),this.relayer.on(it.disconnect,()=>{this.onDisconnect()}),this.events.on(Et.created,async e=>{const t=Et.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()}),this.events.on(Et.deleted,async e=>{const t=Et.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}}var rp=Object.defineProperty,Is=Object.getOwnPropertySymbols,ip=Object.prototype.hasOwnProperty,np=Object.prototype.propertyIsEnumerable,xs=(r,e,t)=>e in r?rp(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,sp=(r,e)=>{for(var t in e||(e={}))ip.call(e,t)&&xs(r,t,e[t]);if(Is)for(var t of Is(e))np.call(e,t)&&xs(r,t,e[t]);return r};class ap extends Mc{constructor(e){super(e),this.protocol="wc",this.version=2,this.events=new yt.exports.EventEmitter,this.name=Cg,this.transportExplicitlyClosed=!1,this.initialized=!1,this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?Se.generateChildLogger(e.logger,this.name):Dr(Se.getDefaultLoggerOptions({level:e.logger||Ag})),this.messages=new Wg(this.logger,e.core),this.subscriber=new tp(this,this.logger),this.publisher=new kg(this,this.logger),this.relayUrl=(e==null?void 0:e.relayUrl)||Ng,this.projectId=e.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),this.provider=await this.createProvider(),await Promise.all([this.messages.init(),this.transportOpen(),this.subscriber.init()]),this.registerEventListeners(),this.initialized=!0}get context(){return Se.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(e,t,i){this.isInitialized(),await this.publisher.publish(e,t,i),await this.recordMessageEvent({topic:e,message:t})}async subscribe(e,t){this.isInitialized();let i="";return await Promise.all([new Promise(n=>{this.subscriber.once(Et.created,c=>{c.topic===e&&n()})}),new Promise(async n=>{i=await this.subscriber.subscribe(e,t),n()})]),i}async unsubscribe(e,t){this.isInitialized(),await this.subscriber.unsubscribe(e,t)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async transportClose(){this.transportExplicitlyClosed=!0,this.connected&&(await this.provider.disconnect(),this.events.emit(it.transport_closed))}async transportOpen(e){this.relayUrl=e||this.relayUrl,this.transportExplicitlyClosed=!1;try{await Promise.all([new Promise(t=>{this.initialized||t(),this.subscriber.once(Et.resubscribed,()=>{t()})}),await Promise.race([this.provider.connect(),new Promise((t,i)=>this.once(it.transport_closed,()=>{i(new Error("closeTransport called before connection was established"))}))])])}catch(t){const i=t;if(!/socket hang up/i.test(i.message))throw new Error(i.message);this.logger.error(i),this.events.emit(it.transport_closed)}}async restartTransport(e){await this.transportClose(),await new Promise(t=>setTimeout(t,Ds)),await this.transportOpen(e)}async createProvider(){const e=await this.core.crypto.signJWT(this.relayUrl);return new Er(new Wf(sf({sdkVersion:Fg,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e})))}async recordMessageEvent(e){const{topic:t,message:i}=e;await this.messages.set(t,i)}async shouldIgnoreMessageEvent(e){const{topic:t,message:i}=e;return await this.subscriber.isSubscribed(t)?this.messages.has(t,i):!0}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),qi(e)){if(!e.method.endsWith(Rg))return;const t=e.params,{topic:i,message:n}=t.data,c={topic:i,message:n};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(sp({type:"event",event:t.id},c)),this.events.emit(t.id,c),await this.acknowledgePayload(e),await this.onMessageEvent(c)}}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(this.events.emit(it.message,e),await this.recordMessageEvent(e))}async acknowledgePayload(e){const t=Bi(e.id,!0);await this.provider.connection.send(t)}registerEventListeners(){this.provider.on(Hr.payload,e=>this.onProviderPayload(e)),this.provider.on(Hr.connect,()=>{this.events.emit(it.connect)}),this.provider.on(Hr.disconnect,()=>{this.events.emit(it.disconnect),this.attemptToReconnect()}),this.provider.on(Hr.error,e=>this.events.emit(it.error,e)),this.events.on(it.connection_stalled,async()=>{await this.restartTransport()})}attemptToReconnect(){this.transportExplicitlyClosed||setTimeout(async()=>{await this.transportOpen()},ee.toMiliseconds(Ds))}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}}var op=Object.defineProperty,Ts=Object.getOwnPropertySymbols,cp=Object.prototype.hasOwnProperty,up=Object.prototype.propertyIsEnumerable,Ps=(r,e,t)=>e in r?op(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,As=(r,e)=>{for(var t in e||(e={}))cp.call(e,t)&&Ps(r,t,e[t]);if(Ts)for(var t of Ts(e))up.call(e,t)&&Ps(r,t,e[t]);return r};class ai extends jc{constructor(e,t,i,n=Lt,c=void 0){super(e,t,i,n),this.core=e,this.logger=t,this.name=i,this.map=new Map,this.version=Ug,this.cached=[],this.initialized=!1,this.storagePrefix=Lt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(y=>{If(y)?this.map.set(y.id,y):xf(y)?this.map.set(y.topic,y):this.getKey&&y!==null&&!pt(y)&&this.map.set(this.getKey(y),y)}),this.cached=[],this.initialized=!0)},this.set=async(y,u)=>{this.isInitialized(),this.map.has(y)?await this.update(y,u):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:y,value:u}),this.map.set(y,u),await this.persist())},this.get=y=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:y}),this.getData(y)),this.getAll=y=>(this.isInitialized(),y?this.values.filter(u=>Object.keys(y).every(g=>kf(u[g],y[g]))):this.values),this.update=async(y,u)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:y,update:u});const g=As(As({},this.getData(y)),u);this.map.set(y,g),await this.persist()},this.delete=async(y,u)=>{this.isInitialized(),this.map.has(y)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:y,reason:u}),this.map.delete(y),await this.persist())},this.logger=Se.generateChildLogger(t,this.name),this.storagePrefix=n,this.getKey=c}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const t=this.map.get(e);if(!t){const{message:i}=J("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(i),new Error(i)}return t}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:t}=J("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}}class hp{constructor(e,t){this.core=e,this.logger=t,this.name=$g,this.version=zg,this.events=new yt.exports,this.initialized=!1,this.storagePrefix=Lt,this.ignoredPayloadTypes=[Jt],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:i})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...i])]},this.create=async()=>{this.isInitialized();const i=Ri(),n=await this.core.crypto.setSymKey(i),c=Dt(ee.FIVE_MINUTES),y={protocol:eo},u={topic:n,expiry:c,relay:y,active:!1},g=yf({protocol:this.core.protocol,version:this.core.version,topic:n,symKey:i,relay:y});return await this.pairings.set(n,u),await this.core.relayer.subscribe(n),this.core.expirer.set(n,c),{topic:n,uri:g}},this.pair=async i=>{this.isInitialized(),this.isValidPair(i);const{topic:n,symKey:c,relay:y}=gf(i.uri),u=Dt(ee.FIVE_MINUTES),g={topic:n,relay:y,expiry:u,active:!1};return await this.pairings.set(n,g),await this.core.crypto.setSymKey(c,n),await this.core.relayer.subscribe(n,{relay:y}),this.core.expirer.set(n,u),i.activatePairing&&await this.activate({topic:n}),g},this.activate=async({topic:i})=>{this.isInitialized();const n=Dt(ee.THIRTY_DAYS);await this.pairings.update(i,{active:!0,expiry:n}),this.core.expirer.set(i,n)},this.ping=async i=>{this.isInitialized(),await this.isValidPing(i);const{topic:n}=i;if(this.pairings.keys.includes(n)){const c=await this.sendRequest(n,"wc_pairingPing",{}),{done:y,resolve:u,reject:g}=Wt();this.events.once(Ue("pairing_ping",c),({error:O})=>{O?g(O):u()}),await y()}},this.updateExpiry=async({topic:i,expiry:n})=>{this.isInitialized(),await this.pairings.update(i,{expiry:n})},this.updateMetadata=async({topic:i,metadata:n})=>{this.isInitialized(),await this.pairings.update(i,{peerMetadata:n})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async i=>{this.isInitialized(),await this.isValidDisconnect(i);const{topic:n}=i;this.pairings.keys.includes(n)&&(await this.sendRequest(n,"wc_pairingDelete",Je("USER_DISCONNECTED")),await this.deletePairing(n))},this.sendRequest=async(i,n,c)=>{const y=Ki(n,c),u=await this.core.crypto.encode(i,y),g=yr[n].req;return this.core.history.set(i,y),await this.core.relayer.publish(i,u,g),y.id},this.sendResult=async(i,n,c)=>{const y=Bi(i,c),u=await this.core.crypto.encode(n,y),g=await this.core.history.get(n,i),O=yr[g.request.method].res;await this.core.relayer.publish(n,u,O),await this.core.history.resolve(y)},this.sendError=async(i,n,c)=>{const y=Hi(i,c),u=await this.core.crypto.encode(n,y),g=await this.core.history.get(n,i),O=yr[g.request.method]?yr[g.request.method].res:yr.unregistered_method.res;await this.core.relayer.publish(n,u,O),await this.core.history.resolve(y)},this.deletePairing=async(i,n)=>{await this.core.relayer.unsubscribe(i),await Promise.all([this.pairings.delete(i,Je("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(i),n?Promise.resolve():this.core.expirer.del(i)])},this.cleanup=async()=>{const i=this.pairings.getAll().filter(n=>Ft(n.expiry));await Promise.all(i.map(n=>this.deletePairing(n.topic)))},this.onRelayEventRequest=i=>{const{topic:n,payload:c}=i,y=c.method;if(this.pairings.keys.includes(n))switch(y){case"wc_pairingPing":return this.onPairingPingRequest(n,c);case"wc_pairingDelete":return this.onPairingDeleteRequest(n,c);default:return this.onUnknownRpcMethodRequest(n,c)}},this.onRelayEventResponse=async i=>{const{topic:n,payload:c}=i,y=(await this.core.history.get(n,c.id)).request.method;if(this.pairings.keys.includes(n))switch(y){case"wc_pairingPing":return this.onPairingPingResponse(n,c);default:return this.onUnknownRpcMethodResponse(y)}},this.onPairingPingRequest=async(i,n)=>{const{id:c}=n;try{this.isValidPing({topic:i}),await this.sendResult(c,i,!0),this.events.emit("pairing_ping",{id:c,topic:i})}catch(y){await this.sendError(c,i,y),this.logger.error(y)}},this.onPairingPingResponse=(i,n)=>{const{id:c}=n;setTimeout(()=>{Rt(n)?this.events.emit(Ue("pairing_ping",c),{}):Tt(n)&&this.events.emit(Ue("pairing_ping",c),{error:n.error})},500)},this.onPairingDeleteRequest=async(i,n)=>{const{id:c}=n;try{this.isValidDisconnect({topic:i}),await this.sendResult(c,i,!0),await this.deletePairing(i),this.events.emit("pairing_delete",{id:c,topic:i})}catch(y){await this.sendError(c,i,y),this.logger.error(y)}},this.onUnknownRpcMethodRequest=async(i,n)=>{const{id:c,method:y}=n;try{if(this.registeredMethods.includes(y))return;const u=Je("WC_METHOD_UNSUPPORTED",y);await this.sendError(c,i,u),this.logger.error(u)}catch(u){await this.sendError(c,i,u),this.logger.error(u)}},this.onUnknownRpcMethodResponse=i=>{this.registeredMethods.includes(i)||this.logger.error(Je("WC_METHOD_UNSUPPORTED",i))},this.isValidPair=i=>{if(!st(i)){const{message:n}=J("MISSING_OR_INVALID",`pair() params: ${i}`);throw new Error(n)}if(!Of(i.uri)){const{message:n}=J("MISSING_OR_INVALID",`pair() uri: ${i.uri}`);throw new Error(n)}},this.isValidPing=async i=>{if(!st(i)){const{message:c}=J("MISSING_OR_INVALID",`ping() params: ${i}`);throw new Error(c)}const{topic:n}=i;await this.isValidPairingTopic(n)},this.isValidDisconnect=async i=>{if(!st(i)){const{message:c}=J("MISSING_OR_INVALID",`disconnect() params: ${i}`);throw new Error(c)}const{topic:n}=i;await this.isValidPairingTopic(n)},this.isValidPairingTopic=async i=>{if(!Ze(i,!1)){const{message:n}=J("MISSING_OR_INVALID",`pairing topic should be a string: ${i}`);throw new Error(n)}if(!this.pairings.keys.includes(i)){const{message:n}=J("NO_MATCHING_KEY",`pairing topic doesn't exist: ${i}`);throw new Error(n)}if(Ft(this.pairings.get(i).expiry)){await this.deletePairing(i);const{message:n}=J("EXPIRED",`pairing topic: ${i}`);throw new Error(n)}},this.core=e,this.logger=Se.generateChildLogger(t,this.name),this.pairings=new ai(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Se.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(it.message,async e=>{const{topic:t,message:i}=e;if(this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(i)))return;const n=await this.core.crypto.decode(t,i);qi(n)?(this.core.history.set(t,n),this.onRelayEventRequest({topic:t,payload:n})):Gs(n)&&(await this.core.history.resolve(n),this.onRelayEventResponse({topic:t,payload:n}))})}registerExpirerEvents(){this.core.expirer.on(gt.expired,async e=>{const{topic:t}=za(e.target);t&&this.pairings.keys.includes(t)&&(await this.deletePairing(t,!0),this.events.emit("pairing_expire",{topic:t}))})}}class lp extends Fc{constructor(e,t){super(e,t),this.core=e,this.logger=t,this.records=new Map,this.events=new yt.exports.EventEmitter,this.name=Hg,this.version=qg,this.cached=[],this.initialized=!1,this.storagePrefix=Lt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(i=>this.records.set(i.id,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(i,n,c)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:i,request:n,chainId:c}),this.records.has(n.id))return;const y={id:n.id,topic:i,request:{method:n.method,params:n.params||null},chainId:c};this.records.set(y.id,y),this.events.emit(vt.created,y)},this.resolve=async i=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:i}),!this.records.has(i.id))return;const n=await this.getRecord(i.id);typeof n.response>"u"&&(n.response=Tt(i)?{error:i.error}:{result:i.result},this.records.set(n.id,n),this.events.emit(vt.updated,n))},this.get=async(i,n)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:i,id:n}),await this.getRecord(n)),this.delete=(i,n)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:n}),this.values.forEach(c=>{if(c.topic===i){if(typeof n<"u"&&c.id!==n)return;this.records.delete(c.id),this.events.emit(vt.deleted,c)}})},this.exists=async(i,n)=>(this.isInitialized(),this.records.has(n)?(await this.getRecord(n)).topic===i:!1),this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.logger=Se.generateChildLogger(t,this.name)}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(t=>{if(typeof t.response<"u")return;const i={topic:t.topic,request:Ki(t.request.method,t.request.params,t.id),chainId:t.chainId};return e.push(i)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const t=this.records.get(e);if(!t){const{message:i}=J("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(i)}return t}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(vt.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:t}=J("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(vt.created,e=>{const t=vt.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()}),this.events.on(vt.updated,e=>{const t=vt.updated;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()}),this.events.on(vt.deleted,e=>{const t=vt.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}}class fp extends zc{constructor(e,t){super(e,t),this.core=e,this.logger=t,this.expirations=new Map,this.events=new yt.exports.EventEmitter,this.name=Bg,this.version=Kg,this.cached=[],this.initialized=!1,this.storagePrefix=Lt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(i=>this.expirations.set(i.target,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=i=>{try{const n=this.formatTarget(i);return typeof this.getExpiration(n)<"u"}catch{return!1}},this.set=(i,n)=>{this.isInitialized();const c=this.formatTarget(i),y={target:c,expiry:n};this.expirations.set(c,y),this.checkExpiry(c,y),this.events.emit(gt.created,{target:c,expiration:y})},this.get=i=>{this.isInitialized();const n=this.formatTarget(i);return this.getExpiration(n)},this.del=i=>{if(this.isInitialized(),this.has(i)){const n=this.formatTarget(i),c=this.getExpiration(n);this.expirations.delete(n),this.events.emit(gt.deleted,{target:n,expiration:c})}},this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.logger=Se.generateChildLogger(t,this.name)}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return af(e);if(typeof e=="number")return of(e);const{message:t}=J("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(t)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(gt.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:t}=J("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const t=this.expirations.get(e);if(!t){const{message:i}=J("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(i),new Error(i)}return t}checkExpiry(e,t){const{expiry:i}=t;ee.toMiliseconds(i)-Date.now()<=0&&this.expire(e,t)}expire(e,t){this.expirations.delete(e),this.events.emit(gt.expired,{target:e,expiration:t})}checkExpirations(){this.expirations.forEach((e,t)=>this.checkExpiry(t,e))}registerEventListeners(){this.core.heartbeat.on(Or.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(gt.created,e=>{const t=gt.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(gt.expired,e=>{const t=gt.expired;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(gt.deleted,e=>{const t=gt.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}}var dp=Object.defineProperty,Ns=Object.getOwnPropertySymbols,gp=Object.prototype.hasOwnProperty,pp=Object.prototype.propertyIsEnumerable,Cs=(r,e,t)=>e in r?dp(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Rs=(r,e)=>{for(var t in e||(e={}))gp.call(e,t)&&Cs(r,t,e[t]);if(Ns)for(var t of Ns(e))pp.call(e,t)&&Cs(r,t,e[t]);return r};class sn extends Rc{constructor(e){super(e),this.protocol=Qa,this.version=wg,this.name=nn,this.events=new yt.exports.EventEmitter,this.initialized=!1,this.on=(i,n)=>this.events.on(i,n),this.once=(i,n)=>this.events.once(i,n),this.off=(i,n)=>this.events.off(i,n),this.removeListener=(i,n)=>this.events.removeListener(i,n),this.projectId=e==null?void 0:e.projectId;const t=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:Dr(Se.getDefaultLoggerOptions({level:(e==null?void 0:e.logger)||mg.logger}));this.logger=Se.generateChildLogger(t,this.name),this.heartbeat=new Or.HeartBeat,this.crypto=new Gg(this,this.logger,e==null?void 0:e.keychain),this.history=new lp(this,this.logger),this.expirer=new fp(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new bc(Rs(Rs({},vg),e==null?void 0:e.storageOptions)),this.relayer=new ap({core:this,logger:this.logger,relayUrl:e==null?void 0:e.relayUrl,projectId:this.projectId}),this.pairing=new hp(this,this.logger)}static async init(e){const t=new sn(e);return await t.initialize(),t}get context(){return Se.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}}const yp=sn,to="wc",ro=2,io="client",an=`${to}@${ro}:${io}:`,wi={name:io,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},_p="proposal",bp="session",Br=ee.SEVEN_DAYS,wp="engine",_r={wc_sessionPropose:{req:{ttl:ee.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:ee.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:ee.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:ee.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:ee.ONE_DAY,prompt:!1,tag:1104},res:{ttl:ee.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:ee.ONE_DAY,prompt:!1,tag:1106},res:{ttl:ee.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:ee.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:ee.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:ee.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:ee.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:ee.ONE_DAY,prompt:!1,tag:1112},res:{ttl:ee.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:ee.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:ee.THIRTY_SECONDS,prompt:!1,tag:1115}}},mi={min:ee.FIVE_MINUTES,max:ee.SEVEN_DAYS},mp="request";var vp=Object.defineProperty,Ep=Object.defineProperties,Dp=Object.getOwnPropertyDescriptors,Fs=Object.getOwnPropertySymbols,Sp=Object.prototype.hasOwnProperty,Op=Object.prototype.propertyIsEnumerable,Us=(r,e,t)=>e in r?vp(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,xt=(r,e)=>{for(var t in e||(e={}))Sp.call(e,t)&&Us(r,t,e[t]);if(Fs)for(var t of Fs(e))Op.call(e,t)&&Us(r,t,e[t]);return r},vi=(r,e)=>Ep(r,Dp(e));class Ip extends qc{constructor(e){super(e),this.name=wp,this.events=new yt.exports,this.initialized=!1,this.ignoredPayloadTypes=[Jt],this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.client.core.pairing.register({methods:Object.keys(_r)}),this.initialized=!0)},this.connect=async t=>{this.isInitialized(),await this.isValidConnect(t);const{pairingTopic:i,requiredNamespaces:n,relays:c}=t;let y=i,u,g=!1;if(y&&(g=this.client.core.pairing.pairings.get(y).active),!y||!g){const{topic:M,uri:B}=await this.client.core.pairing.create();y=M,u=B}const O=await this.client.core.crypto.generateKeyPair(),S={requiredNamespaces:n,relays:c!=null?c:[{protocol:eo}],proposer:{publicKey:O,metadata:this.client.metadata}},{reject:A,resolve:z,done:N}=Wt();if(this.events.once(Ue("session_connect"),async({error:M,session:B})=>{if(M)A(M);else if(B){B.self.publicKey=O;const _=vi(xt({},B),{requiredNamespaces:B.requiredNamespaces});await this.client.session.set(B.topic,_),await this.setExpiry(B.topic,B.expiry),y&&await this.client.core.pairing.updateMetadata({topic:y,metadata:B.peer.metadata}),z(_)}}),!y){const{message:M}=J("NO_MATCHING_KEY",`connect() pairing topic: ${y}`);throw new Error(M)}const P=await this.sendRequest(y,"wc_sessionPropose",S),q=Dt(ee.FIVE_MINUTES);return await this.setProposal(P,xt({id:P,expiry:q},S)),{uri:u,approval:N}},this.pair=async t=>(this.isInitialized(),await this.client.core.pairing.pair(t)),this.approve=async t=>{this.isInitialized(),await this.isValidApprove(t);const{id:i,relayProtocol:n,namespaces:c}=t,y=this.client.proposal.get(i);let{pairingTopic:u,proposer:g,requiredNamespaces:O}=y;kr(O)||(O=mf(c,"approve()"),this.client.proposal.set(i,vi(xt({},y),{requiredNamespaces:O})));const S=await this.client.core.crypto.generateKeyPair(),A=g.publicKey,z=await this.client.core.crypto.generateSharedKey(S,A),N={relay:{protocol:n!=null?n:"irn"},namespaces:c,requiredNamespaces:O,controller:{publicKey:S,metadata:this.client.metadata},expiry:Dt(Br)};await this.client.core.relayer.subscribe(z);const P=await this.sendRequest(z,"wc_sessionSettle",N),{done:q,resolve:M,reject:B}=Wt();this.events.once(Ue("session_approve",P),({error:E})=>{E?B(E):M(this.client.session.get(z))});const _=vi(xt({},N),{topic:z,acknowledged:!1,self:N.controller,peer:{publicKey:g.publicKey,metadata:g.metadata},controller:S});return await this.client.session.set(z,_),await this.setExpiry(z,Dt(Br)),u&&await this.client.core.pairing.updateMetadata({topic:u,metadata:_.peer.metadata}),u&&i&&(await this.sendResult(i,u,{relay:{protocol:n!=null?n:"irn"},responderPublicKey:S}),await this.client.proposal.delete(i,Je("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:u})),{topic:z,acknowledged:q}},this.reject=async t=>{this.isInitialized(),await this.isValidReject(t);const{id:i,reason:n}=t,{pairingTopic:c}=this.client.proposal.get(i);c&&(await this.sendError(i,c,n),await this.client.proposal.delete(i,Je("USER_DISCONNECTED")))},this.update=async t=>{this.isInitialized(),await this.isValidUpdate(t);const{topic:i,namespaces:n}=t,c=await this.sendRequest(i,"wc_sessionUpdate",{namespaces:n}),{done:y,resolve:u,reject:g}=Wt();return this.events.once(Ue("session_update",c),({error:O})=>{O?g(O):u()}),await this.client.session.update(i,{namespaces:n}),{acknowledged:y}},this.extend=async t=>{this.isInitialized(),await this.isValidExtend(t);const{topic:i}=t,n=await this.sendRequest(i,"wc_sessionExtend",{}),{done:c,resolve:y,reject:u}=Wt();return this.events.once(Ue("session_extend",n),({error:g})=>{g?u(g):y()}),await this.setExpiry(i,Dt(Br)),{acknowledged:c}},this.request=async t=>{this.isInitialized(),await this.isValidRequest(t);const{chainId:i,request:n,topic:c,expiry:y}=t,u=await this.sendRequest(c,"wc_sessionRequest",{request:n,chainId:i},y),{done:g,resolve:O,reject:S}=Wt(y);return this.events.once(Ue("session_request",u),({error:A,result:z})=>{A?S(A):O(z)}),await g()},this.respond=async t=>{this.isInitialized(),await this.isValidRespond(t);const{topic:i,response:n}=t,{id:c}=n;Rt(n)?await this.sendResult(c,i,n.result):Tt(n)&&await this.sendError(c,i,n.error),this.deletePendingSessionRequest(t.response.id,{message:"fulfilled",code:0})},this.ping=async t=>{this.isInitialized(),await this.isValidPing(t);const{topic:i}=t;if(this.client.session.keys.includes(i)){const n=await this.sendRequest(i,"wc_sessionPing",{}),{done:c,resolve:y,reject:u}=Wt();this.events.once(Ue("session_ping",n),({error:g})=>{g?u(g):y()}),await c()}else this.client.core.pairing.pairings.keys.includes(i)&&await this.client.core.pairing.ping({topic:i})},this.emit=async t=>{this.isInitialized(),await this.isValidEmit(t);const{topic:i,event:n,chainId:c}=t;await this.sendRequest(i,"wc_sessionEvent",{event:n,chainId:c})},this.disconnect=async t=>{this.isInitialized(),await this.isValidDisconnect(t);const{topic:i}=t;this.client.session.keys.includes(i)?(await this.sendRequest(i,"wc_sessionDelete",Je("USER_DISCONNECTED")),await this.deleteSession(i)):await this.client.core.pairing.disconnect({topic:i})},this.find=t=>(this.isInitialized(),this.client.session.getAll().filter(i=>Df(i,t))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.deleteSession=async(t,i)=>{const{self:n}=this.client.session.get(t);await this.client.core.relayer.unsubscribe(t),await Promise.all([this.client.session.delete(t,Je("USER_DISCONNECTED")),this.client.core.crypto.deleteKeyPair(n.publicKey),this.client.core.crypto.deleteSymKey(t),i?Promise.resolve():this.client.core.expirer.del(t)])},this.deleteProposal=async(t,i)=>{await Promise.all([this.client.proposal.delete(t,Je("USER_DISCONNECTED")),i?Promise.resolve():this.client.core.expirer.del(t)])},this.deletePendingSessionRequest=async(t,i,n=!1)=>{await Promise.all([this.client.pendingRequest.delete(t,i),n?Promise.resolve():this.client.core.expirer.del(t)])},this.setExpiry=async(t,i)=>{this.client.session.keys.includes(t)&&await this.client.session.update(t,{expiry:i}),this.client.core.expirer.set(t,i)},this.setProposal=async(t,i)=>{await this.client.proposal.set(t,i),this.client.core.expirer.set(t,i.expiry)},this.setPendingSessionRequest=async t=>{const i=_r.wc_sessionRequest.req.ttl,{id:n,topic:c,params:y}=t;await this.client.pendingRequest.set(n,{id:n,topic:c,params:y}),i&&this.client.core.expirer.set(n,Dt(i))},this.sendRequest=async(t,i,n,c)=>{const y=Ki(i,n),u=await this.client.core.crypto.encode(t,y),g=_r[i].req;return c&&(g.ttl=c),this.client.core.history.set(t,y),this.client.core.relayer.publish(t,u,g),y.id},this.sendResult=async(t,i,n)=>{const c=Bi(t,n),y=await this.client.core.crypto.encode(i,c),u=await this.client.core.history.get(i,t),g=_r[u.request.method].res;this.client.core.relayer.publish(i,y,g),await this.client.core.history.resolve(c)},this.sendError=async(t,i,n)=>{const c=Hi(t,n),y=await this.client.core.crypto.encode(i,c),u=await this.client.core.history.get(i,t),g=_r[u.request.method].res;this.client.core.relayer.publish(i,y,g),await this.client.core.history.resolve(c)},this.cleanup=async()=>{const t=[],i=[];this.client.session.getAll().forEach(n=>{Ft(n.expiry)&&t.push(n.topic)}),this.client.proposal.getAll().forEach(n=>{Ft(n.expiry)&&i.push(n.id)}),await Promise.all([...t.map(n=>this.deleteSession(n)),...i.map(n=>this.deleteProposal(n))])},this.onRelayEventRequest=t=>{const{topic:i,payload:n}=t,c=n.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeRequest(i,n);case"wc_sessionSettle":return this.onSessionSettleRequest(i,n);case"wc_sessionUpdate":return this.onSessionUpdateRequest(i,n);case"wc_sessionExtend":return this.onSessionExtendRequest(i,n);case"wc_sessionPing":return this.onSessionPingRequest(i,n);case"wc_sessionDelete":return this.onSessionDeleteRequest(i,n);case"wc_sessionRequest":return this.onSessionRequest(i,n);case"wc_sessionEvent":return this.onSessionEventRequest(i,n);default:return this.client.logger.info(`Unsupported request method ${c}`)}},this.onRelayEventResponse=async t=>{const{topic:i,payload:n}=t,c=(await this.client.core.history.get(i,n.id)).request.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeResponse(i,n);case"wc_sessionSettle":return this.onSessionSettleResponse(i,n);case"wc_sessionUpdate":return this.onSessionUpdateResponse(i,n);case"wc_sessionExtend":return this.onSessionExtendResponse(i,n);case"wc_sessionPing":return this.onSessionPingResponse(i,n);case"wc_sessionRequest":return this.onSessionRequestResponse(i,n);default:return this.client.logger.info(`Unsupported response method ${c}`)}},this.onSessionProposeRequest=async(t,i)=>{const{params:n,id:c}=i;try{this.isValidConnect(xt({},i.params));const y=Dt(ee.FIVE_MINUTES),u=xt({id:c,pairingTopic:t,expiry:y},n);await this.setProposal(c,u),this.client.events.emit("session_proposal",{id:c,params:u})}catch(y){await this.sendError(c,t,y),this.client.logger.error(y)}},this.onSessionProposeResponse=async(t,i)=>{const{id:n}=i;if(Rt(i)){const{result:c}=i;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:c});const y=this.client.proposal.get(n);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:y});const u=y.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:u});const g=c.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:g});const O=await this.client.core.crypto.generateSharedKey(u,g);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:O});const S=await this.client.core.relayer.subscribe(O);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:S}),await this.client.core.pairing.activate({topic:t})}else Tt(i)&&(await this.client.proposal.delete(n,Je("USER_DISCONNECTED")),this.events.emit(Ue("session_connect"),{error:i.error}))},this.onSessionSettleRequest=async(t,i)=>{const{id:n,params:c}=i;try{this.isValidSessionSettleRequest(c);const{relay:y,controller:u,expiry:g,namespaces:O,requiredNamespaces:S}=i.params,A={topic:t,relay:y,expiry:g,namespaces:O,acknowledged:!0,requiredNamespaces:S,controller:u.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:u.publicKey,metadata:u.metadata}};await this.sendResult(i.id,t,!0),this.events.emit(Ue("session_connect"),{session:A})}catch(y){await this.sendError(n,t,y),this.client.logger.error(y)}},this.onSessionSettleResponse=async(t,i)=>{const{id:n}=i;Rt(i)?(await this.client.session.update(t,{acknowledged:!0}),this.events.emit(Ue("session_approve",n),{})):Tt(i)&&(await this.client.session.delete(t,Je("USER_DISCONNECTED")),this.events.emit(Ue("session_approve",n),{error:i.error}))},this.onSessionUpdateRequest=async(t,i)=>{const{params:n,id:c}=i;try{this.isValidUpdate(xt({topic:t},n)),await this.client.session.update(t,{namespaces:n.namespaces}),await this.sendResult(c,t,!0),this.client.events.emit("session_update",{id:c,topic:t,params:n})}catch(y){await this.sendError(c,t,y),this.client.logger.error(y)}},this.onSessionUpdateResponse=(t,i)=>{const{id:n}=i;Rt(i)?this.events.emit(Ue("session_update",n),{}):Tt(i)&&this.events.emit(Ue("session_update",n),{error:i.error})},this.onSessionExtendRequest=async(t,i)=>{const{id:n}=i;try{this.isValidExtend({topic:t}),await this.setExpiry(t,Dt(Br)),await this.sendResult(n,t,!0),this.client.events.emit("session_extend",{id:n,topic:t})}catch(c){await this.sendError(n,t,c),this.client.logger.error(c)}},this.onSessionExtendResponse=(t,i)=>{const{id:n}=i;Rt(i)?this.events.emit(Ue("session_extend",n),{}):Tt(i)&&this.events.emit(Ue("session_extend",n),{error:i.error})},this.onSessionPingRequest=async(t,i)=>{const{id:n}=i;try{this.isValidPing({topic:t}),await this.sendResult(n,t,!0),this.client.events.emit("session_ping",{id:n,topic:t})}catch(c){await this.sendError(n,t,c),this.client.logger.error(c)}},this.onSessionPingResponse=(t,i)=>{const{id:n}=i;setTimeout(()=>{Rt(i)?this.events.emit(Ue("session_ping",n),{}):Tt(i)&&this.events.emit(Ue("session_ping",n),{error:i.error})},500)},this.onSessionDeleteRequest=async(t,i)=>{const{id:n}=i;try{this.isValidDisconnect({topic:t,reason:i.params}),this.client.core.relayer.once(it.publish,async()=>{await this.deleteSession(t)}),await this.sendResult(n,t,!0),this.client.events.emit("session_delete",{id:n,topic:t})}catch(c){await this.sendError(n,t,c),this.client.logger.error(c)}},this.onSessionRequest=async(t,i)=>{const{id:n,params:c}=i;try{this.isValidRequest(xt({topic:t},c)),await this.setPendingSessionRequest({id:n,topic:t,params:c}),this.client.events.emit("session_request",{id:n,topic:t,params:c})}catch(y){await this.sendError(n,t,y),this.client.logger.error(y)}},this.onSessionRequestResponse=(t,i)=>{const{id:n}=i;Rt(i)?this.events.emit(Ue("session_request",n),{result:i.result}):Tt(i)&&this.events.emit(Ue("session_request",n),{error:i.error})},this.onSessionEventRequest=async(t,i)=>{const{id:n,params:c}=i;try{this.isValidEmit(xt({topic:t},c)),this.client.events.emit("session_event",{id:n,topic:t,params:c})}catch(y){await this.sendError(n,t,y),this.client.logger.error(y)}},this.isValidConnect=async t=>{if(!st(t)){const{message:u}=J("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(t)}`);throw new Error(u)}const{pairingTopic:i,requiredNamespaces:n,relays:c}=t;if(pt(i)||await this.isValidPairingTopic(i),!pt(n)&&kr(n)===0)return;const y=Ff(n,"connect()");if(y)throw new Error(y.message);if(!Uf(c,!0)){const{message:u}=J("MISSING_OR_INVALID",`connect() relays: ${c}`);throw new Error(u)}},this.isValidApprove=async t=>{if(!st(t))throw new Error(J("MISSING_OR_INVALID",`approve() params: ${t}`).message);const{id:i,namespaces:n,relayProtocol:c}=t;await this.isValidProposalId(i);const y=this.client.proposal.get(i),u=Kr(n,"approve()");if(u)throw new Error(u.message);const g=gs(y.requiredNamespaces,n,"update()");if(g)throw new Error(g.message);if(!Ze(c,!0)){const{message:O}=J("MISSING_OR_INVALID",`approve() relayProtocol: ${c}`);throw new Error(O)}},this.isValidReject=async t=>{if(!st(t)){const{message:c}=J("MISSING_OR_INVALID",`reject() params: ${t}`);throw new Error(c)}const{id:i,reason:n}=t;if(await this.isValidProposalId(i),!Mf(n)){const{message:c}=J("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(n)}`);throw new Error(c)}},this.isValidSessionSettleRequest=t=>{if(!st(t)){const{message:O}=J("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${t}`);throw new Error(O)}const{relay:i,controller:n,namespaces:c,expiry:y}=t;if(!qa(i)){const{message:O}=J("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(O)}const u=Tf(n,"onSessionSettleRequest()");if(u)throw new Error(u.message);const g=Kr(c,"onSessionSettleRequest()");if(g)throw new Error(g.message);if(Ft(y)){const{message:O}=J("EXPIRED","onSessionSettleRequest()");throw new Error(O)}},this.isValidUpdate=async t=>{if(!st(t)){const{message:g}=J("MISSING_OR_INVALID",`update() params: ${t}`);throw new Error(g)}const{topic:i,namespaces:n}=t;await this.isValidSessionTopic(i);const c=this.client.session.get(i),y=Kr(n,"update()");if(y)throw new Error(y.message);const u=gs(c.requiredNamespaces,n,"update()");if(u)throw new Error(u.message)},this.isValidExtend=async t=>{if(!st(t)){const{message:n}=J("MISSING_OR_INVALID",`extend() params: ${t}`);throw new Error(n)}const{topic:i}=t;await this.isValidSessionTopic(i)},this.isValidRequest=async t=>{if(!st(t)){const{message:g}=J("MISSING_OR_INVALID",`request() params: ${t}`);throw new Error(g)}const{topic:i,request:n,chainId:c,expiry:y}=t;await this.isValidSessionTopic(i);const{namespaces:u}=this.client.session.get(i);if(!ds(u,c)){const{message:g}=J("MISSING_OR_INVALID",`request() chainId: ${c}`);throw new Error(g)}if(!jf(n)){const{message:g}=J("MISSING_OR_INVALID",`request() ${JSON.stringify(n)}`);throw new Error(g)}if(!Hf(u,c,n.method)){const{message:g}=J("MISSING_OR_INVALID",`request() method: ${n.method}`);throw new Error(g)}if(y&&!Bf(y,mi)){const{message:g}=J("MISSING_OR_INVALID",`request() expiry: ${y}. Expiry must be a number (in seconds) between ${mi.min} and ${mi.max}`);throw new Error(g)}},this.isValidRespond=async t=>{if(!st(t)){const{message:c}=J("MISSING_OR_INVALID",`respond() params: ${t}`);throw new Error(c)}const{topic:i,response:n}=t;if(await this.isValidSessionTopic(i),!$f(n)){const{message:c}=J("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(n)}`);throw new Error(c)}},this.isValidPing=async t=>{if(!st(t)){const{message:n}=J("MISSING_OR_INVALID",`ping() params: ${t}`);throw new Error(n)}const{topic:i}=t;await this.isValidSessionOrPairingTopic(i)},this.isValidEmit=async t=>{if(!st(t)){const{message:u}=J("MISSING_OR_INVALID",`emit() params: ${t}`);throw new Error(u)}const{topic:i,event:n,chainId:c}=t;await this.isValidSessionTopic(i);const{namespaces:y}=this.client.session.get(i);if(!ds(y,c)){const{message:u}=J("MISSING_OR_INVALID",`emit() chainId: ${c}`);throw new Error(u)}if(!zf(n)){const{message:u}=J("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(n)}`);throw new Error(u)}if(!qf(y,c,n.name)){const{message:u}=J("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(n)}`);throw new Error(u)}},this.isValidDisconnect=async t=>{if(!st(t)){const{message:n}=J("MISSING_OR_INVALID",`disconnect() params: ${t}`);throw new Error(n)}const{topic:i}=t;await this.isValidSessionOrPairingTopic(i)}}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.client.core.relayer.on(it.message,async e=>{const{topic:t,message:i}=e;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(i)))return;const n=await this.client.core.crypto.decode(t,i);qi(n)?(this.client.core.history.set(t,n),this.onRelayEventRequest({topic:t,payload:n})):Gs(n)&&(await this.client.core.history.resolve(n),this.onRelayEventResponse({topic:t,payload:n}))})}registerExpirerEvents(){this.client.core.expirer.on(gt.expired,async e=>{const{topic:t,id:i}=za(e.target);if(i&&this.client.pendingRequest.keys.includes(i))return await this.deletePendingSessionRequest(i,J("EXPIRED"),!0);t?this.client.session.keys.includes(t)&&(await this.deleteSession(t,!0),this.client.events.emit("session_expire",{topic:t})):i&&(await this.deleteProposal(i,!0),this.client.events.emit("proposal_expire",{id:i}))})}isValidPairingTopic(e){if(!Ze(e,!1)){const{message:t}=J("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(t)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:t}=J("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(t)}if(Ft(this.client.core.pairing.pairings.get(e).expiry)){const{message:t}=J("EXPIRED",`pairing topic: ${e}`);throw new Error(t)}}async isValidSessionTopic(e){if(!Ze(e,!1)){const{message:t}=J("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(t)}if(!this.client.session.keys.includes(e)){const{message:t}=J("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(t)}if(Ft(this.client.session.get(e).expiry)){await this.deleteSession(e);const{message:t}=J("EXPIRED",`session topic: ${e}`);throw new Error(t)}}async isValidSessionOrPairingTopic(e){if(this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(Ze(e,!1)){const{message:t}=J("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(t)}else{const{message:t}=J("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(t)}}async isValidProposalId(e){if(!Lf(e)){const{message:t}=J("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(t)}if(!this.client.proposal.keys.includes(e)){const{message:t}=J("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(t)}if(Ft(this.client.proposal.get(e).expiry)){await this.deleteProposal(e);const{message:t}=J("EXPIRED",`proposal id: ${e}`);throw new Error(t)}}}class xp extends ai{constructor(e,t){super(e,t,_p,an),this.core=e,this.logger=t}}class Tp extends ai{constructor(e,t){super(e,t,bp,an),this.core=e,this.logger=t}}class Pp extends ai{constructor(e,t){super(e,t,mp,an),this.core=e,this.logger=t}}class on extends Hc{constructor(e){super(e),this.protocol=to,this.version=ro,this.name=wi.name,this.events=new yt.exports.EventEmitter,this.on=(i,n)=>this.events.on(i,n),this.once=(i,n)=>this.events.once(i,n),this.off=(i,n)=>this.events.off(i,n),this.removeListener=(i,n)=>this.events.removeListener(i,n),this.removeAllListeners=i=>this.events.removeAllListeners(i),this.connect=async i=>{try{return await this.engine.connect(i)}catch(n){throw this.logger.error(n.message),n}},this.pair=async i=>{try{return await this.engine.pair(i)}catch(n){throw this.logger.error(n.message),n}},this.approve=async i=>{try{return await this.engine.approve(i)}catch(n){throw this.logger.error(n.message),n}},this.reject=async i=>{try{return await this.engine.reject(i)}catch(n){throw this.logger.error(n.message),n}},this.update=async i=>{try{return await this.engine.update(i)}catch(n){throw this.logger.error(n.message),n}},this.extend=async i=>{try{return await this.engine.extend(i)}catch(n){throw this.logger.error(n.message),n}},this.request=async i=>{try{return await this.engine.request(i)}catch(n){throw this.logger.error(n.message),n}},this.respond=async i=>{try{return await this.engine.respond(i)}catch(n){throw this.logger.error(n.message),n}},this.ping=async i=>{try{return await this.engine.ping(i)}catch(n){throw this.logger.error(n.message),n}},this.emit=async i=>{try{return await this.engine.emit(i)}catch(n){throw this.logger.error(n.message),n}},this.disconnect=async i=>{try{return await this.engine.disconnect(i)}catch(n){throw this.logger.error(n.message),n}},this.find=i=>{try{return this.engine.find(i)}catch(n){throw this.logger.error(n.message),n}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(i){throw this.logger.error(i.message),i}},this.name=(e==null?void 0:e.name)||wi.name,this.metadata=(e==null?void 0:e.metadata)||ef();const t=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:Dr(Se.getDefaultLoggerOptions({level:(e==null?void 0:e.logger)||wi.logger}));this.core=(e==null?void 0:e.core)||new yp(e),this.logger=Se.generateChildLogger(t,this.name),this.session=new Tp(this.core,this.logger),this.proposal=new xp(this.core,this.logger),this.pendingRequest=new Pp(this.core,this.logger),this.engine=new Ip(this)}static async init(e){const t=new on(e);return await t.initialize(),t}get context(){return Se.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success")}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}}var Ie={};Object.defineProperty(Ie,"__esModule",{value:!0});Ie.getLocalStorage=Ie.getLocalStorageOrThrow=Ie.getCrypto=Ie.getCryptoOrThrow=Ie.getLocation=Ie.getLocationOrThrow=Ie.getNavigator=Ie.getNavigatorOrThrow=Ie.getDocument=Ie.getDocumentOrThrow=Ie.getFromWindowOrThrow=Ie.getFromWindow=void 0;function Xt(r){let e;return typeof window<"u"&&typeof window[r]<"u"&&(e=window[r]),e}Ie.getFromWindow=Xt;function sr(r){const e=Xt(r);if(!e)throw new Error(`${r} is not defined in Window`);return e}Ie.getFromWindowOrThrow=sr;function Ap(){return sr("document")}Ie.getDocumentOrThrow=Ap;function Np(){return Xt("document")}Ie.getDocument=Np;function Cp(){return sr("navigator")}Ie.getNavigatorOrThrow=Cp;function Rp(){return Xt("navigator")}Ie.getNavigator=Rp;function Fp(){return sr("location")}Ie.getLocationOrThrow=Fp;function Up(){return Xt("location")}Ie.getLocation=Up;function Lp(){return sr("crypto")}Ie.getCryptoOrThrow=Lp;function Mp(){return Xt("crypto")}Ie.getCrypto=Mp;function jp(){return sr("localStorage")}Ie.getLocalStorageOrThrow=jp;function $p(){return Xt("localStorage")}Ie.getLocalStorage=$p;var cn={};Object.defineProperty(cn,"__esModule",{value:!0});cn.getWindowMetadata=void 0;const Ls=Ie;function zp(){let r,e;try{r=Ls.getDocumentOrThrow(),e=Ls.getLocationOrThrow()}catch{return null}function t(){const A=r.getElementsByTagName("link"),z=[];for(let N=0;N<A.length;N++){const P=A[N],q=P.getAttribute("rel");if(q&&q.toLowerCase().indexOf("icon")>-1){const M=P.getAttribute("href");if(M)if(M.toLowerCase().indexOf("https:")===-1&&M.toLowerCase().indexOf("http:")===-1&&M.indexOf("//")!==0){let B=e.protocol+"//"+e.host;if(M.indexOf("/")===0)B+=M;else{const _=e.pathname.split("/");_.pop();const E=_.join("/");B+=E+"/"+M}z.push(B)}else if(M.indexOf("//")===0){const B=e.protocol+M;z.push(B)}else z.push(M)}}return z}function i(...A){const z=r.getElementsByTagName("meta");for(let N=0;N<z.length;N++){const P=z[N],q=["itemprop","property","name"].map(M=>P.getAttribute(M)).filter(M=>M?A.includes(M):!1);if(q.length&&q){const M=P.getAttribute("content");if(M)return M}}return""}function n(){let A=i("name","og:site_name","og:title","twitter:title");return A||(A=r.title),A}function c(){return i("description","og:description","twitter:description","keywords")}const y=n(),u=c(),g=e.origin,O=t();return{description:u,url:g,icons:O,name:y}}cn.getWindowMetadata=zp;var Hp={};(function(r){const e=Bs,t=Ks,i=qs,n=Na,c=_=>_==null,y=Symbol("encodeFragmentIdentifier");function u(_){switch(_.arrayFormat){case"index":return E=>(b,w)=>{const m=b.length;return w===void 0||_.skipNull&&w===null||_.skipEmptyString&&w===""?b:w===null?[...b,[S(E,_),"[",m,"]"].join("")]:[...b,[S(E,_),"[",S(m,_),"]=",S(w,_)].join("")]};case"bracket":return E=>(b,w)=>w===void 0||_.skipNull&&w===null||_.skipEmptyString&&w===""?b:w===null?[...b,[S(E,_),"[]"].join("")]:[...b,[S(E,_),"[]=",S(w,_)].join("")];case"colon-list-separator":return E=>(b,w)=>w===void 0||_.skipNull&&w===null||_.skipEmptyString&&w===""?b:w===null?[...b,[S(E,_),":list="].join("")]:[...b,[S(E,_),":list=",S(w,_)].join("")];case"comma":case"separator":case"bracket-separator":{const E=_.arrayFormat==="bracket-separator"?"[]=":"=";return b=>(w,m)=>m===void 0||_.skipNull&&m===null||_.skipEmptyString&&m===""?w:(m=m===null?"":m,w.length===0?[[S(b,_),E,S(m,_)].join("")]:[[w,S(m,_)].join(_.arrayFormatSeparator)])}default:return E=>(b,w)=>w===void 0||_.skipNull&&w===null||_.skipEmptyString&&w===""?b:w===null?[...b,S(E,_)]:[...b,[S(E,_),"=",S(w,_)].join("")]}}function g(_){let E;switch(_.arrayFormat){case"index":return(b,w,m)=>{if(E=/\[(\d*)\]$/.exec(b),b=b.replace(/\[\d*\]$/,""),!E){m[b]=w;return}m[b]===void 0&&(m[b]={}),m[b][E[1]]=w};case"bracket":return(b,w,m)=>{if(E=/(\[\])$/.exec(b),b=b.replace(/\[\]$/,""),!E){m[b]=w;return}if(m[b]===void 0){m[b]=[w];return}m[b]=[].concat(m[b],w)};case"colon-list-separator":return(b,w,m)=>{if(E=/(:list)$/.exec(b),b=b.replace(/:list$/,""),!E){m[b]=w;return}if(m[b]===void 0){m[b]=[w];return}m[b]=[].concat(m[b],w)};case"comma":case"separator":return(b,w,m)=>{const s=typeof w=="string"&&w.includes(_.arrayFormatSeparator),l=typeof w=="string"&&!s&&A(w,_).includes(_.arrayFormatSeparator);w=l?A(w,_):w;const H=s||l?w.split(_.arrayFormatSeparator).map(o=>A(o,_)):w===null?w:A(w,_);m[b]=H};case"bracket-separator":return(b,w,m)=>{const s=/(\[\])$/.test(b);if(b=b.replace(/\[\]$/,""),!s){m[b]=w&&A(w,_);return}const l=w===null?[]:w.split(_.arrayFormatSeparator).map(H=>A(H,_));if(m[b]===void 0){m[b]=l;return}m[b]=[].concat(m[b],l)};default:return(b,w,m)=>{if(m[b]===void 0){m[b]=w;return}m[b]=[].concat(m[b],w)}}}function O(_){if(typeof _!="string"||_.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function S(_,E){return E.encode?E.strict?e(_):encodeURIComponent(_):_}function A(_,E){return E.decode?t(_):_}function z(_){return Array.isArray(_)?_.sort():typeof _=="object"?z(Object.keys(_)).sort((E,b)=>Number(E)-Number(b)).map(E=>_[E]):_}function N(_){const E=_.indexOf("#");return E!==-1&&(_=_.slice(0,E)),_}function P(_){let E="";const b=_.indexOf("#");return b!==-1&&(E=_.slice(b)),E}function q(_){_=N(_);const E=_.indexOf("?");return E===-1?"":_.slice(E+1)}function M(_,E){return E.parseNumbers&&!Number.isNaN(Number(_))&&typeof _=="string"&&_.trim()!==""?_=Number(_):E.parseBooleans&&_!==null&&(_.toLowerCase()==="true"||_.toLowerCase()==="false")&&(_=_.toLowerCase()==="true"),_}function B(_,E){E=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},E),O(E.arrayFormatSeparator);const b=g(E),w=Object.create(null);if(typeof _!="string"||(_=_.trim().replace(/^[?#&]/,""),!_))return w;for(const m of _.split("&")){if(m==="")continue;let[s,l]=i(E.decode?m.replace(/\+/g," "):m,"=");l=l===void 0?null:["comma","separator","bracket-separator"].includes(E.arrayFormat)?l:A(l,E),b(A(s,E),l,w)}for(const m of Object.keys(w)){const s=w[m];if(typeof s=="object"&&s!==null)for(const l of Object.keys(s))s[l]=M(s[l],E);else w[m]=M(s,E)}return E.sort===!1?w:(E.sort===!0?Object.keys(w).sort():Object.keys(w).sort(E.sort)).reduce((m,s)=>{const l=w[s];return Boolean(l)&&typeof l=="object"&&!Array.isArray(l)?m[s]=z(l):m[s]=l,m},Object.create(null))}r.extract=q,r.parse=B,r.stringify=(_,E)=>{if(!_)return"";E=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},E),O(E.arrayFormatSeparator);const b=l=>E.skipNull&&c(_[l])||E.skipEmptyString&&_[l]==="",w=u(E),m={};for(const l of Object.keys(_))b(l)||(m[l]=_[l]);const s=Object.keys(m);return E.sort!==!1&&s.sort(E.sort),s.map(l=>{const H=_[l];return H===void 0?"":H===null?S(l,E):Array.isArray(H)?H.length===0&&E.arrayFormat==="bracket-separator"?S(l,E)+"[]":H.reduce(w(l),[]).join("&"):S(l,E)+"="+S(H,E)}).filter(l=>l.length>0).join("&")},r.parseUrl=(_,E)=>{E=Object.assign({decode:!0},E);const[b,w]=i(_,"#");return Object.assign({url:b.split("?")[0]||"",query:B(q(_),E)},E&&E.parseFragmentIdentifier&&w?{fragmentIdentifier:A(w,E)}:{})},r.stringifyUrl=(_,E)=>{E=Object.assign({encode:!0,strict:!0,[y]:!0},E);const b=N(_.url).split("?")[0]||"",w=r.extract(_.url),m=r.parse(w,{sort:!1}),s=Object.assign(m,_.query);let l=r.stringify(s,E);l&&(l=`?${l}`);let H=P(_.url);return _.fragmentIdentifier&&(H=`#${E[y]?S(_.fragmentIdentifier,E):_.fragmentIdentifier}`),`${b}${l}${H}`},r.pick=(_,E,b)=>{b=Object.assign({parseFragmentIdentifier:!0,[y]:!1},b);const{url:w,query:m,fragmentIdentifier:s}=r.parseUrl(_,b);return r.stringifyUrl({url:w,query:n(m,E),fragmentIdentifier:s},b)},r.exclude=(_,E,b)=>{const w=Array.isArray(E)?m=>!E.includes(m):(m,s)=>!E(m,s);return r.pick(_,w,b)}})(Hp);const qp={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}};function Bp(r,e){const{message:t,code:i}=qp[r];return{message:e?`${t} ${e}`:t,code:i}}function Kp(r,e){return Array.isArray(r)?typeof e<"u"&&r.length?r.every(e):!0:!1}function Vp(r){var e;const t=(e=r[Object.keys(r)[0]])==null?void 0:e.chains[0];return[t.split(":")[0],t.split(":")[1]]}function Mt(r,e){let t;return e.rpcMap&&(t=e.rpcMap[Gp([r])]),t}function Gp(r){return Number(r[0].split(":")[1])}class Wp{constructor(e){this.name="eip155",this.namespace=e.namespace,this.client=e.client,this.events=e.events,this.httpProviders=this.createHttpProviders(),this.chainId=this.getDefaultChainId()}async request(e){var t;switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":{const i=e.request.params?(t=e.request.params[0])==null?void 0:t.chainId:"0x0";return this.setDefaultChain(parseInt(i,16).toString()),null}case"eth_chainId":return this.getDefaultChainId()}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,t){if(this.chainId=parseInt(e),!this.httpProviders[e]){const i=t||Mt(`${this.name}:${e}`,this.namespace);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,i)}this.events.emit("chainChanged",this.chainId)}requestAccounts(){return this.getAccounts()}createHttpProvider(e,t){const i=t||Mt(e,this.namespace);return typeof i>"u"?void 0:new Er(new Yr(i))}setHttpProvider(e,t){const i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{e[t]=this.createHttpProvider(t)}),e}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}getDefaultChainId(){if(this.chainId)return this.chainId;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return parseInt(e.split(":")[1])}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}}class kp{constructor(e){this.name="solana",this.namespace=e.namespace,this.events=e.events,this.client=e.client,this.chainId=this.getDefaultChainId(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{e[t]=this.createHttpProvider(t)}),e}getDefaultChainId(){if(this.chainId)return this.chainId;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const i=t||Mt(`${this.name}:${e}`,this.namespace);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,i)}this.events.emit("chainChanged",this.chainId)}setHttpProvider(e,t){const i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){const i=t||Mt(e,this.namespace);return typeof i>"u"?void 0:new Er(new Yr(i))}}class Yp{constructor(e){this.name="cosmos",this.namespace=e.namespace,this.events=e.events,this.client=e.client,this.chainId=this.getDefaultChainId(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{e[t]=this.createHttpProvider(t)}),e}getDefaultChainId(){if(this.chainId)return this.chainId;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const i=t||Mt(`${this.name}:${e}`,this.namespace);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,i)}this.events.emit("chainChanged",this.chainId)}setHttpProvider(e,t){const i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){const i=t||Mt(e,this.namespace);return typeof i>"u"?void 0:new Er(new Yr(i))}}class Jp{constructor(e){this.name="cip34",this.namespace=e.namespace,this.events=e.events,this.client=e.client,this.chainId=this.getDefaultChainId(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{e[t]=this.createHttpProvider(t)}),e}getDefaultChainId(){if(this.chainId)return this.chainId;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const i=t||Mt(`${this.name}:${e}`,this.namespace);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,i)}this.events.emit("chainChanged",this.chainId)}setHttpProvider(e,t){const i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){const i=t||Mt(e,this.namespace);return typeof i>"u"?void 0:new Er(new Yr(i))}}const Ms="error",Xp="wss://relay.walletconnect.com",Zp="wc",Qp="universal_provider",js=`${Zp}@${2}:${Qp}:`;var e0=Object.defineProperty,t0=Object.defineProperties,r0=Object.getOwnPropertyDescriptors,$s=Object.getOwnPropertySymbols,i0=Object.prototype.hasOwnProperty,n0=Object.prototype.propertyIsEnumerable,zs=(r,e,t)=>e in r?e0(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Hs=(r,e)=>{for(var t in e||(e={}))i0.call(e,t)&&zs(r,t,e[t]);if($s)for(var t of $s(e))n0.call(e,t)&&zs(r,t,e[t]);return r},s0=(r,e)=>t0(r,r0(e));class un{constructor(e){this.events=new yt.exports,this.rpcProviders={},this.providerOpts=e,this.logger=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:Dr(Se.getDefaultLoggerOptions({level:(e==null?void 0:e.logger)||Ms}))}static async init(e){const t=new un(e);return await t.initialize(),t}async request(e,t){const[i,n]=this.validateChain(t);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(i).request({request:Hs({},e),chainId:`${i}:${n}`,topic:this.session.topic})}sendAsync(e,t,i){this.request(e,i).then(n=>t(null,n)).catch(n=>t(n,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(e=this.session)==null?void 0:e.topic,reason:Bp("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");const{namespaces:t}=e;return this.setNamespaces(t),this.createProviders(),await this.cleanupPendingPairings(),e.skipPairing===!0?void 0:await this.pair(e.pairingTopic)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}removeListener(e,t){this.events.removeListener(e,t)}off(e,t){this.events.off(e,t)}get isWalletConnect(){return!0}async pair(e){const{uri:t,approval:i}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces});return t&&(this.uri=t,this.events.emit("display_uri",t)),this.session=await i(),this.onSessionUpdate(),this.onConnect(),this.session}setDefaultChain(e,t){try{const[i,n]=this.validateChain(e);this.getProvider(i).setDefaultChain(n,t)}catch(i){if(!/Please call connect/.test(i.message))throw i}}async cleanupPendingPairings(e={}){this.logger.info("Cleaning up inactive pairings...");const t=this.client.pairing.getAll();if(Kp(t)){for(const i of t)e.deletePairings?this.client.core.expirer.set(i.topic,0):await this.client.core.relayer.subscriber.unsubscribe(i.topic);this.logger.info(`Inactive pairings cleared: ${t.length}`)}}async checkStorage(){if(this.namespaces=await this.client.core.storage.getItem(`${js}/namespaces`)||{},this.namespaces&&this.createProviders(),this.client.session.length){const e=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[e]),this.onSessionUpdate()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await on.init({logger:this.providerOpts.logger||Ms,relayUrl:this.providerOpts.relayUrl||Xp,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");Object.keys(this.namespaces).forEach(e=>{switch(e){case"eip155":this.rpcProviders[e]=new Wp({client:this.client,namespace:this.namespaces[e],events:this.events});break;case"solana":this.rpcProviders[e]=new kp({client:this.client,namespace:this.namespaces[e],events:this.events});break;case"cosmos":this.rpcProviders[e]=new Yp({client:this.client,namespace:this.namespaces[e],events:this.events});break;case"polkadot":break;case"cip34":this.rpcProviders[e]=new Jp({client:this.client,namespace:this.namespaces[e],events:this.events});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{const{params:t}=e,{event:i}=t;i.name==="accountsChanged"?this.events.emit("accountsChanged",i.data):i.name==="chainChanged"?this.onChainChanged(i.data,t.chainId):this.events.emit(i.name,i.data),this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:t})=>{var i;const{namespaces:n}=t,c=(i=this.client)==null?void 0:i.session.get(e);this.session=s0(Hs({},c),{namespaces:n}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:t})}),this.client.on("session_delete",async e=>{await this.cleanup(),this.events.emit("session_delete",e)})}getProvider(e){if(!this.rpcProviders[e])throw new Error(`Provider not found: ${e}`);return this.rpcProviders[e]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var t;this.getProvider(e).updateNamespace((t=this.session)==null?void 0:t.namespaces[e])})}setNamespaces(e){if(!e||!Object.keys(e).length)throw new Error("Namespaces must be not empty");this.client.core.storage.setItem(`${js}/namespaces`,e),this.namespaces=e}validateChain(e){const[t,i]=(e==null?void 0:e.split(":"))||["",""];if(t&&!Object.keys(this.namespaces).includes(t))throw new Error(`Namespace '${t}' is not configured. Please call connect() first with namespace config.`);return!t||!i?Vp(this.namespaces):[t,i]}async requestAccounts(){const[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}onChainChanged(e,t){const[i,n]=this.validateChain(t);this.getProvider(i).setDefaultChain(n),this.events.emit("chainChanged",e)}onConnect(){this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,await this.cleanupPendingPairings({deletePairings:!0})}}const u0=un;export{u0 as UniversalProvider,un as default};
